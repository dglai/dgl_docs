
<!DOCTYPE html>

<html class="writer-html5" data-content_root="../" lang="en">
<head>
<meta charset="utf-8"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>OnDiskDataset for Heterogeneous Graph â€” DGL 2.5 documentation</title>
<link href="../_static/pygments.css?v=80d5e7a1" rel="stylesheet" type="text/css"/>
<link href="../_static/css/theme.css?v=e59714d7" rel="stylesheet" type="text/css"/>
<link href="../_static/graphviz.css?v=4ae1632d" rel="stylesheet" type="text/css"/>
<link href="../_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery.css?v=d2d258e8" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery-binder.css?v=f4aeca0c" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery-dataframe.css?v=2082cf3c" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" rel="stylesheet" type="text/css"/>
<link href="../_static/nbsphinx-code-cells.css?v=2aa19091" rel="stylesheet" type="text/css"/>
<link href="../_static/css/custom.css?v=0bf289b5" rel="stylesheet" type="text/css"/>
<script src="../_static/jquery.js?v=5d32c60e"></script>
<script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
<script src="../_static/documentation_options.js?v=38d273f4"></script>
<script src="../_static/doctools.js?v=9bcbadda"></script>
<script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="../_static/clipboard.min.js?v=a7894cd8"></script>
<script src="../_static/copybutton.js?v=ccdb6887"></script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
<script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="../_static/js/theme.js"></script>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="ondisk-dataset-specification.html" rel="next" title="YAML specification"/>
<link href="ondisk_dataset_homograph.html" rel="prev" title="OnDiskDataset for Homogeneous Graph"/>
</head>
<body class="wy-body-for-nav">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../index.html">
            DGL
          </a>
<div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
</div><div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Install and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/blitz/index.html">A Blitz Introduction to DGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Materials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ğŸ†• Stochastic Training of GNNs with GraphBolt</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="neighbor_sampling_overview.html">Neighbor Sampling Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="node_classification.html">Node Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="link_prediction.html">Link Prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="multigpu_node_classification.html">Multi-GPU Node Classification</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="ondisk-dataset.html">Composing OnDiskDataset from raw data</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ondisk_dataset_homograph.html">OnDiskDataset for Homogeneous Graph</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">OnDiskDataset for Heterogeneous Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="ondisk-dataset-specification.html">YAML specification</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide_cn/index.html">ç”¨æˆ·æŒ‡å—ã€åŒ…å«è¿‡æ—¶ä¿¡æ¯ã€‘</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide_ko/index.html">ì‚¬ìš©ì ê°€ì´ë“œ[ì‹œëŒ€ì— ë’¤ì³ì§„]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphtransformer/index.html">ğŸ†• Tutorial: Graph Transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/sparse/index.html">Tutorials: dgl.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cpu/index.html">Training on CPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/multi/index.html">Training on Multiple GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/dist/index.html">Distributed training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/index.html">Paper Study with DGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.html">dgl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.data.html">dgl.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.dataloading.html">dgl.dataloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.DGLGraph.html">dgl.DGLGraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.distributed.html">dgl.distributed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.function.html">dgl.function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.geometry.html">dgl.geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.graphbolt.html">ğŸ†• dgl.graphbolt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/nn-pytorch.html">dgl.nn (PyTorch)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/nn.functional.html">dgl.nn.functional</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.ops.html">dgl.ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.optim.html">dgl.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.sampling.html">dgl.sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.sparse_v0.html">dgl.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.multiprocessing.html">dgl.multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/transforms.html">dgl.transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/udf.html">User-defined Functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contribute to DGL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/ffi.html">DGL Foreign Function Interface (FFI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance.html">Performance Benchmarks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../env_var.html">Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html">Resources</a></li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift"><nav aria-label="Mobile navigation menu" class="wy-nav-top">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../index.html">DGL</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="Page navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Home" class="icon icon-home" href="../index.html"></a></li>
<li class="breadcrumb-item"><a href="index.html">ğŸ†• Stochastic Training of GNNs with GraphBolt</a></li>
<li class="breadcrumb-item"><a href="ondisk-dataset.html">Composing OnDiskDataset from raw data</a></li>
<li class="breadcrumb-item active">OnDiskDataset for Heterogeneous Graph</li>
<li class="wy-breadcrumbs-aside">
<a href="../_sources/stochastic_training/ondisk_dataset_heterograph.nblink.txt" rel="nofollow"> View page source</a>
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div itemprop="articleBody">
<section id="OnDiskDataset-for-Heterogeneous-Graph">
<h1>OnDiskDataset for Heterogeneous Graph<a class="headerlink" href="#OnDiskDataset-for-Heterogeneous-Graph" title="Link to this heading">ïƒ</a></h1>
<p><a class="reference external" href="https://colab.research.google.com/github/dmlc/dgl/blob/master/notebooks/stochastic_training/ondisk_dataset_heterograph.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a> <a class="reference external" href="https://github.com/dmlc/dgl/blob/master/notebooks/stochastic_training/ondisk_dataset_heterograph.ipynb"><img alt="GitHub" src="https://img.shields.io/badge/-View%20on%20GitHub-181717?logo=github&amp;logoColor=ffffff"/></a></p>
<p>This tutorial shows how to create <code class="docutils literal notranslate"><span class="pre">OnDiskDataset</span></code> for heterogeneous graph that could be used in <strong>GraphBolt</strong> framework. The major difference from creating dataset for homogeneous graph is that we need to specify node/edge types for edges, feature data, training/validation/test sets.</p>
<p>By the end of this tutorial, you will be able to</p>
<ul class="simple">
<li><p>organize graph structure data.</p></li>
<li><p>organize feature data.</p></li>
<li><p>organize training/validation/test set for specific tasks.</p></li>
</ul>
<p>To create an <code class="docutils literal notranslate"><span class="pre">OnDiskDataset</span></code> object, you need to organize all the data including graph structure, feature data and tasks into a directory. The directory should contain a <code class="docutils literal notranslate"><span class="pre">metadata.yaml</span></code> file that describes the metadata of the dataset.</p>
<p>Now letâ€™s generate various data step by step and organize them together to instantiate <code class="docutils literal notranslate"><span class="pre">OnDiskDataset</span></code> finally.</p>
<section id="Install-DGL-package">
<h2>Install DGL package<a class="headerlink" href="#Install-DGL-package" title="Link to this heading">ïƒ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install required packages.</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'TORCH'</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">__version__</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'DGLBACKEND'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"pytorch"</span>

<span class="c1"># Install the CPU version.</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cpu"</span><span class="p">)</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>--pre<span class="w"> </span>dgl<span class="w"> </span>-f<span class="w"> </span>https://data.dgl.ai/wheels-test/repo.html

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">dgl</span>
    <span class="kn">import</span> <span class="nn">dgl.graphbolt</span> <span class="k">as</span> <span class="nn">gb</span>
    <span class="n">installed</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="n">installed</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"DGL installed!"</span> <span class="k">if</span> <span class="n">installed</span> <span class="k">else</span> <span class="s2">"DGL not found!"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Looking in links: https://data.dgl.ai/wheels-test/repo.html
Requirement already satisfied: dgl in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (2.2a240410)
Requirement already satisfied: numpy&gt;=1.14.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (1.26.4)
Requirement already satisfied: scipy&gt;=1.1.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (1.14.1)
Requirement already satisfied: networkx&gt;=2.1 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (3.4.2)
Requirement already satisfied: requests&gt;=2.19.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (2.32.3)
Requirement already satisfied: tqdm in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (4.66.6)
Requirement already satisfied: psutil&gt;=5.8.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (6.1.0)
Requirement already satisfied: torchdata&gt;=0.5.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (0.9.0)
Requirement already satisfied: pandas in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (2.2.3)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from requests&gt;=2.19.0-&gt;dgl) (3.4.0)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from requests&gt;=2.19.0-&gt;dgl) (3.10)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from requests&gt;=2.19.0-&gt;dgl) (2.2.3)
Requirement already satisfied: certifi&gt;=2017.4.17 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from requests&gt;=2.19.0-&gt;dgl) (2024.8.30)
Requirement already satisfied: torch&gt;=2 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torchdata&gt;=0.5.0-&gt;dgl) (2.1.0+cpu)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from pandas-&gt;dgl) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from pandas-&gt;dgl) (2024.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from pandas-&gt;dgl) (2024.2)
Requirement already satisfied: six&gt;=1.5 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas-&gt;dgl) (1.16.0)
Requirement already satisfied: filelock in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (3.16.1)
Requirement already satisfied: typing-extensions in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (4.12.2)
Requirement already satisfied: sympy in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (1.13.3)
Requirement already satisfied: jinja2 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (3.1.4)
Requirement already satisfied: fsspec in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (2024.10.0)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from jinja2-&gt;torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (3.0.2)
Requirement already satisfied: mpmath&lt;1.4,&gt;=1.1.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from sympy-&gt;torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (1.3.0)
<span class="ansi-yellow-fg">WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.</span><span class="ansi-yellow-fg">
</span>DGL installed!
</pre></div></div>
</div>
</section>
<section id="Data-preparation">
<h2>Data preparation<a class="headerlink" href="#Data-preparation" title="Link to this heading">ïƒ</a></h2>
<p>In order to demonstrate how to organize various data, letâ€™s create a base directory first.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">'./ondisk_dataset_heterograph'</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Created base directory: </span><span class="si">{</span><span class="n">base_dir</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Created base directory: ./ondisk_dataset_heterograph
</pre></div></div>
</div>
<section id="Generate-graph-structure-data">
<h3>Generate graph structure data<a class="headerlink" href="#Generate-graph-structure-data" title="Link to this heading">ïƒ</a></h3>
<p>For heterogeneous graph, we need to save different edge edges(namely seeds) into separate <strong>Numpy</strong> or <strong>CSV</strong> files.</p>
<p>Note: - when saving to <strong>Numpy</strong>, the array requires to be in shape of <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">N)</span></code>. This format is recommended as constructing graph from it is much faster than <strong>CSV</strong> file. - when saving to <strong>CSV</strong> file, do not save index and header.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># For simplicity, we create a heterogeneous graph with</span>
<span class="c1"># 2 node types: `user`, `item`</span>
<span class="c1"># 2 edge types: `user:like:item`, `user:follow:user`</span>
<span class="c1"># And each node/edge type has the same number of nodes/edges.</span>
<span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">num_edges</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">num_nodes</span>

<span class="c1"># Edge type: "user:like:item"</span>
<span class="n">like_edges_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"like-edges.csv"</span><span class="p">)</span>
<span class="n">like_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of [user:like:item] edges: </span><span class="si">{</span><span class="n">like_edges</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">like_edges</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">like_edges_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"[user:like:item] edges are saved into </span><span class="si">{</span><span class="n">like_edges_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Edge type: "user:follow:user"</span>
<span class="n">follow_edges_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"follow-edges.csv"</span><span class="p">)</span>
<span class="n">follow_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of [user:follow:user] edges: </span><span class="si">{</span><span class="n">follow_edges</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">follow_edges</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">follow_edges_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"[user:follow:user] edges are saved into </span><span class="si">{</span><span class="n">follow_edges_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Part of [user:like:item] edges: [[807  36]
 [239 516]
 [106 469]
 [777 644]
 [172 494]]

[user:like:item] edges are saved into ./ondisk_dataset_heterograph/like-edges.csv

Part of [user:follow:user] edges: [[863 884]
 [369 106]
 [834 980]
 [487 590]
 [510  41]]

[user:follow:user] edges are saved into ./ondisk_dataset_heterograph/follow-edges.csv

</pre></div></div>
</div>
</section>
<section id="Generate-feature-data-for-graph">
<h3>Generate feature data for graph<a class="headerlink" href="#Generate-feature-data-for-graph" title="Link to this heading">ïƒ</a></h3>
<p>For feature data, numpy arrays and torch tensors are supported for now. Letâ€™s generate feature data for each node/edge type.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate node[user] feature in numpy array.</span>
<span class="n">node_user_feat_0_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"node-user-feat-0.npy"</span><span class="p">)</span>
<span class="n">node_user_feat_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of node[user] feature [feat_0]: </span><span class="si">{</span><span class="n">node_user_feat_0</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">node_user_feat_0_path</span><span class="p">,</span> <span class="n">node_user_feat_0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Node[user] feature [feat_0] is saved to </span><span class="si">{</span><span class="n">node_user_feat_0_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate another node[user] feature in torch tensor</span>
<span class="n">node_user_feat_1_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"node-user-feat-1.pt"</span><span class="p">)</span>
<span class="n">node_user_feat_1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of node[user] feature [feat_1]: </span><span class="si">{</span><span class="n">node_user_feat_1</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">node_user_feat_1</span><span class="p">,</span> <span class="n">node_user_feat_1_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Node[user] feature [feat_1] is saved to </span><span class="si">{</span><span class="n">node_user_feat_1_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate node[item] feature in numpy array.</span>
<span class="n">node_item_feat_0_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"node-item-feat-0.npy"</span><span class="p">)</span>
<span class="n">node_item_feat_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of node[item] feature [feat_0]: </span><span class="si">{</span><span class="n">node_item_feat_0</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">node_item_feat_0_path</span><span class="p">,</span> <span class="n">node_item_feat_0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Node[item] feature [feat_0] is saved to </span><span class="si">{</span><span class="n">node_item_feat_0_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate another node[item] feature in torch tensor</span>
<span class="n">node_item_feat_1_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"node-item-feat-1.pt"</span><span class="p">)</span>
<span class="n">node_item_feat_1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of node[item] feature [feat_1]: </span><span class="si">{</span><span class="n">node_item_feat_1</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">node_item_feat_1</span><span class="p">,</span> <span class="n">node_item_feat_1_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Node[item] feature [feat_1] is saved to </span><span class="si">{</span><span class="n">node_item_feat_1_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate edge[user:like:item] feature in numpy array.</span>
<span class="n">edge_like_feat_0_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"edge-like-feat-0.npy"</span><span class="p">)</span>
<span class="n">edge_like_feat_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of edge[user:like:item] feature [feat_0]: </span><span class="si">{</span><span class="n">edge_like_feat_0</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">edge_like_feat_0_path</span><span class="p">,</span> <span class="n">edge_like_feat_0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Edge[user:like:item] feature [feat_0] is saved to </span><span class="si">{</span><span class="n">edge_like_feat_0_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate another edge[user:like:item] feature in torch tensor</span>
<span class="n">edge_like_feat_1_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"edge-like-feat-1.pt"</span><span class="p">)</span>
<span class="n">edge_like_feat_1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of edge[user:like:item] feature [feat_1]: </span><span class="si">{</span><span class="n">edge_like_feat_1</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">edge_like_feat_1</span><span class="p">,</span> <span class="n">edge_like_feat_1_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Edge[user:like:item] feature [feat_1] is saved to </span><span class="si">{</span><span class="n">edge_like_feat_1_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate edge[user:follow:user] feature in numpy array.</span>
<span class="n">edge_follow_feat_0_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"edge-follow-feat-0.npy"</span><span class="p">)</span>
<span class="n">edge_follow_feat_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of edge[user:follow:user] feature [feat_0]: </span><span class="si">{</span><span class="n">edge_follow_feat_0</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">edge_follow_feat_0_path</span><span class="p">,</span> <span class="n">edge_follow_feat_0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Edge[user:follow:user] feature [feat_0] is saved to </span><span class="si">{</span><span class="n">edge_follow_feat_0_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate another edge[user:follow:user] feature in torch tensor</span>
<span class="n">edge_follow_feat_1_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"edge-follow-feat-1.pt"</span><span class="p">)</span>
<span class="n">edge_follow_feat_1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of edge[user:follow:user] feature [feat_1]: </span><span class="si">{</span><span class="n">edge_follow_feat_1</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">edge_follow_feat_1</span><span class="p">,</span> <span class="n">edge_follow_feat_1_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Edge[user:follow:user] feature [feat_1] is saved to </span><span class="si">{</span><span class="n">edge_follow_feat_1_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Part of node[user] feature [feat_0]: [[0.86589997 0.36685732 0.80554857 0.88517915 0.23934134]
 [0.76282223 0.7894544  0.13300235 0.71411369 0.86741893]
 [0.01119982 0.66158908 0.1752443  0.91796647 0.61339789]]
Node[user] feature [feat_0] is saved to ./ondisk_dataset_heterograph/node-user-feat-0.npy

Part of node[user] feature [feat_1]: tensor([[0.2342, 0.5693, 0.2327, 0.7932, 0.0868],
        [0.7924, 0.7743, 0.5318, 0.3769, 0.9091],
        [0.1576, 0.9347, 0.3034, 0.6907, 0.5149]])
Node[user] feature [feat_1] is saved to ./ondisk_dataset_heterograph/node-user-feat-1.pt

Part of node[item] feature [feat_0]: [[0.0091035  0.7537238  0.68375188 0.24934841 0.4913473 ]
 [0.44590495 0.48518028 0.53727058 0.03000501 0.78712868]
 [0.71388341 0.0603131  0.9626966  0.77267649 0.80261049]]
Node[item] feature [feat_0] is saved to ./ondisk_dataset_heterograph/node-item-feat-0.npy

Part of node[item] feature [feat_1]: tensor([[0.2715, 0.1009, 0.7798, 0.3161, 0.6281],
        [0.5356, 0.1839, 0.1494, 0.0695, 0.7149],
        [0.8192, 0.0899, 0.4618, 0.9902, 0.2378]])
Node[item] feature [feat_1] is saved to ./ondisk_dataset_heterograph/node-item-feat-1.pt

Part of edge[user:like:item] feature [feat_0]: [[0.1816751  0.33365809 0.97808613 0.91289977 0.97271923]
 [0.26256745 0.96083029 0.84911031 0.21822419 0.02829268]
 [0.97019989 0.83498257 0.78007256 0.38426698 0.50614697]]
Edge[user:like:item] feature [feat_0] is saved to ./ondisk_dataset_heterograph/edge-like-feat-0.npy

Part of edge[user:like:item] feature [feat_1]: tensor([[0.0588, 0.6019, 0.0758, 0.1623, 0.8252],
        [0.7217, 0.0413, 0.1478, 0.5147, 0.4526],
        [0.9581, 0.3234, 0.1832, 0.8287, 0.4456]])
Edge[user:like:item] feature [feat_1] is saved to ./ondisk_dataset_heterograph/edge-like-feat-1.pt

Part of edge[user:follow:user] feature [feat_0]: [[0.20239227 0.90876226 0.69832965 0.81815687 0.80668161]
 [0.16174939 0.41336191 0.59657406 0.35906412 0.74910182]
 [0.29810928 0.62568573 0.37723974 0.02037707 0.21796089]]
Edge[user:follow:user] feature [feat_0] is saved to ./ondisk_dataset_heterograph/edge-follow-feat-0.npy

Part of edge[user:follow:user] feature [feat_1]: tensor([[0.5152, 0.0901, 0.7275, 0.2375, 0.8019],
        [0.4192, 0.1346, 0.5076, 0.4917, 0.3726],
        [0.4777, 0.4895, 0.1151, 0.4698, 0.4707]])
Edge[user:follow:user] feature [feat_1] is saved to ./ondisk_dataset_heterograph/edge-follow-feat-1.pt

</pre></div></div>
</div>
</section>
<section id="Generate-tasks">
<h3>Generate tasks<a class="headerlink" href="#Generate-tasks" title="Link to this heading">ïƒ</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">OnDiskDataset</span></code> supports multiple tasks. For each task, we need to prepare training/validation/test sets respectively. Such sets usually vary among different tasks. In this tutorial, letâ€™s create a <strong>Node Classification</strong> task and <strong>Link Prediction</strong> task.</p>
<section id="Node-Classification-Task">
<h4>Node Classification Task<a class="headerlink" href="#Node-Classification-Task" title="Link to this heading">ïƒ</a></h4>
<p>For node classification task, we need <strong>node IDs</strong> and corresponding <strong>labels</strong> for each training/validation/test set. Like feature data, numpy arrays and torch tensors are supported for these sets.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For illustration, let's generate item sets for each node type.</span>
<span class="n">num_trains</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span> <span class="o">*</span> <span class="mf">0.6</span><span class="p">)</span>
<span class="n">num_vals</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">num_tests</span> <span class="o">=</span> <span class="n">num_nodes</span> <span class="o">-</span> <span class="n">num_trains</span> <span class="o">-</span> <span class="n">num_vals</span>

<span class="n">user_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">user_ids</span><span class="p">)</span>

<span class="n">item_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">item_ids</span><span class="p">)</span>

<span class="c1"># Train IDs for user.</span>
<span class="n">nc_train_user_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-train-user-ids.npy"</span><span class="p">)</span>
<span class="n">nc_train_user_ids</span> <span class="o">=</span> <span class="n">user_ids</span><span class="p">[:</span><span class="n">num_trains</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train ids[user] for node classification: </span><span class="si">{</span><span class="n">nc_train_user_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_train_user_ids_path</span><span class="p">,</span> <span class="n">nc_train_user_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC train ids[user] are saved to </span><span class="si">{</span><span class="n">nc_train_user_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Train labels for user.</span>
<span class="n">nc_train_user_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-train-user-labels.pt"</span><span class="p">)</span>
<span class="n">nc_train_user_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_trains</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train labels[user] for node classification: </span><span class="si">{</span><span class="n">nc_train_user_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_train_user_labels</span><span class="p">,</span> <span class="n">nc_train_user_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC train labels[user] are saved to </span><span class="si">{</span><span class="n">nc_train_user_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Train IDs for item.</span>
<span class="n">nc_train_item_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-train-item-ids.npy"</span><span class="p">)</span>
<span class="n">nc_train_item_ids</span> <span class="o">=</span> <span class="n">item_ids</span><span class="p">[:</span><span class="n">num_trains</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train ids[item] for node classification: </span><span class="si">{</span><span class="n">nc_train_item_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_train_item_ids_path</span><span class="p">,</span> <span class="n">nc_train_item_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC train ids[item] are saved to </span><span class="si">{</span><span class="n">nc_train_item_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Train labels for item.</span>
<span class="n">nc_train_item_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-train-item-labels.pt"</span><span class="p">)</span>
<span class="n">nc_train_item_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_trains</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train labels[item] for node classification: </span><span class="si">{</span><span class="n">nc_train_item_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_train_item_labels</span><span class="p">,</span> <span class="n">nc_train_item_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC train labels[item] are saved to </span><span class="si">{</span><span class="n">nc_train_item_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val IDs for user.</span>
<span class="n">nc_val_user_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-val-user-ids.npy"</span><span class="p">)</span>
<span class="n">nc_val_user_ids</span> <span class="o">=</span> <span class="n">user_ids</span><span class="p">[</span><span class="n">num_trains</span><span class="p">:</span><span class="n">num_trains</span><span class="o">+</span><span class="n">num_vals</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val ids[user] for node classification: </span><span class="si">{</span><span class="n">nc_val_user_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_val_user_ids_path</span><span class="p">,</span> <span class="n">nc_val_user_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC val ids[user] are saved to </span><span class="si">{</span><span class="n">nc_val_user_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val labels for user.</span>
<span class="n">nc_val_user_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-val-user-labels.pt"</span><span class="p">)</span>
<span class="n">nc_val_user_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_vals</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val labels[user] for node classification: </span><span class="si">{</span><span class="n">nc_val_user_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_val_user_labels</span><span class="p">,</span> <span class="n">nc_val_user_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC val labels[user] are saved to </span><span class="si">{</span><span class="n">nc_val_user_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val IDs for item.</span>
<span class="n">nc_val_item_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-val-item-ids.npy"</span><span class="p">)</span>
<span class="n">nc_val_item_ids</span> <span class="o">=</span> <span class="n">item_ids</span><span class="p">[</span><span class="n">num_trains</span><span class="p">:</span><span class="n">num_trains</span><span class="o">+</span><span class="n">num_vals</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val ids[item] for node classification: </span><span class="si">{</span><span class="n">nc_val_item_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_val_item_ids_path</span><span class="p">,</span> <span class="n">nc_val_item_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC val ids[item] are saved to </span><span class="si">{</span><span class="n">nc_val_item_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val labels for item.</span>
<span class="n">nc_val_item_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-val-item-labels.pt"</span><span class="p">)</span>
<span class="n">nc_val_item_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_vals</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val labels[item] for node classification: </span><span class="si">{</span><span class="n">nc_val_item_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_val_item_labels</span><span class="p">,</span> <span class="n">nc_val_item_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC val labels[item] are saved to </span><span class="si">{</span><span class="n">nc_val_item_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test IDs for user.</span>
<span class="n">nc_test_user_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-test-user-ids.npy"</span><span class="p">)</span>
<span class="n">nc_test_user_ids</span> <span class="o">=</span> <span class="n">user_ids</span><span class="p">[</span><span class="o">-</span><span class="n">num_tests</span><span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test ids[user] for node classification: </span><span class="si">{</span><span class="n">nc_test_user_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_test_user_ids_path</span><span class="p">,</span> <span class="n">nc_test_user_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC test ids[user] are saved to </span><span class="si">{</span><span class="n">nc_test_user_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test labels for user.</span>
<span class="n">nc_test_user_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-test-user-labels.pt"</span><span class="p">)</span>
<span class="n">nc_test_user_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_tests</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test labels[user] for node classification: </span><span class="si">{</span><span class="n">nc_test_user_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_test_user_labels</span><span class="p">,</span> <span class="n">nc_test_user_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC test labels[user] are saved to </span><span class="si">{</span><span class="n">nc_test_user_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test IDs for item.</span>
<span class="n">nc_test_item_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-test-item-ids.npy"</span><span class="p">)</span>
<span class="n">nc_test_item_ids</span> <span class="o">=</span> <span class="n">item_ids</span><span class="p">[</span><span class="o">-</span><span class="n">num_tests</span><span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test ids[item] for node classification: </span><span class="si">{</span><span class="n">nc_test_item_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_test_item_ids_path</span><span class="p">,</span> <span class="n">nc_test_item_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC test ids[item] are saved to </span><span class="si">{</span><span class="n">nc_test_item_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test labels for item.</span>
<span class="n">nc_test_item_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-test-item-labels.pt"</span><span class="p">)</span>
<span class="n">nc_test_item_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_tests</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test labels[item] for node classification: </span><span class="si">{</span><span class="n">nc_test_item_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_test_item_labels</span><span class="p">,</span> <span class="n">nc_test_item_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC test labels[item] are saved to </span><span class="si">{</span><span class="n">nc_test_item_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Part of train ids[user] for node classification: [161 439 280]
NC train ids[user] are saved to ./ondisk_dataset_heterograph/nc-train-user-ids.npy

Part of train labels[user] for node classification: tensor([2, 9, 7])
NC train labels[user] are saved to ./ondisk_dataset_heterograph/nc-train-user-labels.pt

Part of train ids[item] for node classification: [758  12 811]
NC train ids[item] are saved to ./ondisk_dataset_heterograph/nc-train-item-ids.npy

Part of train labels[item] for node classification: tensor([7, 5, 3])
NC train labels[item] are saved to ./ondisk_dataset_heterograph/nc-train-item-labels.pt

Part of val ids[user] for node classification: [799 400 605]
NC val ids[user] are saved to ./ondisk_dataset_heterograph/nc-val-user-ids.npy

Part of val labels[user] for node classification: tensor([0, 1, 5])
NC val labels[user] are saved to ./ondisk_dataset_heterograph/nc-val-user-labels.pt

Part of val ids[item] for node classification: [113 549 231]
NC val ids[item] are saved to ./ondisk_dataset_heterograph/nc-val-item-ids.npy

Part of val labels[item] for node classification: tensor([1, 8, 6])
NC val labels[item] are saved to ./ondisk_dataset_heterograph/nc-val-item-labels.pt

Part of test ids[user] for node classification: [590 944 939]
NC test ids[user] are saved to ./ondisk_dataset_heterograph/nc-test-user-ids.npy

Part of test labels[user] for node classification: tensor([1, 6, 8])
NC test labels[user] are saved to ./ondisk_dataset_heterograph/nc-test-user-labels.pt

Part of test ids[item] for node classification: [454 506 605]
NC test ids[item] are saved to ./ondisk_dataset_heterograph/nc-test-item-ids.npy

Part of test labels[item] for node classification: tensor([2, 6, 7])
NC test labels[item] are saved to ./ondisk_dataset_heterograph/nc-test-item-labels.pt

</pre></div></div>
</div>
</section>
<section id="Link-Prediction-Task">
<h4>Link Prediction Task<a class="headerlink" href="#Link-Prediction-Task" title="Link to this heading">ïƒ</a></h4>
<p>For link prediction task, we need <strong>seeds</strong> or <strong>corresponding labels and indexes</strong> which representing the pos/neg property and group of the seeds for each training/validation/test set. Like feature data, numpy arrays and torch tensors are supported for these sets.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For illustration, let's generate item sets for each edge type.</span>
<span class="n">num_trains</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_edges</span> <span class="o">*</span> <span class="mf">0.6</span><span class="p">)</span>
<span class="n">num_vals</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_edges</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">num_tests</span> <span class="o">=</span> <span class="n">num_edges</span> <span class="o">-</span> <span class="n">num_trains</span> <span class="o">-</span> <span class="n">num_vals</span>

<span class="c1"># Train seeds for user:like:item.</span>
<span class="n">lp_train_like_seeds_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-train-like-seeds.npy"</span><span class="p">)</span>
<span class="n">lp_train_like_seeds</span> <span class="o">=</span> <span class="n">like_edges</span><span class="p">[:</span><span class="n">num_trains</span><span class="p">,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train seeds[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_train_like_seeds</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_train_like_seeds_path</span><span class="p">,</span> <span class="n">lp_train_like_seeds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP train seeds[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_train_like_seeds_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Train seeds for user:follow:user.</span>
<span class="n">lp_train_follow_seeds_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-train-follow-seeds.npy"</span><span class="p">)</span>
<span class="n">lp_train_follow_seeds</span> <span class="o">=</span> <span class="n">follow_edges</span><span class="p">[:</span><span class="n">num_trains</span><span class="p">,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train seeds[user:follow:user] for link prediction: </span><span class="si">{</span><span class="n">lp_train_follow_seeds</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_train_follow_seeds_path</span><span class="p">,</span> <span class="n">lp_train_follow_seeds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP train seeds[user:follow:user] are saved to </span><span class="si">{</span><span class="n">lp_train_follow_seeds_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val seeds for user:like:item.</span>
<span class="n">lp_val_like_seeds_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-val-like-seeds.npy"</span><span class="p">)</span>
<span class="n">lp_val_like_seeds</span> <span class="o">=</span> <span class="n">like_edges</span><span class="p">[</span><span class="n">num_trains</span><span class="p">:</span><span class="n">num_trains</span><span class="o">+</span><span class="n">num_vals</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">lp_val_like_neg_dsts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">num_vals</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lp_val_like_neg_srcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lp_val_like_seeds</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lp_val_like_neg_seeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lp_val_like_neg_srcs</span><span class="p">,</span> <span class="n">lp_val_like_neg_dsts</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">lp_val_like_seeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lp_val_like_seeds</span><span class="p">,</span> <span class="n">lp_val_like_neg_seeds</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val seeds[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_val_like_seeds</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_val_like_seeds_path</span><span class="p">,</span> <span class="n">lp_val_like_seeds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP val seeds[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_val_like_seeds_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val labels for user:like:item.</span>
<span class="n">lp_val_like_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-val-like-labels.npy"</span><span class="p">)</span>
<span class="n">lp_val_like_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_vals</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">lp_val_like_labels</span><span class="p">[:</span><span class="n">num_vals</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">lp_val_like_labels</span><span class="p">[</span><span class="n">num_vals</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val labels[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_val_like_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_val_like_labels_path</span><span class="p">,</span> <span class="n">lp_val_like_labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP val labels[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_val_like_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val indexes for user:like:item.</span>
<span class="n">lp_val_like_indexes_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-val-like-indexes.npy"</span><span class="p">)</span>
<span class="n">lp_val_like_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_vals</span><span class="p">)</span>
<span class="n">lp_val_like_neg_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lp_val_like_indexes</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lp_val_like_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">lp_val_like_indexes</span><span class="p">,</span> <span class="n">lp_val_like_neg_indexes</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val indexes[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_val_like_indexes</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_val_like_indexes_path</span><span class="p">,</span> <span class="n">lp_val_like_indexes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP val indexes[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_val_like_indexes_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val seeds for user:follow:item.</span>
<span class="n">lp_val_follow_seeds_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-val-follow-seeds.npy"</span><span class="p">)</span>
<span class="n">lp_val_follow_seeds</span> <span class="o">=</span> <span class="n">follow_edges</span><span class="p">[</span><span class="n">num_trains</span><span class="p">:</span><span class="n">num_trains</span><span class="o">+</span><span class="n">num_vals</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">lp_val_follow_neg_dsts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">num_vals</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lp_val_follow_neg_srcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lp_val_follow_seeds</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lp_val_follow_neg_seeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lp_val_follow_neg_srcs</span><span class="p">,</span> <span class="n">lp_val_follow_neg_dsts</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">lp_val_follow_seeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lp_val_follow_seeds</span><span class="p">,</span> <span class="n">lp_val_follow_neg_seeds</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val seeds[user:follow:item] for link prediction: </span><span class="si">{</span><span class="n">lp_val_follow_seeds</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_val_follow_seeds_path</span><span class="p">,</span> <span class="n">lp_val_follow_seeds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP val seeds[user:follow:item] are saved to </span><span class="si">{</span><span class="n">lp_val_follow_seeds_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val labels for user:follow:item.</span>
<span class="n">lp_val_follow_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-val-follow-labels.npy"</span><span class="p">)</span>
<span class="n">lp_val_follow_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_vals</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">lp_val_follow_labels</span><span class="p">[:</span><span class="n">num_vals</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">lp_val_follow_labels</span><span class="p">[</span><span class="n">num_vals</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val labels[user:follow:item] for link prediction: </span><span class="si">{</span><span class="n">lp_val_follow_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_val_follow_labels_path</span><span class="p">,</span> <span class="n">lp_val_follow_labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP val labels[user:follow:item] are saved to </span><span class="si">{</span><span class="n">lp_val_follow_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val indexes for user:follow:item.</span>
<span class="n">lp_val_follow_indexes_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-val-follow-indexes.npy"</span><span class="p">)</span>
<span class="n">lp_val_follow_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_vals</span><span class="p">)</span>
<span class="n">lp_val_follow_neg_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lp_val_follow_indexes</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lp_val_follow_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">lp_val_follow_indexes</span><span class="p">,</span> <span class="n">lp_val_follow_neg_indexes</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val indexes[user:follow:item] for link prediction: </span><span class="si">{</span><span class="n">lp_val_follow_indexes</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_val_follow_indexes_path</span><span class="p">,</span> <span class="n">lp_val_follow_indexes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP val indexes[user:follow:item] are saved to </span><span class="si">{</span><span class="n">lp_val_follow_indexes_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test seeds for user:like:item.</span>
<span class="n">lp_test_like_seeds_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-test-like-seeds.npy"</span><span class="p">)</span>
<span class="n">lp_test_like_seeds</span> <span class="o">=</span> <span class="n">like_edges</span><span class="p">[</span><span class="o">-</span><span class="n">num_tests</span><span class="p">:,</span> <span class="p">:]</span>
<span class="n">lp_test_like_neg_dsts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">num_tests</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lp_test_like_neg_srcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lp_test_like_seeds</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lp_test_like_neg_seeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lp_test_like_neg_srcs</span><span class="p">,</span> <span class="n">lp_test_like_neg_dsts</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">lp_test_like_seeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lp_test_like_seeds</span><span class="p">,</span> <span class="n">lp_test_like_neg_seeds</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test seeds[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_test_like_seeds</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_test_like_seeds_path</span><span class="p">,</span> <span class="n">lp_test_like_seeds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP test seeds[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_test_like_seeds_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test labels for user:like:item.</span>
<span class="n">lp_test_like_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-test-like-labels.npy"</span><span class="p">)</span>
<span class="n">lp_test_like_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_tests</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">lp_test_like_labels</span><span class="p">[:</span><span class="n">num_tests</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">lp_test_like_labels</span><span class="p">[</span><span class="n">num_tests</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test labels[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_test_like_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_test_like_labels_path</span><span class="p">,</span> <span class="n">lp_test_like_labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP test labels[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_test_like_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test indexes for user:like:item.</span>
<span class="n">lp_test_like_indexes_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-test-like-indexes.npy"</span><span class="p">)</span>
<span class="n">lp_test_like_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_tests</span><span class="p">)</span>
<span class="n">lp_test_like_neg_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lp_test_like_indexes</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lp_test_like_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">lp_test_like_indexes</span><span class="p">,</span> <span class="n">lp_test_like_neg_indexes</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test indexes[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_test_like_indexes</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_test_like_indexes_path</span><span class="p">,</span> <span class="n">lp_test_like_indexes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP test indexes[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_test_like_indexes_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test seeds for user:follow:item.</span>
<span class="n">lp_test_follow_seeds_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-test-follow-seeds.npy"</span><span class="p">)</span>
<span class="n">lp_test_follow_seeds</span> <span class="o">=</span> <span class="n">follow_edges</span><span class="p">[</span><span class="o">-</span><span class="n">num_tests</span><span class="p">:,</span> <span class="p">:]</span>
<span class="n">lp_test_follow_neg_dsts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">num_tests</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lp_test_follow_neg_srcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lp_test_follow_seeds</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lp_test_follow_neg_seeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lp_test_follow_neg_srcs</span><span class="p">,</span> <span class="n">lp_test_follow_neg_dsts</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">lp_test_follow_seeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lp_test_follow_seeds</span><span class="p">,</span> <span class="n">lp_test_follow_neg_seeds</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test seeds[user:follow:item] for link prediction: </span><span class="si">{</span><span class="n">lp_test_follow_seeds</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_test_follow_seeds_path</span><span class="p">,</span> <span class="n">lp_test_follow_seeds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP test seeds[user:follow:item] are saved to </span><span class="si">{</span><span class="n">lp_test_follow_seeds_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test labels for user:follow:item.</span>
<span class="n">lp_test_follow_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-test-follow-labels.npy"</span><span class="p">)</span>
<span class="n">lp_test_follow_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_tests</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">lp_test_follow_labels</span><span class="p">[:</span><span class="n">num_tests</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">lp_test_follow_labels</span><span class="p">[</span><span class="n">num_tests</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test labels[user:follow:item] for link prediction: </span><span class="si">{</span><span class="n">lp_test_follow_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_test_follow_labels_path</span><span class="p">,</span> <span class="n">lp_test_follow_labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP test labels[user:follow:item] are saved to </span><span class="si">{</span><span class="n">lp_test_follow_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test indexes for user:follow:item.</span>
<span class="n">lp_test_follow_indexes_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-test-follow-indexes.npy"</span><span class="p">)</span>
<span class="n">lp_test_follow_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_tests</span><span class="p">)</span>
<span class="n">lp_test_follow_neg_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lp_test_follow_indexes</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lp_test_follow_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">lp_test_follow_indexes</span><span class="p">,</span> <span class="n">lp_test_follow_neg_indexes</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test indexes[user:follow:item] for link prediction: </span><span class="si">{</span><span class="n">lp_test_follow_indexes</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_test_follow_indexes_path</span><span class="p">,</span> <span class="n">lp_test_follow_indexes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP test indexes[user:follow:item] are saved to </span><span class="si">{</span><span class="n">lp_test_follow_indexes_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Part of train seeds[user:like:item] for link prediction: [[807  36]
 [239 516]
 [106 469]]
LP train seeds[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-train-like-seeds.npy

Part of train seeds[user:follow:user] for link prediction: [[863 884]
 [369 106]
 [834 980]]
LP train seeds[user:follow:user] are saved to ./ondisk_dataset_heterograph/lp-train-follow-seeds.npy

Part of val seeds[user:like:item] for link prediction: [[784 313]
 [507 619]
 [ 34 603]]
LP val seeds[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-val-like-seeds.npy

Part of val labels[user:like:item] for link prediction: [1. 1. 1.]
LP val labels[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-val-like-labels.npy

Part of val indexes[user:like:item] for link prediction: [0 1 2]
LP val indexes[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-val-like-indexes.npy

Part of val seeds[user:follow:item] for link prediction: [[421 796]
 [440 976]
 [999 390]]
LP val seeds[user:follow:item] are saved to ./ondisk_dataset_heterograph/lp-val-follow-seeds.npy

Part of val labels[user:follow:item] for link prediction: [1. 1. 1.]
LP val labels[user:follow:item] are saved to ./ondisk_dataset_heterograph/lp-val-follow-labels.npy

Part of val indexes[user:follow:item] for link prediction: [0 1 2]
LP val indexes[user:follow:item] are saved to ./ondisk_dataset_heterograph/lp-val-follow-indexes.npy

Part of test seeds[user:like:item] for link prediction: [[895 931]
 [764 495]
 [864  73]]
LP test seeds[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-test-like-seeds.npy

Part of test labels[user:like:item] for link prediction: [1. 1. 1.]
LP test labels[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-test-like-labels.npy

Part of test indexes[user:like:item] for link prediction: [0 1 2]
LP test indexes[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-test-like-indexes.npy

Part of test seeds[user:follow:item] for link prediction: [[453  20]
 [699 462]
 [417 977]]
LP test seeds[user:follow:item] are saved to ./ondisk_dataset_heterograph/lp-test-follow-seeds.npy

Part of test labels[user:follow:item] for link prediction: [1. 1. 1.]
LP test labels[user:follow:item] are saved to ./ondisk_dataset_heterograph/lp-test-follow-labels.npy

Part of test indexes[user:follow:item] for link prediction: [0 1 2]
LP test indexes[user:follow:item] are saved to ./ondisk_dataset_heterograph/lp-test-follow-indexes.npy

</pre></div></div>
</div>
</section>
</section>
</section>
<section id="Organize-Data-into-YAML-File">
<h2>Organize Data into YAML File<a class="headerlink" href="#Organize-Data-into-YAML-File" title="Link to this heading">ïƒ</a></h2>
<p>Now we need to create a <code class="docutils literal notranslate"><span class="pre">metadata.yaml</span></code> file which contains the paths, dadta types of graph structure, feature data, training/validation/test sets. Please note that all path should be relative to <code class="docutils literal notranslate"><span class="pre">metadata.yaml</span></code>.</p>
<p>For heterogeneous graph, we need to specify the node/edge type in <strong>type</strong> fields. For edge type, canonical etype is required which is a string thatâ€™s concatenated by source node type, etype, and destination node type together with <code class="docutils literal notranslate"><span class="pre">:</span></code>.</p>
<p>Notes: - all path should be relative to <code class="docutils literal notranslate"><span class="pre">metadata.yaml</span></code>. - Below fields are optional and not specified in below example. - <code class="docutils literal notranslate"><span class="pre">in_memory</span></code>: indicates whether to load dada into memory or <code class="docutils literal notranslate"><span class="pre">mmap</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>Please refer to <a class="reference external" href="https://github.com/dmlc/dgl/blob/master/docs/source/stochastic_training/ondisk-dataset-specification.rst">YAML specification</a> for more details.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yaml_content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">    dataset_name: heterogeneous_graph_nc_lp</span>
<span class="s2">    graph:</span>
<span class="s2">      nodes:</span>
<span class="s2">        - type: user</span>
<span class="s2">          num: </span><span class="si">{</span><span class="n">num_nodes</span><span class="si">}</span>
<span class="s2">        - type: item</span>
<span class="s2">          num: </span><span class="si">{</span><span class="n">num_nodes</span><span class="si">}</span>
<span class="s2">      edges:</span>
<span class="s2">        - type: "user:like:item"</span>
<span class="s2">          format: csv</span>
<span class="s2">          path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">like_edges_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        - type: "user:follow:user"</span>
<span class="s2">          format: csv</span>
<span class="s2">          path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">follow_edges_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">    feature_data:</span>
<span class="s2">      - domain: node</span>
<span class="s2">        type: user</span>
<span class="s2">        name: feat_0</span>
<span class="s2">        format: numpy</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">node_user_feat_0_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: node</span>
<span class="s2">        type: user</span>
<span class="s2">        name: feat_1</span>
<span class="s2">        format: torch</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">node_user_feat_1_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: node</span>
<span class="s2">        type: item</span>
<span class="s2">        name: feat_0</span>
<span class="s2">        format: numpy</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">node_item_feat_0_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: node</span>
<span class="s2">        type: item</span>
<span class="s2">        name: feat_1</span>
<span class="s2">        format: torch</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">node_item_feat_1_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: edge</span>
<span class="s2">        type: "user:like:item"</span>
<span class="s2">        name: feat_0</span>
<span class="s2">        format: numpy</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">edge_like_feat_0_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: edge</span>
<span class="s2">        type: "user:like:item"</span>
<span class="s2">        name: feat_1</span>
<span class="s2">        format: torch</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">edge_like_feat_1_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: edge</span>
<span class="s2">        type: "user:follow:user"</span>
<span class="s2">        name: feat_0</span>
<span class="s2">        format: numpy</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">edge_follow_feat_0_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: edge</span>
<span class="s2">        type: "user:follow:user"</span>
<span class="s2">        name: feat_1</span>
<span class="s2">        format: torch</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">edge_follow_feat_1_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">    tasks:</span>
<span class="s2">      - name: node_classification</span>
<span class="s2">        num_classes: 10</span>
<span class="s2">        train_set:</span>
<span class="s2">          - type: user</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_train_user_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_train_user_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: item</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_train_item_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_train_item_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        validation_set:</span>
<span class="s2">          - type: user</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_val_user_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_val_user_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: item</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_val_item_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_val_item_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        test_set:</span>
<span class="s2">          - type: user</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_test_user_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_test_user_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: item</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_test_item_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_test_item_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - name: link_prediction</span>
<span class="s2">        num_classes: 10</span>
<span class="s2">        train_set:</span>
<span class="s2">          - type: "user:like:item"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_train_like_seeds_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: "user:follow:user"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_train_follow_seeds_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        validation_set:</span>
<span class="s2">          - type: "user:like:item"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_val_like_seeds_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_val_like_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: indexes</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_val_like_indexes_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: "user:follow:user"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_val_follow_seeds_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_val_follow_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: indexes</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_val_follow_indexes_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        test_set:</span>
<span class="s2">          - type: "user:like:item"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_test_like_seeds_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_test_like_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: indexes</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_test_like_indexes_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: "user:follow:user"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_test_follow_seeds_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_test_follow_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: indexes</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_test_follow_indexes_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">"""</span>
<span class="n">metadata_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"metadata.yaml"</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">metadata_path</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">yaml_content</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Instantiate-OnDiskDataset">
<h2>Instantiate <code class="docutils literal notranslate"><span class="pre">OnDiskDataset</span></code><a class="headerlink" href="#Instantiate-OnDiskDataset" title="Link to this heading">ïƒ</a></h2>
<p>Now weâ€™re ready to load dataset via <code class="docutils literal notranslate"><span class="pre">dgl.graphbolt.OnDiskDataset</span></code>. When instantiating, we just pass in the base directory where <code class="docutils literal notranslate"><span class="pre">metadata.yaml</span></code> file lies.</p>
<p>During first instantiation, GraphBolt preprocesses the raw data such as constructing <code class="docutils literal notranslate"><span class="pre">FusedCSCSamplingGraph</span></code> from edges. All data including graph, feature data, training/validation/test sets are put into <code class="docutils literal notranslate"><span class="pre">preprocessed</span></code> directory after preprocessing. Any following dataset loading will skip the preprocess stage.</p>
<p>After preprocessing, <code class="docutils literal notranslate"><span class="pre">load()</span></code> is required to be called explicitly in order to load graph, feature data and tasks.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">OnDiskDataset</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">graph</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Loaded graph: </span><span class="si">{</span><span class="n">graph</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">feature</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">feature</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Loaded feature store: </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">tasks</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">tasks</span>
<span class="n">nc_task</span> <span class="o">=</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Loaded node classification task: </span><span class="si">{</span><span class="n">nc_task</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">lp_task</span> <span class="o">=</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Loaded link prediction task: </span><span class="si">{</span><span class="n">lp_task</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Start to preprocess the on-disk dataset.
Finish preprocessing the on-disk dataset.
Loaded graph: FusedCSCSamplingGraph(csc_indptr=tensor([    0,     7,    17,  ..., 19982, 19994, 20000], dtype=torch.int32),
                      indices=tensor([1850, 1045, 1554,  ..., 1857, 1541, 1092], dtype=torch.int32),
                      total_num_nodes=2000, num_edges={'user:follow:user': 10000, 'user:like:item': 10000},
                      node_type_offset=tensor([   0, 1000, 2000], dtype=torch.int32),
                      type_per_edge=tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.uint8),
                      node_type_to_id={'item': 0, 'user': 1},
                      edge_type_to_id={'user:follow:user': 0, 'user:like:item': 1},)

Loaded feature store: TorchBasedFeatureStore(
    {(&lt;OnDiskFeatureDataDomain.NODE: 'node'&gt;, 'user', 'feat_0'): TorchBasedFeature(
        feature=tensor([[0.8659, 0.3669, 0.8055, 0.8852, 0.2393],
                        [0.7628, 0.7895, 0.1330, 0.7141, 0.8674],
                        [0.0112, 0.6616, 0.1752, 0.9180, 0.6134],
                        ...,
                        [0.0316, 0.4928, 0.7206, 0.1901, 0.3156],
                        [0.3883, 0.0449, 0.1199, 0.4636, 0.1222],
                        [0.7198, 0.0490, 0.5728, 0.6276, 0.8983]], dtype=torch.float64),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.NODE: 'node'&gt;, 'user', 'feat_1'): TorchBasedFeature(
        feature=tensor([[0.2342, 0.5693, 0.2327, 0.7932, 0.0868],
                        [0.7924, 0.7743, 0.5318, 0.3769, 0.9091],
                        [0.1576, 0.9347, 0.3034, 0.6907, 0.5149],
                        ...,
                        [0.2753, 0.5698, 0.2631, 0.6976, 0.7737],
                        [0.9673, 0.9025, 0.9308, 0.6647, 0.7429],
                        [0.7328, 0.9446, 0.5796, 0.4436, 0.6816]]),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.NODE: 'node'&gt;, 'item', 'feat_0'): TorchBasedFeature(
        feature=tensor([[0.0091, 0.7537, 0.6838, 0.2493, 0.4913],
                        [0.4459, 0.4852, 0.5373, 0.0300, 0.7871],
                        [0.7139, 0.0603, 0.9627, 0.7727, 0.8026],
                        ...,
                        [0.4305, 0.5634, 0.2227, 0.6880, 0.4843],
                        [0.1140, 0.8022, 0.2572, 0.3225, 0.7963],
                        [0.9134, 0.0690, 0.6148, 0.2615, 0.6843]], dtype=torch.float64),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.NODE: 'node'&gt;, 'item', 'feat_1'): TorchBasedFeature(
        feature=tensor([[0.2715, 0.1009, 0.7798, 0.3161, 0.6281],
                        [0.5356, 0.1839, 0.1494, 0.0695, 0.7149],
                        [0.8192, 0.0899, 0.4618, 0.9902, 0.2378],
                        ...,
                        [0.7855, 0.2926, 0.7571, 0.9710, 0.5671],
                        [0.2441, 0.1318, 0.9118, 0.7750, 0.0776],
                        [0.9983, 0.0053, 0.4450, 0.2343, 0.3930]]),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.EDGE: 'edge'&gt;, 'user:like:item', 'feat_0'): TorchBasedFeature(
        feature=tensor([[0.1817, 0.3337, 0.9781, 0.9129, 0.9727],
                        [0.2626, 0.9608, 0.8491, 0.2182, 0.0283],
                        [0.9702, 0.8350, 0.7801, 0.3843, 0.5061],
                        ...,
                        [0.6613, 0.6182, 0.6692, 0.1758, 0.3522],
                        [0.1895, 0.8058, 0.3396, 0.4105, 0.7655],
                        [0.8176, 0.3848, 0.7513, 0.6718, 0.8083]], dtype=torch.float64),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.EDGE: 'edge'&gt;, 'user:like:item', 'feat_1'): TorchBasedFeature(
        feature=tensor([[0.0588, 0.6019, 0.0758, 0.1623, 0.8252],
                        [0.7217, 0.0413, 0.1478, 0.5147, 0.4526],
                        [0.9581, 0.3234, 0.1832, 0.8287, 0.4456],
                        ...,
                        [0.0774, 0.0125, 0.2288, 0.0716, 0.8648],
                        [0.7765, 0.4510, 0.9263, 0.4882, 0.1186],
                        [0.0041, 0.8159, 0.3032, 0.1642, 0.4480]]),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.EDGE: 'edge'&gt;, 'user:follow:user', 'feat_0'): TorchBasedFeature(
        feature=tensor([[0.2024, 0.9088, 0.6983, 0.8182, 0.8067],
                        [0.1617, 0.4134, 0.5966, 0.3591, 0.7491],
                        [0.2981, 0.6257, 0.3772, 0.0204, 0.2180],
                        ...,
                        [0.7923, 0.0628, 0.5994, 0.5737, 0.9075],
                        [0.4584, 0.1183, 0.1681, 0.9166, 0.4986],
                        [0.8980, 0.2165, 0.9448, 0.3192, 0.4907]], dtype=torch.float64),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.EDGE: 'edge'&gt;, 'user:follow:user', 'feat_1'): TorchBasedFeature(
        feature=tensor([[0.5152, 0.0901, 0.7275, 0.2375, 0.8019],
                        [0.4192, 0.1346, 0.5076, 0.4917, 0.3726],
                        [0.4777, 0.4895, 0.1151, 0.4698, 0.4707],
                        ...,
                        [0.3561, 0.1062, 0.6275, 0.3160, 0.0041],
                        [0.4299, 0.5147, 0.7481, 0.6620, 0.5365],
                        [0.0401, 0.6750, 0.1823, 0.1251, 0.3330]]),
        metadata={},
    )}
)

Loaded node classification task: OnDiskTask(validation_set=HeteroItemSet(
               itemsets={'user': ItemSet(
                            items=(tensor([799, 400, 605, 311, 800, 748, 374, 868, 537,   0,  13, 695, 291, 122,
                                559, 873,  73,  53, 103,  89, 477, 519, 172, 866, 159, 661, 192, 680,
                                706, 436, 336, 921, 724, 647, 550, 959, 710, 897, 789,  49, 505,  59,
                                672, 139, 884, 392, 841, 174, 649, 114, 804, 239, 445, 248,  82, 108,
                                795, 763, 138, 582, 662, 780, 826,  74, 927, 214, 859, 570, 572, 753,
                                132, 287, 412, 421, 237,  98, 465, 381, 910, 713, 224, 378, 545, 326,
                                843, 716, 731, 125,  34, 327, 227, 730, 523, 807, 752, 542, 840, 659,
                                640, 835, 247, 464, 379, 744,  48, 162, 309, 277,  18, 396, 980, 812,
                                361, 113, 546, 231, 168, 739, 568, 699, 275, 321, 193, 900, 202, 328,
                                510, 131,  54, 318, 369, 593,  85, 509, 878, 160,  32, 562, 429,  78,
                                  9, 876, 276, 793, 414,  12, 144, 310, 617,   5, 738, 517, 335, 913,
                                989, 289, 342, 563, 999, 501, 988, 249, 947, 362, 969, 819, 524, 774,
                                147, 312, 282, 417, 973, 229, 353, 199, 631, 241, 635, 715, 502,  15,
                                217, 857, 757, 747, 758, 351, 665, 367, 693, 388, 575, 581, 158, 685,
                                355, 618, 996, 363], dtype=torch.int32), tensor([0, 1, 5, 7, 3, 8, 9, 8, 1, 9, 0, 6, 2, 0, 5, 7, 5, 1, 2, 8, 8, 5, 7, 6,
                                5, 1, 5, 7, 7, 8, 1, 5, 6, 0, 1, 6, 9, 5, 9, 9, 1, 9, 7, 5, 6, 5, 0, 7,
                                4, 2, 5, 4, 0, 8, 4, 1, 0, 2, 8, 0, 1, 2, 1, 4, 5, 9, 9, 9, 5, 8, 5, 0,
                                2, 6, 3, 6, 8, 3, 1, 9, 3, 7, 8, 2, 4, 2, 5, 4, 0, 8, 8, 9, 7, 3, 8, 5,
                                3, 2, 4, 6, 2, 9, 1, 6, 3, 2, 7, 7, 6, 7, 9, 2, 2, 0, 0, 0, 9, 2, 5, 0,
                                5, 5, 2, 0, 7, 7, 6, 2, 8, 9, 0, 8, 1, 3, 1, 5, 4, 4, 5, 7, 0, 1, 3, 9,
                                6, 3, 6, 4, 6, 3, 4, 8, 7, 0, 3, 6, 3, 8, 6, 6, 5, 7, 0, 8, 6, 9, 6, 2,
                                6, 4, 6, 5, 2, 6, 7, 4, 1, 3, 2, 8, 7, 9, 6, 5, 0, 2, 2, 2, 5, 7, 3, 8,
                                1, 2, 4, 8, 5, 7, 4, 5])),
                            names=('seeds', 'labels'),
                        ), 'item': ItemSet(
                            items=(tensor([113, 549, 231, 235, 725, 493, 166,   8, 120, 962,  92, 119, 161, 401,
                                790, 683, 337, 711, 833, 526, 867, 661, 742, 357, 435, 963, 274, 370,
                                905, 665, 156, 313, 378,  98, 591, 780, 205, 132,  56, 617, 808, 620,
                                716, 888, 418, 562, 374, 935, 452, 773, 416, 101, 586, 335, 497, 444,
                                971, 442, 151,  22, 491, 778, 518, 208, 415,  42, 843, 369, 412, 578,
                                436, 548, 332, 643,   5, 287, 261, 437, 903, 821, 258,  76, 389,  77,
                                839, 108, 734, 393,  44, 653, 704, 365, 813, 709, 171, 801, 974, 278,
                                658, 786, 431, 537, 584,   2, 733, 368, 881,  69, 163, 812, 215, 646,
                                611, 989, 776, 895, 178, 717, 601, 581, 221, 818, 423, 180, 945, 481,
                                328, 654, 443, 355, 886, 105, 761, 687, 238, 628, 141, 715, 924, 847,
                                913, 960, 688, 638, 474, 345, 788, 996,   3, 551, 840, 216, 928, 405,
                                 55, 873, 884, 943, 673, 167, 300, 471, 206, 367, 307, 237, 495, 844,
                                 11, 594, 555, 904, 774, 553, 624, 213, 828, 530,  49, 177, 975,  80,
                                255, 614, 192, 737, 500, 770, 977, 948, 106, 647, 767, 212,   7, 128,
                                929, 233, 301, 343], dtype=torch.int32), tensor([1, 8, 6, 2, 1, 6, 5, 4, 7, 2, 5, 8, 5, 5, 5, 2, 4, 8, 3, 0, 9, 8, 7, 2,
                                3, 3, 4, 2, 2, 7, 9, 9, 7, 0, 1, 5, 6, 7, 9, 9, 7, 7, 5, 0, 7, 0, 6, 2,
                                0, 0, 2, 1, 1, 0, 5, 3, 3, 7, 0, 6, 2, 3, 6, 1, 4, 1, 9, 1, 8, 1, 6, 8,
                                3, 1, 1, 9, 0, 4, 4, 6, 9, 0, 9, 2, 7, 8, 5, 5, 1, 0, 5, 0, 5, 8, 1, 4,
                                1, 7, 4, 8, 9, 7, 1, 5, 8, 0, 5, 6, 9, 8, 9, 6, 2, 4, 4, 9, 6, 6, 1, 5,
                                7, 9, 5, 4, 4, 7, 7, 6, 4, 8, 1, 0, 6, 7, 1, 4, 4, 6, 6, 5, 1, 7, 2, 5,
                                0, 0, 6, 1, 3, 1, 0, 1, 9, 3, 7, 2, 0, 6, 9, 5, 6, 2, 8, 8, 8, 4, 0, 8,
                                5, 6, 2, 6, 2, 8, 1, 5, 2, 4, 7, 2, 6, 4, 6, 3, 6, 4, 0, 8, 9, 5, 0, 8,
                                3, 3, 5, 6, 3, 6, 1, 3])),
                            names=('seeds', 'labels'),
                        )},
               names=('seeds', 'labels'),
           ),
           train_set=HeteroItemSet(
               itemsets={'user': ItemSet(
                            items=(tensor([161, 439, 280, 198, 120, 136, 490, 194, 458, 250, 357, 790,  68, 571,
                                 19, 332,  55, 167, 435, 112, 930, 123, 134, 156, 173, 952, 526, 317,
                                 76, 908, 169, 642,  57, 906, 515, 931, 638, 461, 185,  72, 475, 778,
                                420, 851, 837, 454, 756, 861,  86, 522, 270, 820, 294, 872, 971,  23,
                                489, 302, 847, 535, 679, 765, 880,   6, 689, 852, 762, 806, 476, 296,
                                709, 459, 586, 143, 797, 557, 484, 985, 725, 937, 534, 533, 766, 574,
                                180, 325, 225, 671, 514, 182, 390, 663, 919, 904, 569, 821, 171, 854,
                                487, 771, 613, 260, 304, 496, 838, 455, 152, 823, 905, 176,  10, 486,
                                157, 834, 951, 902, 410, 972, 928, 329, 181,  81, 265, 592, 678, 595,
                                308, 442, 391, 504, 370, 415, 829, 986, 776,   1, 499, 377, 890, 740,
                                266,  45, 660, 473, 997, 230, 316, 283, 815, 107, 923, 623, 934, 692,
                                263, 998, 109, 888, 941, 200, 751, 711, 338, 565, 226,  43,   4, 303,
                                920, 993, 423,  37,  28, 909, 603, 966, 105, 197, 772, 708, 284, 234,
                                767, 346,   3, 216, 721, 349, 588, 653,  94, 791, 356, 696, 601, 154,
                                470, 347, 722, 467,  63,  60, 178, 690, 567, 863, 299, 599, 340,  33,
                                288, 481, 654, 970, 268, 453, 669, 344, 657, 743, 416, 697, 341, 498,
                                670, 532, 798, 914, 164,   2, 602, 932, 645,  84, 926, 191, 118, 867,
                                129, 830, 233, 399, 235, 324, 626, 434, 212, 604, 566, 219, 295, 620,
                                781, 322, 186, 190, 406, 447, 491, 945, 130, 189, 637, 339,  16, 155,
                                656, 256, 383, 580, 668, 451, 609, 424, 639, 472,  51, 240,  96, 871,
                                345, 404,  91, 632, 924, 348, 987, 221, 822, 427, 824, 978, 558, 350,
                                606, 775, 413, 506, 253, 918, 828, 258, 111, 704, 206, 556, 664,  69,
                                403, 210, 468, 621, 306, 170, 549,  71, 352, 614, 701, 511, 150, 281,
                                667, 494, 610, 779, 687, 853, 684, 974, 269, 360, 228, 864, 607,  25,
                                787,  61, 175, 714, 809, 677, 507, 994, 691, 148, 933, 611,  79, 211,
                                911, 133, 100, 209, 395, 982,   7, 712, 737, 165, 641, 137, 833, 633,
                                195, 984,  38, 960, 719,  88, 589, 196, 889, 243, 323, 387, 527, 463,
                                 40, 298, 177,  50, 314, 238, 488, 788, 466, 443, 741, 375, 961, 720,
                                368,  77, 115, 899, 983, 293, 591, 675, 817, 166, 425, 223, 858, 146,
                                354, 990,  35,  26, 783, 865, 784, 707, 885, 500, 135,  42, 117, 770,
                                624, 636,  66, 102, 977, 482, 734,  22, 874, 810, 658, 555, 967, 898,
                                358, 723, 242, 544, 686,  87, 397, 587, 153, 674,  64, 405, 255, 856,
                                929, 673, 957, 955, 903, 785, 205, 426, 579, 628, 896, 750, 547, 995,
                                264, 616,  58, 917, 267, 813, 682, 683, 385, 883, 769, 402,  39, 307,
                                300, 407, 936,  62, 553, 786, 246, 554, 331, 655, 431, 831, 612, 735,
                                315,  24, 901, 832, 849, 203, 991, 389,  95, 474, 539, 520, 893, 976,
                                814, 337, 622, 802, 578, 585, 124, 456, 560, 513, 262, 954, 892, 365,
                                644,  83, 755, 827, 703, 681, 940, 254, 438, 992, 907, 220, 573, 343,
                                839, 359, 531, 796, 110, 398, 333, 597, 236, 742, 625, 140, 634, 279,
                                666, 782, 430,  56, 334, 480, 274, 608, 286, 126, 141,  46, 457, 651,
                                530, 409, 469, 698, 891, 320, 948, 630, 794, 128, 106, 729, 372, 273,
                                492, 245, 717, 777, 600, 271, 881, 745,  20, 257,  92, 879, 364, 875,
                                646,  97, 460, 528, 846, 449, 540, 963, 887, 222, 319, 700],
                               dtype=torch.int32), tensor([2, 9, 7, 1, 5, 8, 6, 3, 6, 3, 1, 4, 7, 3, 9, 2, 0, 3, 1, 4, 9, 2, 5, 1,
                                9, 4, 3, 3, 1, 0, 5, 4, 7, 5, 5, 1, 6, 7, 0, 2, 9, 6, 3, 9, 1, 9, 8, 6,
                                4, 9, 0, 8, 0, 7, 2, 9, 4, 5, 6, 4, 4, 8, 7, 2, 0, 1, 6, 5, 1, 5, 9, 7,
                                8, 9, 0, 3, 3, 1, 9, 7, 5, 2, 0, 0, 3, 0, 8, 1, 9, 4, 0, 1, 0, 2, 1, 5,
                                3, 0, 2, 7, 5, 8, 4, 8, 9, 8, 7, 1, 6, 7, 7, 0, 6, 5, 4, 4, 6, 7, 9, 8,
                                3, 7, 0, 2, 4, 7, 5, 2, 0, 8, 0, 5, 9, 0, 6, 7, 7, 7, 0, 5, 0, 2, 4, 9,
                                4, 4, 3, 5, 8, 9, 4, 5, 8, 9, 9, 9, 4, 0, 5, 4, 2, 8, 3, 4, 6, 1, 3, 2,
                                4, 0, 0, 8, 7, 8, 9, 3, 6, 2, 9, 4, 6, 7, 9, 0, 4, 9, 7, 8, 9, 8, 0, 2,
                                2, 8, 5, 8, 9, 2, 5, 4, 8, 0, 6, 9, 5, 2, 0, 5, 4, 8, 5, 6, 6, 9, 0, 9,
                                1, 2, 1, 4, 9, 7, 5, 0, 4, 5, 0, 1, 3, 7, 3, 3, 9, 6, 4, 7, 0, 2, 3, 4,
                                1, 5, 5, 4, 7, 6, 4, 8, 2, 3, 3, 5, 5, 7, 5, 1, 6, 0, 4, 1, 8, 5, 8, 9,
                                9, 5, 1, 7, 9, 7, 4, 7, 0, 9, 6, 8, 5, 3, 6, 6, 0, 9, 9, 1, 7, 1, 1, 2,
                                6, 7, 4, 9, 0, 6, 7, 8, 3, 0, 5, 4, 7, 0, 6, 9, 8, 0, 5, 3, 4, 5, 7, 7,
                                0, 9, 2, 7, 6, 4, 6, 4, 6, 0, 4, 7, 0, 3, 1, 2, 4, 3, 4, 7, 6, 5, 3, 7,
                                5, 7, 7, 9, 6, 4, 7, 0, 5, 5, 0, 3, 9, 7, 7, 5, 8, 8, 2, 2, 8, 4, 7, 5,
                                7, 0, 2, 2, 6, 2, 2, 7, 5, 3, 5, 9, 1, 7, 2, 6, 2, 2, 3, 5, 4, 3, 5, 5,
                                9, 4, 1, 2, 2, 5, 9, 4, 0, 9, 6, 1, 6, 5, 8, 9, 1, 7, 4, 3, 8, 3, 0, 3,
                                8, 5, 6, 9, 4, 7, 9, 3, 6, 5, 1, 2, 5, 6, 3, 3, 3, 9, 5, 1, 1, 3, 8, 9,
                                4, 4, 3, 4, 1, 1, 1, 4, 4, 6, 8, 5, 8, 3, 9, 8, 6, 1, 8, 7, 5, 4, 7, 1,
                                3, 6, 0, 0, 1, 8, 5, 6, 4, 6, 6, 8, 5, 2, 4, 7, 2, 0, 7, 6, 1, 3, 3, 2,
                                8, 9, 7, 3, 9, 7, 8, 1, 4, 3, 2, 7, 8, 3, 3, 6, 4, 3, 5, 1, 0, 5, 1, 8,
                                5, 0, 0, 8, 8, 9, 0, 8, 8, 4, 9, 2, 5, 9, 4, 2, 0, 8, 1, 6, 8, 9, 4, 8,
                                2, 5, 9, 9, 9, 1, 5, 5, 2, 0, 5, 7, 0, 6, 7, 5, 8, 2, 1, 8, 0, 4, 2, 8,
                                1, 9, 6, 9, 1, 6, 0, 0, 1, 5, 0, 7, 9, 4, 7, 6, 2, 0, 3, 5, 2, 8, 3, 1,
                                4, 5, 4, 3, 5, 1, 4, 1, 7, 6, 1, 0, 5, 4, 0, 2, 3, 3, 4, 0, 3, 9, 6, 1])),
                            names=('seeds', 'labels'),
                        ), 'item': ItemSet(
                            items=(tensor([758,  12, 811, 667, 248, 799, 529, 422, 288, 662, 353, 627, 477, 217,
                                995, 125, 952, 176, 949, 559,  89, 138, 523, 906, 718, 753, 499, 407,
                                 74, 187, 200, 247, 115, 144, 470,  91, 395, 281, 806, 387, 197, 755,
                                402, 540, 911, 179, 383, 482, 868,  47, 366, 992, 841, 318, 298,  50,
                                227, 590, 461, 222,  53, 829, 982, 186,   0, 292, 538, 582, 207, 814,
                                363, 736, 797,  88, 323, 981, 349, 988, 487, 515, 640,  90, 955, 158,
                                285, 897, 700, 421,  75, 277, 403, 159, 693, 267, 864, 636, 524, 347,
                                670, 272,  57, 498, 751, 915, 327, 312, 294, 507,  21, 834, 259, 648,
                                324, 713, 791, 939, 315, 168,  37, 275,  32, 568, 657, 361, 460, 457,
                                133, 494, 232, 760,  51, 880, 209, 545, 750, 279, 440, 496, 321, 796,
                                 23, 251,  17, 917, 656, 351,  35, 396,  25, 866, 359, 446, 820, 447,
                                738, 198, 199, 124,  52, 946, 390, 572, 902, 990, 997, 785, 817, 837,
                                 71, 944, 299, 645, 609,  61, 937, 189, 191,  20, 845, 973, 570, 331,
                                534, 535, 270, 969, 265, 184, 244, 339, 865, 714, 486, 877, 145, 434,
                                842, 219, 980, 993, 224, 107, 641, 894, 809, 599, 228, 879, 719, 354,
                                707, 891,  95, 266, 511, 676, 319, 334, 445, 756, 229, 264, 430, 484,
                                919, 890, 608, 150, 243, 519, 863, 743, 306, 726, 439, 468, 556, 480,
                                185, 316, 469, 379,  29, 930, 531, 827,  24, 853, 604, 317, 956, 451,
                                727, 131, 342, 851,  81, 630, 236, 991, 226, 525, 116,  59, 970, 305,
                                134, 336, 681, 634, 872, 377, 149, 286, 558, 472, 690, 677, 505, 424,
                                623,  34, 512, 838, 765, 376, 510, 453,  83, 210, 514, 625, 162, 606,
                                835, 689, 333, 560, 218, 565, 533, 849, 576, 502, 802, 674, 804, 441,
                                616, 793, 644, 815, 256,  60, 697, 633, 478, 787, 513, 882, 875, 795,
                                118, 836,   4, 296, 388, 927, 783, 862, 763, 391, 344, 901, 632, 998,
                                 19, 260, 910, 747, 692, 800, 874, 784, 900, 933, 615, 951, 959, 448,
                                810, 858, 490, 211, 276, 595, 967,  78, 428, 602, 140, 182, 652, 127,
                                748,   1, 823, 165, 459, 155,  70, 293, 271, 488, 280, 152, 170,  99,
                                805, 789, 382, 263, 921, 492, 362, 746, 679, 561, 779, 920, 304, 429,
                                885,  48, 143, 290, 745, 752, 702, 240, 706, 283, 985, 724, 380, 857,
                                664, 397, 764, 375, 223, 860, 571,  93, 148, 249, 893, 204, 626, 517,
                                 46, 153, 887, 824, 926, 384, 740, 968, 671, 618, 854, 856,  62, 476,
                                876, 932, 983, 607,  26, 464, 350,  66, 419, 589, 203, 914, 291, 202,
                                663, 782, 467, 522, 892, 329, 136, 245,  40, 923, 855, 585, 950, 666,
                                196, 302, 386, 712, 320, 408, 642, 629, 965, 352, 326, 541, 295, 123,
                                230, 675, 242, 552, 450, 392, 631, 225, 994, 708, 916, 635, 542, 775,
                                 54, 489, 371, 819,  13, 771, 254, 348, 194, 432, 252, 532, 986, 262,
                                338, 612, 966, 417, 322, 941, 438, 757, 659, 330, 174,  39, 925, 899,
                                122, 483, 869, 593, 831, 539, 698, 381, 102, 284, 147,  28, 908, 912,
                                695, 463, 311, 792, 364, 668,  94,  16, 157,  30, 592, 373, 160, 685,
                                130, 516, 550, 744,  84, 832, 475, 100, 175, 909, 979, 703, 597, 961,
                                999, 580,  27, 878, 957, 314, 172, 825,  18, 678, 794,  65, 907, 577,
                                650, 449,   9,  33, 978, 896, 655,  72, 458, 710, 566, 308, 680,  36,
                                169, 889, 731, 701, 139, 649, 111, 569, 360, 918, 183, 768],
                               dtype=torch.int32), tensor([7, 5, 3, 0, 7, 9, 2, 2, 4, 4, 3, 5, 7, 7, 7, 0, 9, 0, 7, 8, 6, 1, 7, 4,
                                5, 5, 8, 7, 6, 6, 2, 7, 5, 7, 0, 1, 6, 9, 3, 9, 9, 4, 5, 5, 7, 9, 1, 1,
                                8, 2, 3, 9, 9, 2, 2, 3, 1, 5, 1, 3, 7, 9, 7, 0, 1, 2, 9, 1, 5, 4, 2, 0,
                                1, 5, 7, 2, 9, 9, 3, 2, 2, 5, 6, 8, 4, 9, 0, 6, 5, 7, 2, 6, 9, 6, 0, 1,
                                8, 2, 8, 5, 2, 2, 9, 8, 3, 3, 1, 3, 8, 5, 5, 1, 8, 3, 9, 3, 8, 1, 6, 2,
                                9, 8, 4, 7, 5, 6, 0, 7, 4, 2, 7, 8, 5, 8, 5, 8, 8, 4, 8, 6, 8, 1, 9, 8,
                                5, 8, 6, 4, 0, 1, 8, 2, 6, 5, 8, 0, 4, 0, 5, 4, 3, 5, 5, 7, 5, 3, 4, 1,
                                7, 1, 9, 8, 8, 1, 0, 4, 7, 1, 2, 0, 3, 3, 2, 5, 9, 7, 2, 6, 4, 1, 5, 2,
                                5, 4, 9, 1, 3, 2, 0, 7, 5, 4, 5, 9, 2, 3, 1, 1, 9, 4, 8, 4, 1, 3, 9, 9,
                                3, 1, 5, 6, 3, 8, 7, 3, 6, 8, 3, 6, 0, 0, 3, 2, 2, 9, 0, 9, 1, 1, 1, 1,
                                3, 5, 5, 1, 0, 7, 7, 7, 8, 6, 0, 4, 9, 7, 8, 8, 8, 2, 8, 9, 5, 1, 6, 0,
                                7, 9, 2, 9, 6, 1, 8, 7, 1, 9, 7, 3, 8, 8, 0, 2, 7, 1, 1, 3, 0, 2, 0, 3,
                                6, 4, 3, 7, 6, 5, 4, 0, 4, 5, 7, 5, 4, 8, 6, 2, 4, 6, 8, 5, 9, 5, 3, 6,
                                6, 3, 0, 6, 5, 3, 0, 2, 3, 7, 2, 5, 1, 6, 8, 0, 0, 2, 6, 5, 6, 3, 4, 4,
                                1, 4, 7, 6, 4, 4, 9, 6, 1, 1, 5, 6, 7, 0, 9, 0, 2, 3, 1, 2, 8, 6, 2, 0,
                                4, 0, 9, 8, 3, 0, 3, 3, 4, 5, 4, 3, 9, 2, 9, 3, 1, 6, 0, 1, 2, 3, 6, 6,
                                1, 9, 3, 3, 9, 9, 1, 6, 6, 3, 8, 0, 5, 2, 8, 8, 6, 6, 3, 3, 8, 3, 8, 2,
                                3, 3, 3, 9, 9, 7, 8, 6, 9, 9, 9, 6, 4, 6, 0, 4, 8, 7, 8, 9, 5, 0, 1, 4,
                                0, 6, 5, 3, 5, 9, 6, 6, 0, 0, 2, 3, 0, 1, 7, 1, 2, 8, 9, 5, 5, 5, 7, 6,
                                1, 0, 0, 1, 3, 5, 8, 5, 8, 9, 8, 6, 9, 6, 8, 1, 9, 6, 2, 3, 9, 2, 8, 2,
                                3, 8, 5, 3, 4, 2, 1, 1, 7, 2, 2, 6, 9, 6, 6, 4, 1, 4, 9, 1, 7, 3, 3, 5,
                                5, 9, 6, 9, 2, 5, 9, 1, 7, 5, 8, 7, 2, 9, 2, 9, 9, 3, 5, 0, 5, 2, 4, 7,
                                4, 5, 7, 6, 9, 9, 9, 0, 4, 4, 3, 6, 1, 5, 8, 3, 6, 4, 6, 5, 5, 0, 2, 5,
                                4, 4, 7, 0, 7, 8, 4, 0, 4, 7, 7, 5, 0, 6, 2, 1, 7, 3, 0, 1, 0, 7, 4, 3,
                                0, 8, 2, 4, 4, 0, 2, 4, 0, 0, 3, 9, 8, 5, 3, 9, 9, 2, 7, 1, 7, 5, 0, 0])),
                            names=('seeds', 'labels'),
                        )},
               names=('seeds', 'labels'),
           ),
           test_set=HeteroItemSet(
               itemsets={'user': ItemSet(
                            items=(tensor([590, 944, 939, 962, 733, 818, 411, 184, 444, 676, 437, 862, 564, 446,
                                 30,  36, 183, 292, 736, 478, 759, 576, 760, 596, 104, 529, 561, 728,
                                401, 808, 207, 201, 792, 441, 448, 543, 848, 844, 394, 925, 842, 981,
                                 52, 584, 485, 386, 805, 272, 627, 521, 718, 702, 912, 949,  44, 261,
                                142, 754, 979, 452, 877, 801, 768, 479, 598, 204, 432, 278, 213,  67,
                                825, 548, 244, 895, 422, 705,  70, 650, 746, 259, 440, 371, 525, 497,
                                330, 116, 694, 285, 732, 629, 836, 149, 764, 518, 380, 964,  47, 975,
                                943, 552, 218, 726, 290, 163,  65, 428, 408,   8, 643, 577, 749, 301,
                                811, 956, 915, 366, 471, 536, 965,  29, 313,  27, 551, 619, 376, 942,
                                384, 373, 508, 803,  17,  80, 251, 121,  11, 462, 145,  75, 151, 493,
                                538, 127, 188, 727, 433, 761, 382, 393, 297, 615, 418, 935, 450,  93,
                                215, 950, 503, 860, 882, 179,  31, 652, 419, 305,  41, 594, 483, 845,
                                773, 119, 512, 187, 968, 252, 688, 541, 946, 953, 208, 516, 870, 101,
                                894, 886, 495, 916, 648, 855, 850,  90,  99, 583, 816, 232,  14, 958,
                                 21, 922, 869, 938], dtype=torch.int32), tensor([1, 6, 8, 3, 7, 7, 1, 7, 8, 4, 5, 3, 7, 1, 4, 2, 7, 8, 3, 0, 0, 2, 8, 3,
                                5, 8, 3, 8, 2, 8, 2, 6, 3, 7, 7, 9, 7, 3, 6, 4, 3, 2, 2, 6, 8, 8, 4, 4,
                                2, 4, 3, 7, 5, 9, 7, 2, 4, 9, 8, 6, 0, 1, 2, 7, 1, 0, 9, 4, 8, 9, 1, 5,
                                0, 2, 5, 0, 3, 1, 5, 5, 1, 7, 7, 0, 2, 5, 1, 3, 4, 1, 2, 9, 1, 0, 2, 3,
                                9, 8, 7, 4, 8, 9, 3, 6, 7, 7, 3, 2, 3, 2, 3, 3, 1, 5, 2, 5, 6, 0, 0, 2,
                                2, 5, 4, 5, 1, 8, 8, 7, 0, 3, 6, 4, 2, 5, 6, 9, 9, 9, 5, 4, 8, 1, 2, 5,
                                5, 3, 9, 9, 9, 8, 0, 8, 9, 1, 7, 9, 1, 3, 9, 1, 7, 7, 7, 3, 6, 0, 2, 3,
                                5, 8, 4, 5, 2, 0, 1, 3, 7, 4, 2, 6, 0, 6, 2, 3, 6, 0, 7, 1, 5, 0, 7, 2,
                                2, 6, 9, 9, 5, 1, 3, 8])),
                            names=('seeds', 'labels'),
                        ), 'item': ItemSet(
                            items=(tensor([454, 506, 605, 852, 684, 341,  73, 358, 190, 766, 651,  85, 830, 340,
                                672, 730, 603, 953, 527,  86,  97, 669, 964, 547, 520, 816, 691, 807,
                                826, 103, 404, 722, 164, 694, 509, 473, 394, 325, 485, 466, 126, 536,
                                 41,  58, 234, 109, 781, 598, 154, 870, 938, 682, 356, 883,  31,  67,
                                987, 546, 385, 749, 739, 104, 465, 575, 427, 769, 942, 479, 563, 455,
                                110, 246, 504, 931, 253, 426,  14, 399, 940, 741, 544, 528, 637, 721,
                                193, 220, 195, 268, 503, 723, 947, 112, 848, 777,  64,  15, 214, 117,
                                735, 759, 583, 420, 282, 181, 898, 871, 728, 406, 508,  38, 273, 414,
                                 68, 413, 135, 425, 462, 762, 798, 564, 257, 922,  10, 567, 705, 411,
                                686, 772, 846, 129, 696, 622, 579, 984, 600, 861, 346, 754, 239,  79,
                                289, 732, 241, 142, 976, 729, 309,  63, 619, 137, 521, 409, 554, 372,
                                573, 400, 201, 972, 803, 297, 543, 850, 121,  87, 587, 557, 588, 720,
                                 96,  45, 114, 822, 188,  82, 574, 699, 146, 501, 958, 610, 660, 936,
                                596, 621, 398, 456, 859, 303, 310, 639, 433, 269, 954,  43, 173, 250,
                                613, 934, 410,   6], dtype=torch.int32), tensor([2, 6, 7, 4, 7, 0, 0, 5, 0, 8, 0, 3, 7, 5, 4, 9, 1, 6, 9, 7, 9, 8, 7, 5,
                                9, 8, 1, 6, 1, 9, 5, 9, 8, 5, 3, 6, 8, 3, 9, 8, 6, 8, 2, 7, 4, 3, 3, 3,
                                8, 5, 2, 9, 8, 6, 5, 0, 6, 0, 0, 4, 7, 7, 3, 6, 8, 3, 0, 9, 7, 5, 4, 4,
                                5, 2, 0, 3, 0, 5, 0, 7, 4, 2, 0, 1, 0, 7, 9, 0, 6, 3, 2, 2, 2, 8, 4, 8,
                                3, 3, 6, 7, 5, 7, 5, 9, 5, 2, 2, 6, 5, 4, 8, 8, 2, 4, 4, 9, 0, 6, 0, 9,
                                3, 1, 2, 0, 9, 4, 2, 1, 3, 1, 8, 8, 4, 5, 1, 6, 3, 8, 8, 0, 7, 8, 9, 5,
                                9, 9, 7, 9, 1, 6, 5, 9, 4, 7, 3, 4, 7, 5, 8, 8, 3, 6, 9, 2, 3, 3, 4, 2,
                                1, 6, 4, 1, 0, 9, 4, 0, 8, 6, 1, 1, 4, 8, 5, 1, 0, 0, 2, 3, 5, 4, 0, 6,
                                2, 0, 1, 8, 4, 2, 6, 7])),
                            names=('seeds', 'labels'),
                        )},
               names=('seeds', 'labels'),
           ),
           metadata={'name': 'node_classification', 'num_classes': 10},)

Loaded link prediction task: OnDiskTask(validation_set=HeteroItemSet(
               itemsets={'user:like:item': ItemSet(
                            items=(tensor([[784, 313],
                                [507, 619],
                                [ 34, 603],
                                ...,
                                [389, 879],
                                [389, 295],
                                [389, 372]], dtype=torch.int32), tensor([1., 1., 1.,  ..., 0., 0., 0.], dtype=torch.float64), tensor([   0,    1,    2,  ..., 1999, 1999, 1999])),
                            names=('seeds', 'labels', 'indexes'),
                        ), 'user:follow:user': ItemSet(
                            items=(tensor([[421, 796],
                                [440, 976],
                                [999, 390],
                                ...,
                                [947, 945],
                                [947, 167],
                                [947, 806]], dtype=torch.int32), tensor([1., 1., 1.,  ..., 0., 0., 0.], dtype=torch.float64), tensor([   0,    1,    2,  ..., 1999, 1999, 1999])),
                            names=('seeds', 'labels', 'indexes'),
                        )},
               names=('seeds', 'labels', 'indexes'),
           ),
           train_set=HeteroItemSet(
               itemsets={'user:like:item': ItemSet(
                            items=(tensor([[807,  36],
                                [239, 516],
                                [106, 469],
                                ...,
                                [151, 114],
                                [ 71, 885],
                                [480, 148]], dtype=torch.int32),),
                            names=('seeds',),
                        ), 'user:follow:user': ItemSet(
                            items=(tensor([[863, 884],
                                [369, 106],
                                [834, 980],
                                ...,
                                [898, 844],
                                [  5, 328],
                                [ 46,  91]], dtype=torch.int32),),
                            names=('seeds',),
                        )},
               names=('seeds',),
           ),
           test_set=HeteroItemSet(
               itemsets={'user:like:item': ItemSet(
                            items=(tensor([[895, 931],
                                [764, 495],
                                [864,  73],
                                ...,
                                [338, 503],
                                [338,  36],
                                [338, 863]], dtype=torch.int32), tensor([1., 1., 1.,  ..., 0., 0., 0.], dtype=torch.float64), tensor([   0,    1,    2,  ..., 1999, 1999, 1999])),
                            names=('seeds', 'labels', 'indexes'),
                        ), 'user:follow:user': ItemSet(
                            items=(tensor([[453,  20],
                                [699, 462],
                                [417, 977],
                                ...,
                                [884, 891],
                                [884, 152],
                                [884, 946]], dtype=torch.int32), tensor([1., 1., 1.,  ..., 0., 0., 0.], dtype=torch.float64), tensor([   0,    1,    2,  ..., 1999, 1999, 1999])),
                            names=('seeds', 'labels', 'indexes'),
                        )},
               names=('seeds', 'labels', 'indexes'),
           ),
           metadata={'name': 'link_prediction', 'num_classes': 10},)

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/dgl/python/dgl/graphbolt/impl/ondisk_dataset.py:463: GBWarning: Edge feature is stored, but edge IDs are not saved.
  gb_warning("Edge feature is stored, but edge IDs are not saved.")
</pre></div></div>
</div>
</section>
</section>
</div>
</div>
<footer><div aria-label="Footer" class="rst-footer-buttons" role="navigation">
<a accesskey="p" class="btn btn-neutral float-left" href="ondisk_dataset_homograph.html" rel="prev" title="OnDiskDataset for Homogeneous Graph"><span aria-hidden="true" class="fa fa-arrow-circle-left"></span> Previous</a>
<a accesskey="n" class="btn btn-neutral float-right" href="ondisk-dataset-specification.html" rel="next" title="YAML specification">Next <span aria-hidden="true" class="fa fa-arrow-circle-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<p>Â© Copyright 2018, DGL Team.</p>
</div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" data-toggle="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span class="fa fa-book"> Read the Docs</span>
<span id="version-placeholder">v: latest</span>
<span class="fa fa-caret-down"></span>
</span>
<div class="rst-other-versions">
<dl>
<dt>Versions</dt>
<div id="version-list">
</div>
</dl>
<dl>
<dt>Downloads</dt>
</dl>
<dl>
<dt>On Read the Docs</dt>
<dd><a href="//doc-build.dgl.ai/projects/dgl/?fromdocs=dgl">Project Home</a></dd>
<dd><a href="//doc-build.dgl.ai/builds/dgl/?fromdocs=dgl">Builds</a></dd>
</dl>
</div>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        fetch('/dgl_docs/branches.json')
            .then(response => response.json())
            .then(data => {
                var versionListDiv = document.getElementById('version-list');
                data.branches.forEach(function(branch) {
                    var dd = document.createElement('dd');
                    var a = document.createElement('a');
                    a.href = branch.url;
                    a.textContent = branch.name;
                    dd.appendChild(a);
                    versionListDiv.appendChild(dd);
                });
            })
            .catch(error => console.error('Error loading branches:', error));
    });
    document.addEventListener("DOMContentLoaded", function() {
        // è·å–å½“å‰è·¯å¾„
        var path = window.location.pathname;
        var versionPlaceholder = document.getElementById('version-placeholder');

        
        if (path.includes('/en/')) {
            
            var parts = path.split('/en/');
            if (parts[1]) {
                var folders = parts[1].split('/');
                if (folders.length > 0 && folders[0]) {
                    versionPlaceholder.textContent = 'v: ' + folders[0];
                } else {
                    versionPlaceholder.textContent = 'v: latest';
                }
            } else {
                versionPlaceholder.textContent = 'v: latest';
            }
        } else {
            versionPlaceholder.textContent = 'v: latest';
        }
    });
</script>

<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
</body>
</html>