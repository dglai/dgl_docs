<!DOCTYPE html>

<html class="writer-html5" data-content_root="../" lang="en">
<head>
<meta charset="utf-8"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>OnDiskDataset for Heterogeneous Graph — DGL 2.3.1 documentation</title>
<link href="../_static/pygments.css?v=80d5e7a1" rel="stylesheet" type="text/css"/>
<link href="../_static/css/theme.css?v=19f00094" rel="stylesheet" type="text/css"/>
<link href="../_static/graphviz.css?v=fd3f3429" rel="stylesheet" type="text/css"/>
<link href="../_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery.css?v=d2d258e8" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery-binder.css?v=f4aeca0c" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery-dataframe.css?v=2082cf3c" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" rel="stylesheet" type="text/css"/>
<link href="../_static/nbsphinx-code-cells.css?v=2aa19091" rel="stylesheet" type="text/css"/>
<link href="../_static/css/custom.css?v=0bf289b5" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
<script src="../_static/jquery.js?v=5d32c60e"></script>
<script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
<script src="../_static/documentation_options.js?v=67b02a41"></script>
<script src="../_static/doctools.js?v=9a2dae69"></script>
<script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="../_static/clipboard.min.js?v=a7894cd8"></script>
<script src="../_static/copybutton.js?v=ccdb6887"></script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
<script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="../_static/js/theme.js"></script>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="ondisk-dataset-specification.html" rel="next" title="YAML specification"/>
<link href="ondisk_dataset_homograph.html" rel="prev" title="OnDiskDataset for Homogeneous Graph"/>
</head>
<body class="wy-body-for-nav">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../index.html">
            DGL
          </a>
<div class="version">
                2.3.1
              </div>
<div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
</div><div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Install and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/blitz/index.html">A Blitz Introduction to DGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Materials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">🆕 Stochastic Training of GNNs with GraphBolt</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="neighbor_sampling_overview.html">Neighbor Sampling Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="node_classification.html">Node Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="link_prediction.html">Link Prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="multigpu_node_classification.html">Multi-GPU Node Classification</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="ondisk-dataset.html">Composing OnDiskDataset from raw data</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ondisk_dataset_homograph.html">OnDiskDataset for Homogeneous Graph</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">OnDiskDataset for Heterogeneous Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="ondisk-dataset-specification.html">YAML specification</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide_cn/index.html">用户指南【包含过时信息】</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide_ko/index.html">사용자 가이드[시대에 뒤쳐진]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphtransformer/index.html">🆕 Tutorial: Graph Transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/sparse/index.html">Tutorials: dgl.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cpu/index.html">Training on CPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/multi/index.html">Training on Multiple GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/dist/index.html">Distributed training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/index.html">Paper Study with DGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.html">dgl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.data.html">dgl.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.dataloading.html">dgl.dataloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.DGLGraph.html">dgl.DGLGraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.distributed.html">dgl.distributed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.function.html">dgl.function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.geometry.html">dgl.geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.graphbolt.html">🆕 dgl.graphbolt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/nn-pytorch.html">dgl.nn (PyTorch)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/nn.functional.html">dgl.nn.functional</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.ops.html">dgl.ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.optim.html">dgl.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.sampling.html">dgl.sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.sparse_v0.html">dgl.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.multiprocessing.html">dgl.multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/transforms.html">dgl.transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/udf.html">User-defined Functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contribute to DGL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/ffi.html">DGL Foreign Function Interface (FFI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance.html">Performance Benchmarks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../env_var.html">Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html">Resources</a></li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift"><nav aria-label="Mobile navigation menu" class="wy-nav-top">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../index.html">DGL</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="Page navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Home" class="icon icon-home" href="../index.html"></a></li>
<li class="breadcrumb-item"><a href="index.html">🆕 Stochastic Training of GNNs with GraphBolt</a></li>
<li class="breadcrumb-item"><a href="ondisk-dataset.html">Composing OnDiskDataset from raw data</a></li>
<li class="breadcrumb-item active">OnDiskDataset for Heterogeneous Graph</li>
<li class="wy-breadcrumbs-aside">
<a href="../_sources/stochastic_training/ondisk_dataset_heterograph.nblink.txt" rel="nofollow"> View page source</a>
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div itemprop="articleBody">
<section id="OnDiskDataset-for-Heterogeneous-Graph">
<h1>OnDiskDataset for Heterogeneous Graph<a class="headerlink" href="#OnDiskDataset-for-Heterogeneous-Graph" title="Link to this heading"></a></h1>
<p><a class="reference external" href="https://colab.research.google.com/github/dmlc/dgl/blob/master/notebooks/stochastic_training/ondisk_dataset_heterograph.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a> <a class="reference external" href="https://github.com/dmlc/dgl/blob/master/notebooks/stochastic_training/ondisk_dataset_heterograph.ipynb"><img alt="GitHub" src="https://img.shields.io/badge/-View%20on%20GitHub-181717?logo=github&amp;logoColor=ffffff"/></a></p>
<p>This tutorial shows how to create <code class="docutils literal notranslate"><span class="pre">OnDiskDataset</span></code> for heterogeneous graph that could be used in <strong>GraphBolt</strong> framework. The major difference from creating dataset for homogeneous graph is that we need to specify node/edge types for edges, feature data, training/validation/test sets.</p>
<p>By the end of this tutorial, you will be able to</p>
<ul class="simple">
<li><p>organize graph structure data.</p></li>
<li><p>organize feature data.</p></li>
<li><p>organize training/validation/test set for specific tasks.</p></li>
</ul>
<p>To create an <code class="docutils literal notranslate"><span class="pre">OnDiskDataset</span></code> object, you need to organize all the data including graph structure, feature data and tasks into a directory. The directory should contain a <code class="docutils literal notranslate"><span class="pre">metadata.yaml</span></code> file that describes the metadata of the dataset.</p>
<p>Now let’s generate various data step by step and organize them together to instantiate <code class="docutils literal notranslate"><span class="pre">OnDiskDataset</span></code> finally.</p>
<section id="Install-DGL-package">
<h2>Install DGL package<a class="headerlink" href="#Install-DGL-package" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install required packages.</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'TORCH'</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">__version__</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'DGLBACKEND'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"pytorch"</span>

<span class="c1"># Install the CPU version.</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cpu"</span><span class="p">)</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>--pre<span class="w"> </span>dgl<span class="w"> </span>-f<span class="w"> </span>https://data.dgl.ai/wheels-test/repo.html

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">dgl</span>
    <span class="kn">import</span> <span class="nn">dgl.graphbolt</span> <span class="k">as</span> <span class="nn">gb</span>
    <span class="n">installed</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="n">installed</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"DGL installed!"</span> <span class="k">if</span> <span class="n">installed</span> <span class="k">else</span> <span class="s2">"DGL not found!"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Looking in links: https://data.dgl.ai/wheels-test/repo.html
Requirement already satisfied: dgl in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (2.2a240410)
Requirement already satisfied: numpy&gt;=1.14.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (1.26.4)
Requirement already satisfied: scipy&gt;=1.1.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (1.14.0)
Requirement already satisfied: networkx&gt;=2.1 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (3.3)
Requirement already satisfied: requests&gt;=2.19.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (2.32.3)
Requirement already satisfied: tqdm in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (4.66.5)
Requirement already satisfied: psutil&gt;=5.8.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (6.0.0)
Requirement already satisfied: torchdata&gt;=0.5.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (0.7.1)
Requirement already satisfied: pandas in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (2.2.2)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from requests&gt;=2.19.0-&gt;dgl) (3.3.2)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from requests&gt;=2.19.0-&gt;dgl) (3.8)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from requests&gt;=2.19.0-&gt;dgl) (2.2.2)
Requirement already satisfied: certifi&gt;=2017.4.17 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from requests&gt;=2.19.0-&gt;dgl) (2024.7.4)
Requirement already satisfied: torch&gt;=2 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torchdata&gt;=0.5.0-&gt;dgl) (2.4.0+cpu)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from pandas-&gt;dgl) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from pandas-&gt;dgl) (2024.1)
Requirement already satisfied: tzdata&gt;=2022.7 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from pandas-&gt;dgl) (2024.1)
Requirement already satisfied: six&gt;=1.5 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas-&gt;dgl) (1.16.0)
Requirement already satisfied: filelock in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (3.15.4)
Requirement already satisfied: typing-extensions&gt;=4.8.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (4.12.2)
Requirement already satisfied: sympy in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (1.13.2)
Requirement already satisfied: jinja2 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (3.1.4)
Requirement already satisfied: fsspec in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (2024.6.1)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from jinja2-&gt;torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (2.1.5)
Requirement already satisfied: mpmath&lt;1.4,&gt;=1.1.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from sympy-&gt;torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (1.3.0)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/ubuntu/regression_test/dgl/python/dgl/graphbolt/base.py:82: FutureWarning: `torch.library.impl_abstract` was renamed to `torch.library.register_fake`. Please use that instead; we will remove `torch.library.impl_abstract` in a future version of PyTorch.
  @torch.library.impl_abstract("graphbolt::expand_indptr")
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DGL installed!
</pre></div></div>
</div>
</section>
<section id="Data-preparation">
<h2>Data preparation<a class="headerlink" href="#Data-preparation" title="Link to this heading"></a></h2>
<p>In order to demonstrate how to organize various data, let’s create a base directory first.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">'./ondisk_dataset_heterograph'</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Created base directory: </span><span class="si">{</span><span class="n">base_dir</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Created base directory: ./ondisk_dataset_heterograph
</pre></div></div>
</div>
<section id="Generate-graph-structure-data">
<h3>Generate graph structure data<a class="headerlink" href="#Generate-graph-structure-data" title="Link to this heading"></a></h3>
<p>For heterogeneous graph, we need to save different edge edges(namely seeds) into separate <strong>Numpy</strong> or <strong>CSV</strong> files.</p>
<p>Note: - when saving to <strong>Numpy</strong>, the array requires to be in shape of <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">N)</span></code>. This format is recommended as constructing graph from it is much faster than <strong>CSV</strong> file. - when saving to <strong>CSV</strong> file, do not save index and header.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># For simplicity, we create a heterogeneous graph with</span>
<span class="c1"># 2 node types: `user`, `item`</span>
<span class="c1"># 2 edge types: `user:like:item`, `user:follow:user`</span>
<span class="c1"># And each node/edge type has the same number of nodes/edges.</span>
<span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">num_edges</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">num_nodes</span>

<span class="c1"># Edge type: "user:like:item"</span>
<span class="n">like_edges_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"like-edges.csv"</span><span class="p">)</span>
<span class="n">like_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of [user:like:item] edges: </span><span class="si">{</span><span class="n">like_edges</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">like_edges</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">like_edges_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"[user:like:item] edges are saved into </span><span class="si">{</span><span class="n">like_edges_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Edge type: "user:follow:user"</span>
<span class="n">follow_edges_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"follow-edges.csv"</span><span class="p">)</span>
<span class="n">follow_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of [user:follow:user] edges: </span><span class="si">{</span><span class="n">follow_edges</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">follow_edges</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">follow_edges_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"[user:follow:user] edges are saved into </span><span class="si">{</span><span class="n">follow_edges_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Part of [user:like:item] edges: [[241 159]
 [217 629]
 [113 685]
 [687   7]
 [509 646]]

[user:like:item] edges are saved into ./ondisk_dataset_heterograph/like-edges.csv

Part of [user:follow:user] edges: [[443 343]
 [251 787]
 [124 148]
 [709 699]
 [792 780]]

[user:follow:user] edges are saved into ./ondisk_dataset_heterograph/follow-edges.csv

</pre></div></div>
</div>
</section>
<section id="Generate-feature-data-for-graph">
<h3>Generate feature data for graph<a class="headerlink" href="#Generate-feature-data-for-graph" title="Link to this heading"></a></h3>
<p>For feature data, numpy arrays and torch tensors are supported for now. Let’s generate feature data for each node/edge type.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate node[user] feature in numpy array.</span>
<span class="n">node_user_feat_0_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"node-user-feat-0.npy"</span><span class="p">)</span>
<span class="n">node_user_feat_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of node[user] feature [feat_0]: </span><span class="si">{</span><span class="n">node_user_feat_0</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">node_user_feat_0_path</span><span class="p">,</span> <span class="n">node_user_feat_0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Node[user] feature [feat_0] is saved to </span><span class="si">{</span><span class="n">node_user_feat_0_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate another node[user] feature in torch tensor</span>
<span class="n">node_user_feat_1_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"node-user-feat-1.pt"</span><span class="p">)</span>
<span class="n">node_user_feat_1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of node[user] feature [feat_1]: </span><span class="si">{</span><span class="n">node_user_feat_1</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">node_user_feat_1</span><span class="p">,</span> <span class="n">node_user_feat_1_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Node[user] feature [feat_1] is saved to </span><span class="si">{</span><span class="n">node_user_feat_1_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate node[item] feature in numpy array.</span>
<span class="n">node_item_feat_0_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"node-item-feat-0.npy"</span><span class="p">)</span>
<span class="n">node_item_feat_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of node[item] feature [feat_0]: </span><span class="si">{</span><span class="n">node_item_feat_0</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">node_item_feat_0_path</span><span class="p">,</span> <span class="n">node_item_feat_0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Node[item] feature [feat_0] is saved to </span><span class="si">{</span><span class="n">node_item_feat_0_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate another node[item] feature in torch tensor</span>
<span class="n">node_item_feat_1_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"node-item-feat-1.pt"</span><span class="p">)</span>
<span class="n">node_item_feat_1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of node[item] feature [feat_1]: </span><span class="si">{</span><span class="n">node_item_feat_1</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">node_item_feat_1</span><span class="p">,</span> <span class="n">node_item_feat_1_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Node[item] feature [feat_1] is saved to </span><span class="si">{</span><span class="n">node_item_feat_1_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate edge[user:like:item] feature in numpy array.</span>
<span class="n">edge_like_feat_0_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"edge-like-feat-0.npy"</span><span class="p">)</span>
<span class="n">edge_like_feat_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of edge[user:like:item] feature [feat_0]: </span><span class="si">{</span><span class="n">edge_like_feat_0</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">edge_like_feat_0_path</span><span class="p">,</span> <span class="n">edge_like_feat_0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Edge[user:like:item] feature [feat_0] is saved to </span><span class="si">{</span><span class="n">edge_like_feat_0_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate another edge[user:like:item] feature in torch tensor</span>
<span class="n">edge_like_feat_1_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"edge-like-feat-1.pt"</span><span class="p">)</span>
<span class="n">edge_like_feat_1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of edge[user:like:item] feature [feat_1]: </span><span class="si">{</span><span class="n">edge_like_feat_1</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">edge_like_feat_1</span><span class="p">,</span> <span class="n">edge_like_feat_1_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Edge[user:like:item] feature [feat_1] is saved to </span><span class="si">{</span><span class="n">edge_like_feat_1_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate edge[user:follow:user] feature in numpy array.</span>
<span class="n">edge_follow_feat_0_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"edge-follow-feat-0.npy"</span><span class="p">)</span>
<span class="n">edge_follow_feat_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of edge[user:follow:user] feature [feat_0]: </span><span class="si">{</span><span class="n">edge_follow_feat_0</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">edge_follow_feat_0_path</span><span class="p">,</span> <span class="n">edge_follow_feat_0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Edge[user:follow:user] feature [feat_0] is saved to </span><span class="si">{</span><span class="n">edge_follow_feat_0_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate another edge[user:follow:user] feature in torch tensor</span>
<span class="n">edge_follow_feat_1_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"edge-follow-feat-1.pt"</span><span class="p">)</span>
<span class="n">edge_follow_feat_1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of edge[user:follow:user] feature [feat_1]: </span><span class="si">{</span><span class="n">edge_follow_feat_1</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">edge_follow_feat_1</span><span class="p">,</span> <span class="n">edge_follow_feat_1_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Edge[user:follow:user] feature [feat_1] is saved to </span><span class="si">{</span><span class="n">edge_follow_feat_1_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Part of node[user] feature [feat_0]: [[0.91909239 0.37422575 0.24111333 0.65625656 0.43460833]
 [0.85091295 0.7364666  0.78730076 0.4201106  0.88450516]
 [0.53269627 0.73836834 0.59725217 0.16401152 0.93169657]]
Node[user] feature [feat_0] is saved to ./ondisk_dataset_heterograph/node-user-feat-0.npy

Part of node[user] feature [feat_1]: tensor([[0.2396, 0.4607, 0.9651, 0.8476, 0.5056],
        [0.8707, 0.0719, 0.8061, 0.7610, 0.5804],
        [0.0636, 0.7582, 0.4374, 0.6347, 0.1522]])
Node[user] feature [feat_1] is saved to ./ondisk_dataset_heterograph/node-user-feat-1.pt

Part of node[item] feature [feat_0]: [[0.03706925 0.12830968 0.67226972 0.40287831 0.25992825]
 [0.79343587 0.67117207 0.55368937 0.68488596 0.57538427]
 [0.16586521 0.90336655 0.08883312 0.06979995 0.6449173 ]]
Node[item] feature [feat_0] is saved to ./ondisk_dataset_heterograph/node-item-feat-0.npy

Part of node[item] feature [feat_1]: tensor([[0.0685, 0.2143, 0.1771, 0.8701, 0.3729],
        [0.2889, 0.4599, 0.2679, 0.6321, 0.3704],
        [0.9175, 0.6136, 0.8638, 0.0477, 0.2026]])
Node[item] feature [feat_1] is saved to ./ondisk_dataset_heterograph/node-item-feat-1.pt

Part of edge[user:like:item] feature [feat_0]: [[0.92110592 0.43370057 0.70776024 0.31744649 0.2662232 ]
 [0.04430544 0.89301372 0.08799708 0.97633579 0.35891548]
 [0.11586517 0.68721263 0.79711797 0.01156388 0.03250089]]
Edge[user:like:item] feature [feat_0] is saved to ./ondisk_dataset_heterograph/edge-like-feat-0.npy

Part of edge[user:like:item] feature [feat_1]: tensor([[0.8227, 0.3183, 0.6134, 0.8512, 0.7860],
        [0.6465, 0.8268, 0.8144, 0.7085, 0.5520],
        [0.5164, 0.2396, 0.5172, 0.5346, 0.4192]])
Edge[user:like:item] feature [feat_1] is saved to ./ondisk_dataset_heterograph/edge-like-feat-1.pt

Part of edge[user:follow:user] feature [feat_0]: [[0.78152867 0.54707617 0.99267295 0.15705371 0.86029412]
 [0.89054684 0.72780439 0.62328851 0.93982747 0.88064551]
 [0.4020774  0.00214531 0.17156668 0.94713765 0.77490135]]
Edge[user:follow:user] feature [feat_0] is saved to ./ondisk_dataset_heterograph/edge-follow-feat-0.npy

Part of edge[user:follow:user] feature [feat_1]: tensor([[0.2349, 0.3931, 0.1605, 0.6246, 0.5069],
        [0.6639, 0.4224, 0.1064, 0.5681, 0.1577],
        [0.6888, 0.6797, 0.2593, 0.4589, 0.4874]])
Edge[user:follow:user] feature [feat_1] is saved to ./ondisk_dataset_heterograph/edge-follow-feat-1.pt

</pre></div></div>
</div>
</section>
<section id="Generate-tasks">
<h3>Generate tasks<a class="headerlink" href="#Generate-tasks" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">OnDiskDataset</span></code> supports multiple tasks. For each task, we need to prepare training/validation/test sets respectively. Such sets usually vary among different tasks. In this tutorial, let’s create a <strong>Node Classification</strong> task and <strong>Link Prediction</strong> task.</p>
<section id="Node-Classification-Task">
<h4>Node Classification Task<a class="headerlink" href="#Node-Classification-Task" title="Link to this heading"></a></h4>
<p>For node classification task, we need <strong>node IDs</strong> and corresponding <strong>labels</strong> for each training/validation/test set. Like feature data, numpy arrays and torch tensors are supported for these sets.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For illustration, let's generate item sets for each node type.</span>
<span class="n">num_trains</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span> <span class="o">*</span> <span class="mf">0.6</span><span class="p">)</span>
<span class="n">num_vals</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">num_tests</span> <span class="o">=</span> <span class="n">num_nodes</span> <span class="o">-</span> <span class="n">num_trains</span> <span class="o">-</span> <span class="n">num_vals</span>

<span class="n">user_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">user_ids</span><span class="p">)</span>

<span class="n">item_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">item_ids</span><span class="p">)</span>

<span class="c1"># Train IDs for user.</span>
<span class="n">nc_train_user_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-train-user-ids.npy"</span><span class="p">)</span>
<span class="n">nc_train_user_ids</span> <span class="o">=</span> <span class="n">user_ids</span><span class="p">[:</span><span class="n">num_trains</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train ids[user] for node classification: </span><span class="si">{</span><span class="n">nc_train_user_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_train_user_ids_path</span><span class="p">,</span> <span class="n">nc_train_user_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC train ids[user] are saved to </span><span class="si">{</span><span class="n">nc_train_user_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Train labels for user.</span>
<span class="n">nc_train_user_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-train-user-labels.pt"</span><span class="p">)</span>
<span class="n">nc_train_user_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_trains</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train labels[user] for node classification: </span><span class="si">{</span><span class="n">nc_train_user_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_train_user_labels</span><span class="p">,</span> <span class="n">nc_train_user_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC train labels[user] are saved to </span><span class="si">{</span><span class="n">nc_train_user_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Train IDs for item.</span>
<span class="n">nc_train_item_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-train-item-ids.npy"</span><span class="p">)</span>
<span class="n">nc_train_item_ids</span> <span class="o">=</span> <span class="n">item_ids</span><span class="p">[:</span><span class="n">num_trains</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train ids[item] for node classification: </span><span class="si">{</span><span class="n">nc_train_item_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_train_item_ids_path</span><span class="p">,</span> <span class="n">nc_train_item_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC train ids[item] are saved to </span><span class="si">{</span><span class="n">nc_train_item_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Train labels for item.</span>
<span class="n">nc_train_item_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-train-item-labels.pt"</span><span class="p">)</span>
<span class="n">nc_train_item_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_trains</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train labels[item] for node classification: </span><span class="si">{</span><span class="n">nc_train_item_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_train_item_labels</span><span class="p">,</span> <span class="n">nc_train_item_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC train labels[item] are saved to </span><span class="si">{</span><span class="n">nc_train_item_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val IDs for user.</span>
<span class="n">nc_val_user_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-val-user-ids.npy"</span><span class="p">)</span>
<span class="n">nc_val_user_ids</span> <span class="o">=</span> <span class="n">user_ids</span><span class="p">[</span><span class="n">num_trains</span><span class="p">:</span><span class="n">num_trains</span><span class="o">+</span><span class="n">num_vals</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val ids[user] for node classification: </span><span class="si">{</span><span class="n">nc_val_user_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_val_user_ids_path</span><span class="p">,</span> <span class="n">nc_val_user_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC val ids[user] are saved to </span><span class="si">{</span><span class="n">nc_val_user_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val labels for user.</span>
<span class="n">nc_val_user_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-val-user-labels.pt"</span><span class="p">)</span>
<span class="n">nc_val_user_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_vals</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val labels[user] for node classification: </span><span class="si">{</span><span class="n">nc_val_user_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_val_user_labels</span><span class="p">,</span> <span class="n">nc_val_user_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC val labels[user] are saved to </span><span class="si">{</span><span class="n">nc_val_user_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val IDs for item.</span>
<span class="n">nc_val_item_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-val-item-ids.npy"</span><span class="p">)</span>
<span class="n">nc_val_item_ids</span> <span class="o">=</span> <span class="n">item_ids</span><span class="p">[</span><span class="n">num_trains</span><span class="p">:</span><span class="n">num_trains</span><span class="o">+</span><span class="n">num_vals</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val ids[item] for node classification: </span><span class="si">{</span><span class="n">nc_val_item_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_val_item_ids_path</span><span class="p">,</span> <span class="n">nc_val_item_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC val ids[item] are saved to </span><span class="si">{</span><span class="n">nc_val_item_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val labels for item.</span>
<span class="n">nc_val_item_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-val-item-labels.pt"</span><span class="p">)</span>
<span class="n">nc_val_item_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_vals</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val labels[item] for node classification: </span><span class="si">{</span><span class="n">nc_val_item_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_val_item_labels</span><span class="p">,</span> <span class="n">nc_val_item_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC val labels[item] are saved to </span><span class="si">{</span><span class="n">nc_val_item_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test IDs for user.</span>
<span class="n">nc_test_user_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-test-user-ids.npy"</span><span class="p">)</span>
<span class="n">nc_test_user_ids</span> <span class="o">=</span> <span class="n">user_ids</span><span class="p">[</span><span class="o">-</span><span class="n">num_tests</span><span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test ids[user] for node classification: </span><span class="si">{</span><span class="n">nc_test_user_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_test_user_ids_path</span><span class="p">,</span> <span class="n">nc_test_user_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC test ids[user] are saved to </span><span class="si">{</span><span class="n">nc_test_user_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test labels for user.</span>
<span class="n">nc_test_user_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-test-user-labels.pt"</span><span class="p">)</span>
<span class="n">nc_test_user_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_tests</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test labels[user] for node classification: </span><span class="si">{</span><span class="n">nc_test_user_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_test_user_labels</span><span class="p">,</span> <span class="n">nc_test_user_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC test labels[user] are saved to </span><span class="si">{</span><span class="n">nc_test_user_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test IDs for item.</span>
<span class="n">nc_test_item_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-test-item-ids.npy"</span><span class="p">)</span>
<span class="n">nc_test_item_ids</span> <span class="o">=</span> <span class="n">item_ids</span><span class="p">[</span><span class="o">-</span><span class="n">num_tests</span><span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test ids[item] for node classification: </span><span class="si">{</span><span class="n">nc_test_item_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_test_item_ids_path</span><span class="p">,</span> <span class="n">nc_test_item_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC test ids[item] are saved to </span><span class="si">{</span><span class="n">nc_test_item_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test labels for item.</span>
<span class="n">nc_test_item_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-test-item-labels.pt"</span><span class="p">)</span>
<span class="n">nc_test_item_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_tests</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test labels[item] for node classification: </span><span class="si">{</span><span class="n">nc_test_item_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_test_item_labels</span><span class="p">,</span> <span class="n">nc_test_item_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC test labels[item] are saved to </span><span class="si">{</span><span class="n">nc_test_item_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Part of train ids[user] for node classification: [ 41 982 456]
NC train ids[user] are saved to ./ondisk_dataset_heterograph/nc-train-user-ids.npy

Part of train labels[user] for node classification: tensor([6, 9, 3])
NC train labels[user] are saved to ./ondisk_dataset_heterograph/nc-train-user-labels.pt

Part of train ids[item] for node classification: [130 706 292]
NC train ids[item] are saved to ./ondisk_dataset_heterograph/nc-train-item-ids.npy

Part of train labels[item] for node classification: tensor([3, 9, 8])
NC train labels[item] are saved to ./ondisk_dataset_heterograph/nc-train-item-labels.pt

Part of val ids[user] for node classification: [300 752 617]
NC val ids[user] are saved to ./ondisk_dataset_heterograph/nc-val-user-ids.npy

Part of val labels[user] for node classification: tensor([5, 5, 5])
NC val labels[user] are saved to ./ondisk_dataset_heterograph/nc-val-user-labels.pt

Part of val ids[item] for node classification: [167 992 471]
NC val ids[item] are saved to ./ondisk_dataset_heterograph/nc-val-item-ids.npy

Part of val labels[item] for node classification: tensor([9, 0, 0])
NC val labels[item] are saved to ./ondisk_dataset_heterograph/nc-val-item-labels.pt

Part of test ids[user] for node classification: [833 715 735]
NC test ids[user] are saved to ./ondisk_dataset_heterograph/nc-test-user-ids.npy

Part of test labels[user] for node classification: tensor([5, 0, 9])
NC test labels[user] are saved to ./ondisk_dataset_heterograph/nc-test-user-labels.pt

Part of test ids[item] for node classification: [305 828 659]
NC test ids[item] are saved to ./ondisk_dataset_heterograph/nc-test-item-ids.npy

Part of test labels[item] for node classification: tensor([4, 0, 2])
NC test labels[item] are saved to ./ondisk_dataset_heterograph/nc-test-item-labels.pt

</pre></div></div>
</div>
</section>
<section id="Link-Prediction-Task">
<h4>Link Prediction Task<a class="headerlink" href="#Link-Prediction-Task" title="Link to this heading"></a></h4>
<p>For link prediction task, we need <strong>seeds</strong> or <strong>corresponding labels and indexes</strong> which representing the pos/neg property and group of the seeds for each training/validation/test set. Like feature data, numpy arrays and torch tensors are supported for these sets.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For illustration, let's generate item sets for each edge type.</span>
<span class="n">num_trains</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_edges</span> <span class="o">*</span> <span class="mf">0.6</span><span class="p">)</span>
<span class="n">num_vals</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_edges</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">num_tests</span> <span class="o">=</span> <span class="n">num_edges</span> <span class="o">-</span> <span class="n">num_trains</span> <span class="o">-</span> <span class="n">num_vals</span>

<span class="c1"># Train seeds for user:like:item.</span>
<span class="n">lp_train_like_seeds_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-train-like-seeds.npy"</span><span class="p">)</span>
<span class="n">lp_train_like_seeds</span> <span class="o">=</span> <span class="n">like_edges</span><span class="p">[:</span><span class="n">num_trains</span><span class="p">,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train seeds[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_train_like_seeds</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_train_like_seeds_path</span><span class="p">,</span> <span class="n">lp_train_like_seeds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP train seeds[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_train_like_seeds_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Train seeds for user:follow:user.</span>
<span class="n">lp_train_follow_seeds_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-train-follow-seeds.npy"</span><span class="p">)</span>
<span class="n">lp_train_follow_seeds</span> <span class="o">=</span> <span class="n">follow_edges</span><span class="p">[:</span><span class="n">num_trains</span><span class="p">,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train seeds[user:follow:user] for link prediction: </span><span class="si">{</span><span class="n">lp_train_follow_seeds</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_train_follow_seeds_path</span><span class="p">,</span> <span class="n">lp_train_follow_seeds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP train seeds[user:follow:user] are saved to </span><span class="si">{</span><span class="n">lp_train_follow_seeds_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val seeds for user:like:item.</span>
<span class="n">lp_val_like_seeds_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-val-like-seeds.npy"</span><span class="p">)</span>
<span class="n">lp_val_like_seeds</span> <span class="o">=</span> <span class="n">like_edges</span><span class="p">[</span><span class="n">num_trains</span><span class="p">:</span><span class="n">num_trains</span><span class="o">+</span><span class="n">num_vals</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">lp_val_like_neg_dsts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">num_vals</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lp_val_like_neg_srcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lp_val_like_seeds</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lp_val_like_neg_seeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lp_val_like_neg_srcs</span><span class="p">,</span> <span class="n">lp_val_like_neg_dsts</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">lp_val_like_seeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lp_val_like_seeds</span><span class="p">,</span> <span class="n">lp_val_like_neg_seeds</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val seeds[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_val_like_seeds</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_val_like_seeds_path</span><span class="p">,</span> <span class="n">lp_val_like_seeds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP val seeds[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_val_like_seeds_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val labels for user:like:item.</span>
<span class="n">lp_val_like_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-val-like-labels.npy"</span><span class="p">)</span>
<span class="n">lp_val_like_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_vals</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">lp_val_like_labels</span><span class="p">[:</span><span class="n">num_vals</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">lp_val_like_labels</span><span class="p">[</span><span class="n">num_vals</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val labels[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_val_like_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_val_like_labels_path</span><span class="p">,</span> <span class="n">lp_val_like_labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP val labels[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_val_like_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val indexes for user:like:item.</span>
<span class="n">lp_val_like_indexes_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-val-like-indexes.npy"</span><span class="p">)</span>
<span class="n">lp_val_like_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_vals</span><span class="p">)</span>
<span class="n">lp_val_like_neg_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lp_val_like_indexes</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lp_val_like_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">lp_val_like_indexes</span><span class="p">,</span> <span class="n">lp_val_like_neg_indexes</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val indexes[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_val_like_indexes</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_val_like_indexes_path</span><span class="p">,</span> <span class="n">lp_val_like_indexes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP val indexes[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_val_like_indexes_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val seeds for user:follow:item.</span>
<span class="n">lp_val_follow_seeds_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-val-follow-seeds.npy"</span><span class="p">)</span>
<span class="n">lp_val_follow_seeds</span> <span class="o">=</span> <span class="n">follow_edges</span><span class="p">[</span><span class="n">num_trains</span><span class="p">:</span><span class="n">num_trains</span><span class="o">+</span><span class="n">num_vals</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">lp_val_follow_neg_dsts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">num_vals</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lp_val_follow_neg_srcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lp_val_follow_seeds</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lp_val_follow_neg_seeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lp_val_follow_neg_srcs</span><span class="p">,</span> <span class="n">lp_val_follow_neg_dsts</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">lp_val_follow_seeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lp_val_follow_seeds</span><span class="p">,</span> <span class="n">lp_val_follow_neg_seeds</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val seeds[user:follow:item] for link prediction: </span><span class="si">{</span><span class="n">lp_val_follow_seeds</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_val_follow_seeds_path</span><span class="p">,</span> <span class="n">lp_val_follow_seeds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP val seeds[user:follow:item] are saved to </span><span class="si">{</span><span class="n">lp_val_follow_seeds_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val labels for user:follow:item.</span>
<span class="n">lp_val_follow_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-val-follow-labels.npy"</span><span class="p">)</span>
<span class="n">lp_val_follow_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_vals</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">lp_val_follow_labels</span><span class="p">[:</span><span class="n">num_vals</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">lp_val_follow_labels</span><span class="p">[</span><span class="n">num_vals</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val labels[user:follow:item] for link prediction: </span><span class="si">{</span><span class="n">lp_val_follow_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_val_follow_labels_path</span><span class="p">,</span> <span class="n">lp_val_follow_labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP val labels[user:follow:item] are saved to </span><span class="si">{</span><span class="n">lp_val_follow_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val indexes for user:follow:item.</span>
<span class="n">lp_val_follow_indexes_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-val-follow-indexes.npy"</span><span class="p">)</span>
<span class="n">lp_val_follow_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_vals</span><span class="p">)</span>
<span class="n">lp_val_follow_neg_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lp_val_follow_indexes</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lp_val_follow_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">lp_val_follow_indexes</span><span class="p">,</span> <span class="n">lp_val_follow_neg_indexes</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val indexes[user:follow:item] for link prediction: </span><span class="si">{</span><span class="n">lp_val_follow_indexes</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_val_follow_indexes_path</span><span class="p">,</span> <span class="n">lp_val_follow_indexes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP val indexes[user:follow:item] are saved to </span><span class="si">{</span><span class="n">lp_val_follow_indexes_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test seeds for user:like:item.</span>
<span class="n">lp_test_like_seeds_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-test-like-seeds.npy"</span><span class="p">)</span>
<span class="n">lp_test_like_seeds</span> <span class="o">=</span> <span class="n">like_edges</span><span class="p">[</span><span class="o">-</span><span class="n">num_tests</span><span class="p">:,</span> <span class="p">:]</span>
<span class="n">lp_test_like_neg_dsts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">num_tests</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lp_test_like_neg_srcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lp_test_like_seeds</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lp_test_like_neg_seeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lp_test_like_neg_srcs</span><span class="p">,</span> <span class="n">lp_test_like_neg_dsts</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">lp_test_like_seeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lp_test_like_seeds</span><span class="p">,</span> <span class="n">lp_test_like_neg_seeds</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test seeds[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_test_like_seeds</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_test_like_seeds_path</span><span class="p">,</span> <span class="n">lp_test_like_seeds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP test seeds[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_test_like_seeds_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test labels for user:like:item.</span>
<span class="n">lp_test_like_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-test-like-labels.npy"</span><span class="p">)</span>
<span class="n">lp_test_like_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_tests</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">lp_test_like_labels</span><span class="p">[:</span><span class="n">num_tests</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">lp_test_like_labels</span><span class="p">[</span><span class="n">num_tests</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test labels[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_test_like_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_test_like_labels_path</span><span class="p">,</span> <span class="n">lp_test_like_labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP test labels[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_test_like_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test indexes for user:like:item.</span>
<span class="n">lp_test_like_indexes_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-test-like-indexes.npy"</span><span class="p">)</span>
<span class="n">lp_test_like_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_tests</span><span class="p">)</span>
<span class="n">lp_test_like_neg_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lp_test_like_indexes</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lp_test_like_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">lp_test_like_indexes</span><span class="p">,</span> <span class="n">lp_test_like_neg_indexes</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test indexes[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_test_like_indexes</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_test_like_indexes_path</span><span class="p">,</span> <span class="n">lp_test_like_indexes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP test indexes[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_test_like_indexes_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test seeds for user:follow:item.</span>
<span class="n">lp_test_follow_seeds_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-test-follow-seeds.npy"</span><span class="p">)</span>
<span class="n">lp_test_follow_seeds</span> <span class="o">=</span> <span class="n">follow_edges</span><span class="p">[</span><span class="o">-</span><span class="n">num_tests</span><span class="p">:,</span> <span class="p">:]</span>
<span class="n">lp_test_follow_neg_dsts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">num_tests</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">lp_test_follow_neg_srcs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lp_test_follow_seeds</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lp_test_follow_neg_seeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lp_test_follow_neg_srcs</span><span class="p">,</span> <span class="n">lp_test_follow_neg_dsts</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">lp_test_follow_seeds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">lp_test_follow_seeds</span><span class="p">,</span> <span class="n">lp_test_follow_neg_seeds</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test seeds[user:follow:item] for link prediction: </span><span class="si">{</span><span class="n">lp_test_follow_seeds</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_test_follow_seeds_path</span><span class="p">,</span> <span class="n">lp_test_follow_seeds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP test seeds[user:follow:item] are saved to </span><span class="si">{</span><span class="n">lp_test_follow_seeds_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test labels for user:follow:item.</span>
<span class="n">lp_test_follow_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-test-follow-labels.npy"</span><span class="p">)</span>
<span class="n">lp_test_follow_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_tests</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">lp_test_follow_labels</span><span class="p">[:</span><span class="n">num_tests</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">lp_test_follow_labels</span><span class="p">[</span><span class="n">num_tests</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test labels[user:follow:item] for link prediction: </span><span class="si">{</span><span class="n">lp_test_follow_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_test_follow_labels_path</span><span class="p">,</span> <span class="n">lp_test_follow_labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP test labels[user:follow:item] are saved to </span><span class="si">{</span><span class="n">lp_test_follow_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test indexes for user:follow:item.</span>
<span class="n">lp_test_follow_indexes_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-test-follow-indexes.npy"</span><span class="p">)</span>
<span class="n">lp_test_follow_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_tests</span><span class="p">)</span>
<span class="n">lp_test_follow_neg_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">lp_test_follow_indexes</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">lp_test_follow_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">lp_test_follow_indexes</span><span class="p">,</span> <span class="n">lp_test_follow_neg_indexes</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test indexes[user:follow:item] for link prediction: </span><span class="si">{</span><span class="n">lp_test_follow_indexes</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_test_follow_indexes_path</span><span class="p">,</span> <span class="n">lp_test_follow_indexes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP test indexes[user:follow:item] are saved to </span><span class="si">{</span><span class="n">lp_test_follow_indexes_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Part of train seeds[user:like:item] for link prediction: [[241 159]
 [217 629]
 [113 685]]
LP train seeds[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-train-like-seeds.npy

Part of train seeds[user:follow:user] for link prediction: [[443 343]
 [251 787]
 [124 148]]
LP train seeds[user:follow:user] are saved to ./ondisk_dataset_heterograph/lp-train-follow-seeds.npy

Part of val seeds[user:like:item] for link prediction: [[870 297]
 [ 50 517]
 [648 809]]
LP val seeds[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-val-like-seeds.npy

Part of val labels[user:like:item] for link prediction: [1. 1. 1.]
LP val labels[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-val-like-labels.npy

Part of val indexes[user:like:item] for link prediction: [0 1 2]
LP val indexes[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-val-like-indexes.npy

Part of val seeds[user:follow:item] for link prediction: [[437 813]
 [ 29 262]
 [323 374]]
LP val seeds[user:follow:item] are saved to ./ondisk_dataset_heterograph/lp-val-follow-seeds.npy

Part of val labels[user:follow:item] for link prediction: [1. 1. 1.]
LP val labels[user:follow:item] are saved to ./ondisk_dataset_heterograph/lp-val-follow-labels.npy

Part of val indexes[user:follow:item] for link prediction: [0 1 2]
LP val indexes[user:follow:item] are saved to ./ondisk_dataset_heterograph/lp-val-follow-indexes.npy

Part of test seeds[user:like:item] for link prediction: [[779 773]
 [412 284]
 [697 629]]
LP test seeds[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-test-like-seeds.npy

Part of test labels[user:like:item] for link prediction: [1. 1. 1.]
LP test labels[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-test-like-labels.npy

Part of test indexes[user:like:item] for link prediction: [0 1 2]
LP test indexes[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-test-like-indexes.npy

Part of test seeds[user:follow:item] for link prediction: [[506 227]
 [ 20 856]
 [639 790]]
LP test seeds[user:follow:item] are saved to ./ondisk_dataset_heterograph/lp-test-follow-seeds.npy

Part of test labels[user:follow:item] for link prediction: [1. 1. 1.]
LP test labels[user:follow:item] are saved to ./ondisk_dataset_heterograph/lp-test-follow-labels.npy

Part of test indexes[user:follow:item] for link prediction: [0 1 2]
LP test indexes[user:follow:item] are saved to ./ondisk_dataset_heterograph/lp-test-follow-indexes.npy

</pre></div></div>
</div>
</section>
</section>
</section>
<section id="Organize-Data-into-YAML-File">
<h2>Organize Data into YAML File<a class="headerlink" href="#Organize-Data-into-YAML-File" title="Link to this heading"></a></h2>
<p>Now we need to create a <code class="docutils literal notranslate"><span class="pre">metadata.yaml</span></code> file which contains the paths, dadta types of graph structure, feature data, training/validation/test sets. Please note that all path should be relative to <code class="docutils literal notranslate"><span class="pre">metadata.yaml</span></code>.</p>
<p>For heterogeneous graph, we need to specify the node/edge type in <strong>type</strong> fields. For edge type, canonical etype is required which is a string that’s concatenated by source node type, etype, and destination node type together with <code class="docutils literal notranslate"><span class="pre">:</span></code>.</p>
<p>Notes: - all path should be relative to <code class="docutils literal notranslate"><span class="pre">metadata.yaml</span></code>. - Below fields are optional and not specified in below example. - <code class="docutils literal notranslate"><span class="pre">in_memory</span></code>: indicates whether to load dada into memory or <code class="docutils literal notranslate"><span class="pre">mmap</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>Please refer to <a class="reference external" href="https://github.com/dmlc/dgl/blob/master/docs/source/stochastic_training/ondisk-dataset-specification.rst">YAML specification</a> for more details.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yaml_content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">    dataset_name: heterogeneous_graph_nc_lp</span>
<span class="s2">    graph:</span>
<span class="s2">      nodes:</span>
<span class="s2">        - type: user</span>
<span class="s2">          num: </span><span class="si">{</span><span class="n">num_nodes</span><span class="si">}</span>
<span class="s2">        - type: item</span>
<span class="s2">          num: </span><span class="si">{</span><span class="n">num_nodes</span><span class="si">}</span>
<span class="s2">      edges:</span>
<span class="s2">        - type: "user:like:item"</span>
<span class="s2">          format: csv</span>
<span class="s2">          path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">like_edges_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        - type: "user:follow:user"</span>
<span class="s2">          format: csv</span>
<span class="s2">          path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">follow_edges_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">    feature_data:</span>
<span class="s2">      - domain: node</span>
<span class="s2">        type: user</span>
<span class="s2">        name: feat_0</span>
<span class="s2">        format: numpy</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">node_user_feat_0_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: node</span>
<span class="s2">        type: user</span>
<span class="s2">        name: feat_1</span>
<span class="s2">        format: torch</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">node_user_feat_1_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: node</span>
<span class="s2">        type: item</span>
<span class="s2">        name: feat_0</span>
<span class="s2">        format: numpy</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">node_item_feat_0_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: node</span>
<span class="s2">        type: item</span>
<span class="s2">        name: feat_1</span>
<span class="s2">        format: torch</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">node_item_feat_1_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: edge</span>
<span class="s2">        type: "user:like:item"</span>
<span class="s2">        name: feat_0</span>
<span class="s2">        format: numpy</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">edge_like_feat_0_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: edge</span>
<span class="s2">        type: "user:like:item"</span>
<span class="s2">        name: feat_1</span>
<span class="s2">        format: torch</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">edge_like_feat_1_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: edge</span>
<span class="s2">        type: "user:follow:user"</span>
<span class="s2">        name: feat_0</span>
<span class="s2">        format: numpy</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">edge_follow_feat_0_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: edge</span>
<span class="s2">        type: "user:follow:user"</span>
<span class="s2">        name: feat_1</span>
<span class="s2">        format: torch</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">edge_follow_feat_1_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">    tasks:</span>
<span class="s2">      - name: node_classification</span>
<span class="s2">        num_classes: 10</span>
<span class="s2">        train_set:</span>
<span class="s2">          - type: user</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_train_user_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_train_user_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: item</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_train_item_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_train_item_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        validation_set:</span>
<span class="s2">          - type: user</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_val_user_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_val_user_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: item</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_val_item_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_val_item_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        test_set:</span>
<span class="s2">          - type: user</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_test_user_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_test_user_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: item</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_test_item_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_test_item_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - name: link_prediction</span>
<span class="s2">        num_classes: 10</span>
<span class="s2">        train_set:</span>
<span class="s2">          - type: "user:like:item"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_train_like_seeds_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: "user:follow:user"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_train_follow_seeds_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        validation_set:</span>
<span class="s2">          - type: "user:like:item"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_val_like_seeds_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_val_like_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: indexes</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_val_like_indexes_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: "user:follow:user"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_val_follow_seeds_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_val_follow_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: indexes</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_val_follow_indexes_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        test_set:</span>
<span class="s2">          - type: "user:like:item"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_test_like_seeds_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_test_like_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: indexes</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_test_like_indexes_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: "user:follow:user"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seeds</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_test_follow_seeds_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_test_follow_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: indexes</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_test_follow_indexes_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">"""</span>
<span class="n">metadata_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"metadata.yaml"</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">metadata_path</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">yaml_content</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Instantiate-OnDiskDataset">
<h2>Instantiate <code class="docutils literal notranslate"><span class="pre">OnDiskDataset</span></code><a class="headerlink" href="#Instantiate-OnDiskDataset" title="Link to this heading"></a></h2>
<p>Now we’re ready to load dataset via <code class="docutils literal notranslate"><span class="pre">dgl.graphbolt.OnDiskDataset</span></code>. When instantiating, we just pass in the base directory where <code class="docutils literal notranslate"><span class="pre">metadata.yaml</span></code> file lies.</p>
<p>During first instantiation, GraphBolt preprocesses the raw data such as constructing <code class="docutils literal notranslate"><span class="pre">FusedCSCSamplingGraph</span></code> from edges. All data including graph, feature data, training/validation/test sets are put into <code class="docutils literal notranslate"><span class="pre">preprocessed</span></code> directory after preprocessing. Any following dataset loading will skip the preprocess stage.</p>
<p>After preprocessing, <code class="docutils literal notranslate"><span class="pre">load()</span></code> is required to be called explicitly in order to load graph, feature data and tasks.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">OnDiskDataset</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">graph</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Loaded graph: </span><span class="si">{</span><span class="n">graph</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">feature</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">feature</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Loaded feature store: </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">tasks</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">tasks</span>
<span class="n">nc_task</span> <span class="o">=</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Loaded node classification task: </span><span class="si">{</span><span class="n">nc_task</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">lp_task</span> <span class="o">=</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Loaded link prediction task: </span><span class="si">{</span><span class="n">lp_task</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The on-disk dataset is re-preprocessing, so the existing preprocessed dataset has been removed.
Start to preprocess the on-disk dataset.
Finish preprocessing the on-disk dataset.
Loaded graph: FusedCSCSamplingGraph(csc_indptr=tensor([    0,     7,    16,  ..., 19988, 19994, 20000], dtype=torch.int32),
                      indices=tensor([1932, 1933, 1504,  ..., 1099, 1432, 1575], dtype=torch.int32),
                      total_num_nodes=2000, num_edges={'user:follow:user': 10000, 'user:like:item': 10000},
                      node_type_offset=tensor([   0, 1000, 2000], dtype=torch.int32),
                      type_per_edge=tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.uint8),
                      node_type_to_id={'item': 0, 'user': 1},
                      edge_type_to_id={'user:follow:user': 0, 'user:like:item': 1},)

Loaded feature store: TorchBasedFeatureStore(
    {(&lt;OnDiskFeatureDataDomain.NODE: 'node'&gt;, 'user', 'feat_0'): TorchBasedFeature(
        feature=tensor([[0.9191, 0.3742, 0.2411, 0.6563, 0.4346],
                        [0.8509, 0.7365, 0.7873, 0.4201, 0.8845],
                        [0.5327, 0.7384, 0.5973, 0.1640, 0.9317],
                        ...,
                        [0.2968, 0.2086, 0.9191, 0.5005, 0.4087],
                        [0.9223, 0.9018, 0.7804, 0.5152, 0.1274],
                        [0.3639, 0.6840, 0.0952, 0.3124, 0.9424]], dtype=torch.float64),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.NODE: 'node'&gt;, 'user', 'feat_1'): TorchBasedFeature(
        feature=tensor([[0.2396, 0.4607, 0.9651, 0.8476, 0.5056],
                        [0.8707, 0.0719, 0.8061, 0.7610, 0.5804],
                        [0.0636, 0.7582, 0.4374, 0.6347, 0.1522],
                        ...,
                        [0.9351, 0.8342, 0.0681, 0.6111, 0.1046],
                        [0.4227, 0.2977, 0.3890, 0.1396, 0.2484],
                        [0.8741, 0.4255, 0.7906, 0.4518, 0.5726]]),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.NODE: 'node'&gt;, 'item', 'feat_0'): TorchBasedFeature(
        feature=tensor([[0.0371, 0.1283, 0.6723, 0.4029, 0.2599],
                        [0.7934, 0.6712, 0.5537, 0.6849, 0.5754],
                        [0.1659, 0.9034, 0.0888, 0.0698, 0.6449],
                        ...,
                        [0.1102, 0.1174, 0.3809, 0.1964, 0.4777],
                        [0.2186, 0.9714, 0.5847, 0.0738, 0.4279],
                        [0.1989, 0.0192, 0.8020, 0.4423, 0.4942]], dtype=torch.float64),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.NODE: 'node'&gt;, 'item', 'feat_1'): TorchBasedFeature(
        feature=tensor([[0.0685, 0.2143, 0.1771, 0.8701, 0.3729],
                        [0.2889, 0.4599, 0.2679, 0.6321, 0.3704],
                        [0.9175, 0.6136, 0.8638, 0.0477, 0.2026],
                        ...,
                        [0.3191, 0.8966, 0.3911, 0.8786, 0.6312],
                        [0.2503, 0.5278, 0.4957, 0.3342, 0.8897],
                        [0.8755, 0.5226, 0.2861, 0.9699, 0.6031]]),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.EDGE: 'edge'&gt;, 'user:like:item', 'feat_0'): TorchBasedFeature(
        feature=tensor([[0.9211, 0.4337, 0.7078, 0.3174, 0.2662],
                        [0.0443, 0.8930, 0.0880, 0.9763, 0.3589],
                        [0.1159, 0.6872, 0.7971, 0.0116, 0.0325],
                        ...,
                        [0.5748, 0.2431, 0.2826, 0.8290, 0.8989],
                        [0.1568, 0.6228, 0.1614, 0.7073, 0.7771],
                        [0.3583, 0.2884, 0.4313, 0.0688, 0.9399]], dtype=torch.float64),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.EDGE: 'edge'&gt;, 'user:like:item', 'feat_1'): TorchBasedFeature(
        feature=tensor([[0.8227, 0.3183, 0.6134, 0.8512, 0.7860],
                        [0.6465, 0.8268, 0.8144, 0.7085, 0.5520],
                        [0.5164, 0.2396, 0.5172, 0.5346, 0.4192],
                        ...,
                        [0.8737, 0.9037, 0.5758, 0.8065, 0.6110],
                        [0.5286, 0.0642, 0.0628, 0.4162, 0.9801],
                        [0.7016, 0.6338, 0.2081, 0.0605, 0.4974]]),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.EDGE: 'edge'&gt;, 'user:follow:user', 'feat_0'): TorchBasedFeature(
        feature=tensor([[0.7815, 0.5471, 0.9927, 0.1571, 0.8603],
                        [0.8905, 0.7278, 0.6233, 0.9398, 0.8806],
                        [0.4021, 0.0021, 0.1716, 0.9471, 0.7749],
                        ...,
                        [0.3895, 0.7401, 0.4932, 0.1873, 0.9263],
                        [0.5900, 0.7552, 0.9181, 0.0523, 0.1204],
                        [0.9944, 0.2964, 0.4392, 0.3245, 0.1685]], dtype=torch.float64),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.EDGE: 'edge'&gt;, 'user:follow:user', 'feat_1'): TorchBasedFeature(
        feature=tensor([[0.2349, 0.3931, 0.1605, 0.6246, 0.5069],
                        [0.6639, 0.4224, 0.1064, 0.5681, 0.1577],
                        [0.6888, 0.6797, 0.2593, 0.4589, 0.4874],
                        ...,
                        [0.7949, 0.0279, 0.7063, 0.5192, 0.6345],
                        [0.5952, 0.8222, 0.7005, 0.8904, 0.8403],
                        [0.9038, 0.0113, 0.6233, 0.6084, 0.8654]]),
        metadata={},
    )}
)

Loaded node classification task: OnDiskTask(validation_set=HeteroItemSet(
               itemsets={'user': ItemSet(
                            items=(tensor([300, 752, 617, 488, 576, 865, 832, 680, 367, 673, 703, 477, 812, 422,
                                168, 628, 555, 814, 954, 569, 809, 169, 714, 911, 452, 962, 147, 293,
                                208, 852, 328, 313, 597, 843, 266, 324, 836, 467, 639, 209,   3, 113,
                                376, 421, 100, 392,  45, 258, 810, 586, 485, 913, 326, 847,  13, 228,
                                338, 949, 116, 975, 533, 677, 700, 570, 378, 398, 571, 802, 171, 869,
                                937, 663, 385, 268, 859, 237, 301,  14, 494, 561, 136, 615, 984, 804,
                                965, 323, 196, 198, 741, 710, 372, 356, 461, 824, 739, 478, 654, 516,
                                352, 242, 250, 497,  27,  25, 705, 922, 364, 120, 587, 107, 527, 108,
                                415, 857,  42, 530, 572, 216, 631,  90, 713, 189, 381, 731, 921, 685,
                                472, 186, 239, 223, 728, 227, 195, 575, 854, 154, 217, 460, 442, 876,
                                523, 923, 945, 709, 558, 151, 470, 417, 317, 896, 114, 179, 306, 765,
                                143,  62, 947, 450, 165, 365, 664, 390, 247, 251, 548, 142, 167, 102,
                                827,  87, 895, 194, 204, 742, 738, 907, 244, 692, 598, 614, 389, 414,
                                448, 736, 622, 861, 655, 453, 563, 410, 359, 466, 541, 718, 261, 796,
                                 40, 646,  68, 329], dtype=torch.int32), tensor([5, 5, 5, 1, 6, 0, 2, 8, 1, 4, 6, 5, 7, 3, 2, 0, 2, 0, 1, 8, 4, 0, 4, 4,
                                3, 7, 1, 0, 7, 8, 3, 3, 1, 6, 4, 6, 1, 7, 1, 9, 4, 4, 9, 0, 6, 1, 2, 2,
                                7, 1, 3, 4, 9, 5, 3, 0, 1, 8, 2, 9, 7, 0, 6, 8, 0, 5, 2, 8, 5, 9, 2, 8,
                                7, 5, 8, 5, 8, 8, 8, 6, 3, 6, 6, 7, 5, 5, 1, 5, 2, 9, 8, 6, 2, 4, 9, 7,
                                1, 3, 5, 0, 4, 3, 5, 0, 6, 9, 0, 7, 2, 0, 0, 8, 0, 9, 2, 4, 4, 1, 9, 5,
                                9, 9, 0, 2, 6, 0, 5, 2, 3, 1, 3, 8, 0, 2, 7, 7, 8, 3, 6, 2, 7, 5, 1, 1,
                                1, 0, 7, 1, 6, 8, 7, 2, 5, 9, 6, 8, 9, 6, 5, 1, 8, 1, 1, 3, 3, 4, 4, 5,
                                4, 8, 1, 9, 2, 7, 7, 6, 4, 8, 3, 4, 5, 7, 2, 9, 9, 3, 0, 9, 2, 6, 5, 8,
                                6, 8, 8, 2, 1, 4, 8, 2])),
                            names=('seeds', 'labels'),
                        ), 'item': ItemSet(
                            items=(tensor([167, 992, 471, 239, 183, 372, 697, 112, 210, 715, 127, 453, 490, 935,
                                268, 904, 544, 998, 501, 323, 744, 439, 149, 783, 442, 778, 679, 541,
                                503, 581, 911, 752, 967, 146, 594, 428, 725, 573, 944, 457, 172, 811,
                                592,  43, 691, 578, 647, 454, 105, 570, 517, 585, 548, 128, 291, 497,
                                512, 702, 341, 402, 912, 115, 102, 460, 927, 747, 171, 890, 109, 714,
                                801, 107, 881, 838, 479,  67, 949, 293, 888,  39, 600, 869, 124, 808,
                                720, 231, 285, 765,  18, 863,  33, 753, 484, 164,  82, 645, 313, 129,
                                 48, 330, 137,  14, 300, 354, 650, 610, 823, 289, 244, 240, 284, 347,
                                180, 229, 458, 332, 221, 343,  63,  97, 206, 459, 925, 580, 631, 257,
                                762,  98, 175, 519, 985, 919, 794,  34, 885, 826, 138, 274, 158, 290,
                                114, 590, 627, 357, 514, 683,  62, 259, 621, 651,  60, 849, 807, 310,
                                233, 482,  25,  66, 557, 219, 678, 391, 537, 936, 734, 774, 644, 382,
                                494, 995, 153, 419, 641, 329, 214, 786, 515,  36, 803, 959, 661, 539,
                                465, 994, 842,  49, 875, 335, 779, 628, 312, 672, 595, 847, 123, 212,
                                509, 334, 365, 793], dtype=torch.int32), tensor([9, 0, 0, 5, 0, 1, 0, 7, 5, 8, 6, 1, 9, 4, 6, 8, 6, 9, 4, 9, 0, 4, 7, 0,
                                5, 0, 7, 3, 7, 2, 3, 5, 7, 4, 9, 4, 6, 7, 6, 5, 6, 9, 1, 0, 1, 5, 9, 0,
                                8, 3, 9, 9, 8, 1, 8, 2, 3, 9, 6, 9, 0, 2, 7, 6, 5, 0, 1, 4, 6, 9, 8, 3,
                                7, 4, 4, 0, 9, 7, 1, 9, 0, 2, 2, 0, 5, 9, 9, 1, 9, 8, 0, 9, 5, 3, 8, 7,
                                6, 8, 0, 2, 9, 2, 1, 8, 7, 0, 7, 5, 2, 6, 0, 2, 3, 4, 9, 0, 7, 1, 0, 2,
                                9, 3, 9, 6, 4, 8, 5, 4, 8, 6, 3, 8, 0, 0, 1, 3, 4, 1, 2, 2, 5, 2, 7, 0,
                                4, 8, 8, 9, 1, 4, 3, 0, 9, 8, 4, 7, 0, 1, 5, 9, 9, 7, 8, 0, 9, 0, 6, 6,
                                2, 9, 2, 3, 9, 6, 2, 2, 0, 4, 8, 9, 6, 9, 0, 4, 8, 9, 6, 3, 0, 0, 5, 2,
                                4, 1, 3, 8, 3, 2, 1, 2])),
                            names=('seeds', 'labels'),
                        )},
               names=('seeds', 'labels'),
           ),
           train_set=HeteroItemSet(
               itemsets={'user': ItemSet(
                            items=(tensor([ 41, 982, 456, 751, 123, 153, 270, 900, 394, 834, 334, 350, 222, 706,
                                332, 600,  10, 278, 889, 924, 373, 901, 740, 420, 620, 369, 465, 956,
                                 48, 297, 276, 708, 909, 882,  39, 267, 806, 146, 547, 269, 659, 948,
                                805, 634, 951, 112, 387, 969, 211,   0,  73, 212, 745, 320, 853, 464,
                                160, 253, 174,  19, 264, 275, 988, 840, 348, 986, 140, 101, 322, 177,
                                125, 507, 936, 649, 565, 776, 856, 781, 296, 903, 977, 430, 657, 679,
                                 67, 604, 551,  31, 274, 514, 623, 819, 148,  16, 199, 807, 409, 311,
                                 26, 290, 454,  46, 989, 349, 213, 513, 767, 688, 730, 229, 343, 451,
                                966, 214, 206, 331, 753, 588, 768, 314, 748,  52, 241, 990, 777, 110,
                                985, 868, 283, 459, 793, 737, 915, 981, 340, 156, 681, 774, 341, 898,
                                358, 510,  77, 130, 287, 779, 411, 682, 722, 818, 218,  22, 109, 608,
                                384, 918, 891, 636, 669, 458,  29, 837, 720, 183, 668, 505, 362,  98,
                                157, 482, 607, 521, 205, 860, 419, 596, 118, 522, 471,  36, 961, 979,
                                790, 149,  57, 121, 498, 866, 412, 704, 347, 333, 405, 445, 640, 436,
                                656,  64, 260, 940, 917, 761, 230, 115, 134, 880, 321, 429, 295, 473,
                                784, 671,  69, 534, 175, 998, 785, 744, 746, 795, 850, 912, 440, 132,
                                660, 489, 416, 780,  93, 674, 580, 938, 543, 697, 678, 271, 763, 906,
                                683, 721,  75, 803, 126, 308, 520, 983, 603, 500, 200,  80, 963, 277,
                                754, 884,  72,  94,   1, 762, 550, 248, 933, 971, 263, 504, 490,  86,
                                733, 874, 207, 893, 426, 701, 254, 890, 573, 492, 539,  89, 176, 536,
                                252, 219, 885, 635, 159, 826, 932, 808, 665,  53, 619, 163, 499,  43,
                                325, 687, 554,  79, 593, 491, 729,  85, 407, 443, 127,  24, 304, 610,
                                549, 590, 846, 435, 528,  17, 131, 899, 509,   2, 632, 487, 716, 750,
                                150, 602, 346, 904, 841, 193, 315,  74, 401, 980, 829, 925, 992, 370,
                                517, 170, 883, 493, 540, 958, 298, 312, 878, 327, 574, 647, 910, 584,
                                 38,   7,   8, 553, 529, 284, 221, 815, 184, 725, 162, 240, 886, 712,
                                432, 403, 831, 483, 870,  23, 820, 592, 197, 111, 374, 141, 557, 375,
                                 58, 955, 919, 766, 960, 637, 931, 875, 755, 658, 379, 887, 339, 769,
                                272,  50, 759, 993, 556, 926,  51, 439, 307, 355, 747, 943, 299, 696,
                                203, 760, 503, 238,  56, 666, 319, 959, 512, 894, 172, 279, 360, 567,
                                273, 757,  37, 289, 946, 724, 627,  33, 455, 770,  92, 552, 967, 787,
                                129, 342, 117, 601, 732, 970, 366,  18, 404,  28,  66,   5,  65,  96,
                                589, 303,  95, 644, 288, 562, 994, 371, 408, 215, 838, 684, 249, 816,
                                 15, 693, 772, 380, 105, 336, 511, 851, 202, 280, 801, 531, 871, 166,
                                361, 616, 400, 476, 302, 789, 799, 723, 397, 158, 694, 920, 337, 463,
                                 88,  55,  20,  21, 133, 934, 357, 103, 395, 495, 413, 433,  47,  12,
                                310, 393, 842, 106,  63, 481,  76, 858, 662,  91, 941,   9, 245,  61,
                                973, 782, 224, 621, 817, 318, 368, 122, 104, 828, 256, 651, 173, 155,
                                518, 908, 839, 192, 231, 377, 916, 670, 468, 749, 950, 855, 953, 425,
                                848, 612, 641, 246, 138, 233,  49, 265, 978, 599, 577, 792, 566, 794,
                                188, 363, 535, 281, 353, 873, 863, 226,  78, 707, 877, 449, 653, 559,
                                698, 388, 282, 391, 813, 444, 987, 914, 382, 997, 633, 581, 285, 437,
                                383, 291, 262, 902, 756, 611,  60, 544, 243, 691, 479, 234],
                               dtype=torch.int32), tensor([6, 9, 3, 7, 1, 6, 6, 3, 3, 7, 8, 8, 8, 1, 1, 4, 9, 1, 1, 7, 2, 0, 7, 8,
                                5, 3, 8, 1, 5, 7, 8, 6, 7, 4, 4, 7, 1, 6, 8, 5, 8, 5, 6, 7, 9, 2, 5, 6,
                                4, 4, 1, 4, 0, 7, 4, 8, 8, 5, 9, 9, 9, 4, 2, 4, 8, 8, 9, 0, 5, 0, 7, 7,
                                5, 2, 5, 6, 4, 7, 9, 2, 5, 7, 7, 2, 6, 5, 7, 0, 5, 6, 5, 0, 9, 8, 1, 4,
                                6, 2, 3, 2, 2, 9, 3, 7, 0, 7, 4, 4, 4, 4, 6, 9, 1, 3, 1, 8, 9, 8, 0, 0,
                                7, 6, 8, 1, 6, 8, 9, 9, 4, 0, 9, 4, 3, 1, 6, 8, 0, 8, 4, 1, 6, 0, 2, 9,
                                2, 8, 3, 9, 6, 7, 5, 1, 1, 5, 7, 1, 0, 0, 4, 6, 0, 7, 7, 5, 3, 4, 3, 8,
                                8, 6, 5, 8, 5, 3, 5, 0, 4, 5, 9, 4, 0, 5, 4, 5, 7, 0, 2, 6, 0, 2, 2, 0,
                                1, 3, 3, 3, 2, 9, 0, 5, 0, 6, 2, 5, 1, 9, 7, 4, 7, 0, 0, 9, 3, 1, 9, 8,
                                4, 3, 4, 4, 0, 8, 4, 7, 7, 9, 3, 7, 5, 3, 4, 8, 3, 9, 7, 8, 5, 6, 3, 5,
                                7, 5, 8, 2, 0, 0, 7, 2, 4, 8, 2, 3, 9, 3, 3, 4, 4, 1, 5, 6, 9, 2, 2, 4,
                                6, 5, 8, 6, 7, 0, 7, 6, 8, 1, 8, 3, 8, 0, 6, 2, 4, 3, 1, 6, 5, 2, 4, 1,
                                6, 3, 4, 5, 9, 9, 2, 8, 6, 6, 1, 9, 3, 3, 2, 6, 7, 7, 5, 1, 4, 3, 7, 3,
                                9, 4, 7, 9, 2, 0, 7, 7, 2, 2, 1, 7, 8, 6, 6, 7, 4, 4, 0, 0, 0, 4, 1, 5,
                                5, 0, 4, 2, 0, 2, 0, 5, 8, 5, 6, 5, 0, 2, 8, 9, 4, 6, 2, 4, 9, 1, 0, 6,
                                5, 1, 9, 2, 7, 0, 8, 4, 9, 8, 6, 1, 2, 8, 5, 5, 5, 2, 1, 4, 8, 8, 3, 1,
                                9, 2, 6, 3, 7, 6, 6, 5, 3, 3, 8, 4, 5, 9, 0, 4, 2, 9, 9, 4, 0, 1, 6, 2,
                                7, 1, 5, 1, 3, 9, 9, 3, 1, 4, 7, 6, 4, 1, 1, 8, 0, 7, 7, 6, 4, 9, 4, 5,
                                7, 7, 9, 7, 8, 7, 2, 6, 8, 0, 7, 7, 5, 4, 2, 7, 5, 5, 4, 7, 5, 3, 8, 1,
                                1, 7, 0, 5, 8, 3, 1, 6, 3, 9, 2, 7, 4, 0, 9, 6, 3, 8, 9, 2, 3, 0, 0, 8,
                                0, 6, 3, 8, 9, 9, 1, 9, 6, 9, 1, 9, 9, 5, 5, 4, 0, 1, 7, 4, 5, 3, 3, 6,
                                6, 2, 3, 8, 0, 4, 9, 9, 3, 6, 3, 7, 2, 4, 7, 1, 0, 0, 4, 3, 1, 1, 0, 8,
                                3, 1, 0, 4, 0, 4, 7, 0, 8, 1, 1, 5, 9, 6, 2, 3, 2, 6, 1, 3, 5, 3, 0, 8,
                                8, 1, 5, 4, 7, 3, 7, 2, 5, 7, 3, 6, 9, 3, 7, 7, 0, 5, 8, 8, 8, 8, 2, 4,
                                5, 5, 0, 1, 5, 2, 4, 6, 3, 1, 9, 5, 3, 2, 1, 8, 9, 8, 8, 4, 4, 2, 1, 1])),
                            names=('seeds', 'labels'),
                        ), 'item': ItemSet(
                            items=(tensor([130, 706, 292, 812, 776, 279, 777, 188, 400, 534, 559, 523, 914, 131,
                                 83, 116, 664,  80,  53,  38,  55, 817, 815, 575, 220, 882, 696, 758,
                                667,  92, 736,  81, 687, 493, 248, 976, 962, 946, 207, 921, 957, 900,
                                254, 818, 217, 850, 485, 437, 424, 202, 111, 854, 845, 980, 975, 157,
                                411, 317, 150, 302, 344, 190, 719, 262,  95, 525, 612, 263,  90, 708,
                                359, 272, 969, 918, 321, 475, 205, 867, 941, 238, 204, 110, 834, 926,
                                425, 820, 607, 466, 520, 193, 390, 971, 298, 306, 948, 117, 707, 418,
                                782,  61, 806, 487,   0, 413,  16, 481, 361, 639, 920, 956, 440, 589,
                                336, 551, 837, 968, 798, 144, 135, 894, 416, 417, 938, 531,  24, 892,
                                898, 718, 723, 772, 404, 315, 887, 738, 256, 622, 670,  58,  20, 909,
                                435, 775, 629, 423, 500, 993,   8, 922, 730, 230, 351, 950, 704, 101,
                                222, 430, 379, 410, 327, 242, 113, 726, 939, 965, 857, 159,  50, 450,
                                636, 757, 616, 716,  84, 671, 852, 981, 319, 151, 797, 930, 185, 141,
                                 91, 810, 384, 251, 477,  22, 668, 902, 883, 201, 572, 154, 576, 441,
                                126, 258, 751, 492, 638, 870, 602, 746, 358,  89, 558, 588, 680, 448,
                                614, 199, 703, 795, 474, 527, 362, 369, 278, 209,  64, 281,  88, 181,
                                574, 445, 756, 792, 658, 727, 275, 843, 162, 271, 249, 408, 377, 692,
                                879, 177, 345, 809, 987, 415, 603, 990, 504, 773, 951,  10, 933, 569,
                                583, 866, 729, 681, 252, 584,  85, 540, 972, 224, 299, 689, 829, 538,
                                947, 816, 147, 878, 265, 577, 819, 349, 963, 660, 677,  73, 307, 635,
                                886, 282, 191,  42, 508, 176, 547, 984, 168, 884, 924, 380, 802, 724,
                                120, 455, 754,  13,  52, 383, 745,  54, 634, 739, 165, 609, 189, 864,
                                122, 656, 787, 940, 555, 997, 247, 624, 717, 721, 604, 955, 136, 401,
                                663, 899, 447, 326,  93, 550, 409, 488, 106, 591, 771, 931, 407, 226,
                                958, 533, 932, 467, 701, 646, 246, 236, 856, 155,  74, 516, 599,  87,
                                499, 561, 873, 179, 929, 166, 700, 832, 187, 388, 545, 741,  86, 328,
                                502, 673, 560, 370, 952, 868, 643, 270, 422, 813, 472, 682, 781, 218,
                                405, 536, 840, 436, 844, 253, 243, 296, 322, 862, 665, 669,  32, 318,
                                653, 579, 350, 132, 320, 953, 625, 763, 468,  47,   6,  37, 637, 530,
                                 96, 784, 979, 276, 597, 554, 903, 769, 303,  19, 412, 785, 421, 211,
                                261, 427, 827, 568, 615, 865, 143, 283,  70, 426, 264, 567,  69, 287,
                                331, 649, 693, 133, 198, 596, 999, 170, 324, 988, 632, 858, 506, 434,
                                675, 780, 889, 989, 308,  79, 280, 698, 470,  77,  40,  21, 393, 740,
                                121, 674,  27, 288, 709,   3, 396, 685, 103, 996, 917, 974, 805, 825,
                                760, 543, 830, 339, 241, 203, 905, 432, 790,  51, 901, 916, 571, 897,
                                983, 507, 606, 713, 705, 788, 451, 891, 513, 564, 851, 511, 937,  75,
                                174, 161,  12, 598, 748,  23, 986, 686, 655, 140, 742, 498, 314, 833,
                                431, 684, 356, 237, 735, 524, 761, 565, 389, 235, 360, 982, 145, 208,
                                478, 553, 521, 100, 491, 814, 608, 896, 804,  68, 960, 526, 245, 767,
                                587, 385, 297,  46, 694, 142,  94, 542, 449, 473, 961, 642, 277, 872,
                                 28, 766, 626, 443, 732, 846, 469, 835, 934, 824, 907, 848, 532, 215,
                                429, 348, 522,  72, 316, 346, 768, 923, 267, 688, 266, 228, 463, 152,
                                  7, 654, 910, 750, 853, 223, 444, 943, 964,  35, 104,  45],
                               dtype=torch.int32), tensor([3, 9, 8, 9, 6, 4, 3, 2, 9, 9, 3, 3, 8, 5, 0, 9, 4, 8, 9, 2, 2, 1, 5, 3,
                                6, 8, 3, 8, 7, 8, 1, 1, 7, 8, 0, 6, 8, 7, 3, 6, 6, 4, 7, 1, 4, 9, 0, 0,
                                9, 5, 9, 6, 0, 2, 3, 6, 1, 3, 2, 8, 1, 1, 9, 3, 8, 8, 2, 3, 6, 8, 3, 8,
                                8, 1, 4, 3, 4, 2, 1, 0, 9, 6, 7, 8, 4, 6, 1, 6, 3, 0, 4, 8, 7, 4, 5, 6,
                                1, 0, 0, 4, 4, 7, 5, 7, 4, 7, 9, 3, 5, 3, 8, 6, 9, 4, 8, 5, 4, 1, 3, 1,
                                3, 0, 7, 2, 1, 1, 8, 7, 4, 7, 5, 3, 1, 0, 0, 6, 5, 2, 9, 8, 7, 1, 6, 7,
                                0, 4, 5, 8, 1, 5, 8, 4, 3, 2, 7, 7, 0, 3, 2, 4, 7, 9, 0, 8, 2, 2, 8, 2,
                                1, 5, 6, 7, 5, 7, 8, 1, 6, 9, 5, 2, 9, 7, 2, 6, 2, 9, 6, 6, 2, 9, 0, 3,
                                2, 1, 3, 7, 1, 1, 8, 3, 5, 1, 7, 5, 0, 1, 0, 3, 1, 5, 6, 8, 0, 4, 9, 0,
                                1, 7, 3, 2, 4, 8, 4, 0, 2, 8, 8, 4, 6, 1, 9, 1, 0, 0, 3, 8, 5, 1, 4, 6,
                                7, 1, 2, 3, 9, 1, 9, 0, 6, 5, 1, 9, 6, 9, 7, 9, 9, 5, 6, 6, 2, 3, 9, 6,
                                3, 1, 4, 0, 5, 1, 8, 2, 9, 0, 3, 4, 7, 6, 6, 2, 5, 9, 1, 3, 9, 2, 1, 3,
                                4, 5, 8, 6, 9, 5, 5, 3, 0, 7, 0, 2, 4, 4, 4, 0, 2, 1, 5, 1, 4, 3, 9, 9,
                                6, 2, 6, 9, 8, 8, 3, 7, 9, 0, 5, 2, 6, 9, 7, 4, 2, 0, 5, 5, 0, 5, 8, 6,
                                2, 1, 5, 0, 2, 4, 5, 2, 2, 4, 5, 7, 5, 5, 5, 6, 2, 5, 9, 2, 1, 7, 4, 3,
                                5, 3, 1, 6, 9, 0, 4, 2, 0, 7, 2, 8, 4, 6, 0, 8, 2, 5, 6, 2, 0, 0, 7, 9,
                                6, 7, 6, 4, 9, 1, 1, 7, 8, 6, 3, 9, 0, 6, 4, 9, 3, 2, 4, 5, 1, 2, 7, 0,
                                0, 0, 2, 9, 2, 1, 7, 6, 5, 1, 7, 8, 5, 0, 8, 3, 5, 9, 7, 7, 0, 1, 9, 6,
                                5, 3, 4, 0, 6, 0, 1, 7, 4, 3, 5, 4, 1, 1, 0, 8, 1, 9, 3, 6, 2, 7, 1, 7,
                                9, 6, 5, 1, 3, 1, 5, 5, 8, 6, 3, 5, 1, 8, 2, 7, 8, 9, 8, 4, 0, 4, 8, 2,
                                2, 1, 9, 1, 2, 2, 7, 0, 5, 2, 8, 0, 9, 0, 8, 7, 9, 9, 8, 4, 9, 7, 7, 2,
                                3, 3, 1, 7, 3, 7, 1, 8, 3, 5, 4, 9, 9, 6, 3, 3, 0, 6, 8, 0, 1, 7, 1, 0,
                                2, 1, 8, 1, 9, 3, 9, 9, 1, 1, 8, 4, 4, 2, 2, 3, 2, 7, 3, 9, 7, 6, 6, 0,
                                8, 4, 8, 9, 6, 2, 9, 8, 8, 8, 6, 4, 8, 3, 6, 7, 0, 8, 5, 2, 6, 4, 5, 5,
                                9, 4, 0, 0, 1, 5, 1, 8, 0, 8, 4, 2, 9, 5, 8, 6, 8, 1, 5, 2, 1, 6, 9, 8])),
                            names=('seeds', 'labels'),
                        )},
               names=('seeds', 'labels'),
           ),
           test_set=HeteroItemSet(
               itemsets={'user': ItemSet(
                            items=(tensor([833, 715, 735, 690, 119, 727, 508,   6, 823, 344, 438, 446, 532, 661,
                                583, 689,  83, 447, 591, 791, 457, 545, 719, 525, 645, 294, 606, 778,
                                881,  44, 564, 811, 135, 775, 259, 145, 929, 305, 210, 161, 892, 220,
                                434, 330, 995, 972, 905, 232, 822, 484, 629, 187,  30, 625, 354, 424,
                                927, 537, 624, 764, 999, 225, 830, 872, 406, 783, 844, 594, 201, 568,
                                579, 399, 786, 630, 650, 402, 286,  70, 935, 292, 181, 386, 618,  35,
                                519,  59, 582, 501, 800, 825, 605, 190, 864, 152, 758, 335, 726, 180,
                                502, 124, 964, 676, 939, 441, 717, 609, 351, 930, 496, 560, 711, 867,
                                879, 506, 428, 743, 849, 595, 542, 944, 976, 835, 897,   4, 702, 345,
                                613, 515, 957, 667, 773,  11, 862,  81, 257, 128, 431, 991, 675, 178,
                                524, 648, 526, 474, 486, 652, 699, 686, 996, 968, 139, 952, 845, 480,
                                538, 164, 672,  82,  71, 974, 642, 191, 144, 821, 797,  97, 427, 546,
                                788, 423, 236, 585, 638, 942, 418,  99, 462, 396, 771, 928, 626, 182,
                                255,  34, 643, 137,  32, 469,  54, 578, 888, 734, 798, 185, 475, 309,
                                 84, 316, 235, 695], dtype=torch.int32), tensor([5, 0, 9, 7, 0, 1, 1, 0, 9, 7, 0, 6, 3, 1, 9, 3, 4, 9, 4, 7, 6, 3, 8, 7,
                                3, 1, 9, 8, 4, 2, 1, 4, 1, 1, 7, 9, 5, 8, 9, 2, 0, 0, 7, 9, 0, 2, 5, 5,
                                8, 3, 3, 1, 5, 9, 8, 2, 7, 8, 5, 4, 4, 9, 8, 9, 7, 6, 7, 8, 6, 0, 3, 0,
                                1, 5, 1, 5, 6, 3, 7, 6, 4, 4, 6, 6, 9, 3, 4, 4, 7, 0, 7, 8, 5, 7, 8, 0,
                                0, 5, 2, 0, 1, 7, 5, 2, 1, 3, 1, 1, 3, 0, 8, 7, 6, 3, 8, 1, 6, 2, 0, 4,
                                8, 3, 6, 7, 0, 0, 2, 9, 2, 3, 7, 0, 7, 8, 2, 3, 8, 8, 1, 1, 6, 7, 8, 9,
                                0, 2, 5, 1, 6, 6, 6, 3, 3, 2, 6, 3, 8, 6, 3, 1, 9, 1, 3, 9, 1, 6, 6, 5,
                                9, 6, 7, 5, 7, 5, 7, 1, 9, 3, 1, 0, 3, 9, 5, 8, 9, 1, 7, 1, 6, 4, 9, 3,
                                0, 4, 6, 1, 8, 0, 2, 5])),
                            names=('seeds', 'labels'),
                        ), 'item': ItemSet(
                            items=(tensor([305, 828, 659, 690,   2,   1, 378, 227, 480, 648, 368, 338, 294, 186,
                                620, 623, 861, 399, 366, 295, 876, 605, 386, 633, 552, 908, 970, 489,
                                340, 652, 601,  57, 800, 731, 535, 333, 182, 311, 749,  26, 355, 250,
                                173, 710, 184, 483, 913, 353, 234, 301, 118, 737, 373, 977, 895, 225,
                                755, 978, 831, 461, 728, 546, 196, 619,  31, 699, 381, 337, 397, 954,
                                874, 269, 232, 722, 139, 364, 178, 420, 156, 973, 906, 496, 260, 446,
                                593,  65, 549, 942, 495, 529, 789, 398, 367,  11, 387, 991, 169,  76,
                                505,  17, 871,  56, 134, 733, 476,  30, 966, 304, 945, 841, 309, 630,
                                822, 613, 859,   4, 528, 195, 839, 796, 376, 640, 860, 392, 618, 582,
                                119, 611, 518, 462, 657, 363, 352, 836, 163, 452, 770, 662,  29, 566,
                                743,   9, 371, 791, 893, 563, 711, 486, 759, 510, 695, 438, 764, 556,
                                799, 374, 325, 562, 617, 395, 375, 342, 666, 877,  78, 433, 880, 414,
                                108, 915, 197,   5, 464, 194, 125, 712,  15, 255, 456, 855,  71, 200,
                                 99,  44, 403, 406, 192, 676,  59, 273, 213, 928, 821, 216, 148, 586,
                                 41, 286, 160, 394], dtype=torch.int32), tensor([4, 0, 2, 8, 9, 9, 4, 8, 5, 8, 1, 9, 7, 7, 6, 9, 2, 5, 3, 0, 7, 4, 0, 7,
                                9, 3, 1, 4, 3, 6, 1, 4, 0, 0, 5, 0, 2, 0, 9, 8, 9, 1, 6, 8, 9, 2, 6, 3,
                                4, 6, 1, 0, 4, 1, 9, 0, 1, 3, 1, 8, 5, 3, 9, 9, 9, 8, 4, 6, 9, 2, 4, 4,
                                5, 5, 0, 7, 8, 9, 2, 3, 8, 9, 7, 4, 3, 5, 1, 8, 7, 3, 5, 5, 0, 5, 3, 0,
                                8, 3, 9, 0, 8, 4, 3, 2, 2, 6, 5, 1, 1, 8, 4, 2, 4, 5, 3, 0, 8, 3, 0, 9,
                                0, 8, 2, 6, 7, 7, 1, 9, 1, 5, 6, 4, 9, 1, 4, 1, 1, 4, 5, 2, 5, 2, 6, 2,
                                0, 6, 5, 0, 2, 4, 0, 9, 2, 1, 9, 7, 7, 9, 6, 2, 2, 3, 0, 3, 8, 7, 8, 1,
                                1, 7, 0, 4, 2, 7, 1, 2, 3, 2, 1, 4, 1, 3, 4, 6, 6, 3, 4, 6, 0, 7, 2, 7,
                                3, 2, 2, 8, 4, 3, 2, 8])),
                            names=('seeds', 'labels'),
                        )},
               names=('seeds', 'labels'),
           ),
           metadata={'name': 'node_classification', 'num_classes': 10},)

Loaded link prediction task: OnDiskTask(validation_set=HeteroItemSet(
               itemsets={'user:like:item': ItemSet(
                            items=(tensor([[870, 297],
                                [ 50, 517],
                                [648, 809],
                                ...,
                                [961, 895],
                                [961,  59],
                                [961, 411]], dtype=torch.int32), tensor([1., 1., 1.,  ..., 0., 0., 0.], dtype=torch.float64), tensor([   0,    1,    2,  ..., 1999, 1999, 1999])),
                            names=('seeds', 'labels', 'indexes'),
                        ), 'user:follow:user': ItemSet(
                            items=(tensor([[437, 813],
                                [ 29, 262],
                                [323, 374],
                                ...,
                                [189, 407],
                                [189, 896],
                                [189, 452]], dtype=torch.int32), tensor([1., 1., 1.,  ..., 0., 0., 0.], dtype=torch.float64), tensor([   0,    1,    2,  ..., 1999, 1999, 1999])),
                            names=('seeds', 'labels', 'indexes'),
                        )},
               names=('seeds', 'labels', 'indexes'),
           ),
           train_set=HeteroItemSet(
               itemsets={'user:like:item': ItemSet(
                            items=(tensor([[241, 159],
                                [217, 629],
                                [113, 685],
                                ...,
                                [329, 220],
                                [724, 250],
                                [626, 788]], dtype=torch.int32),),
                            names=('seeds',),
                        ), 'user:follow:user': ItemSet(
                            items=(tensor([[443, 343],
                                [251, 787],
                                [124, 148],
                                ...,
                                [423, 439],
                                [996, 102],
                                [982,  97]], dtype=torch.int32),),
                            names=('seeds',),
                        )},
               names=('seeds',),
           ),
           test_set=HeteroItemSet(
               itemsets={'user:like:item': ItemSet(
                            items=(tensor([[779, 773],
                                [412, 284],
                                [697, 629],
                                ...,
                                [819, 933],
                                [819, 991],
                                [819,  91]], dtype=torch.int32), tensor([1., 1., 1.,  ..., 0., 0., 0.], dtype=torch.float64), tensor([   0,    1,    2,  ..., 1999, 1999, 1999])),
                            names=('seeds', 'labels', 'indexes'),
                        ), 'user:follow:user': ItemSet(
                            items=(tensor([[506, 227],
                                [ 20, 856],
                                [639, 790],
                                ...,
                                [654, 586],
                                [654, 728],
                                [654,  15]], dtype=torch.int32), tensor([1., 1., 1.,  ..., 0., 0., 0.], dtype=torch.float64), tensor([   0,    1,    2,  ..., 1999, 1999, 1999])),
                            names=('seeds', 'labels', 'indexes'),
                        )},
               names=('seeds', 'labels', 'indexes'),
           ),
           metadata={'name': 'link_prediction', 'num_classes': 10},)

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/ubuntu/regression_test/dgl/python/dgl/graphbolt/internal/utils.py:16: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(path)
/home/ubuntu/regression_test/dgl/python/dgl/graphbolt/impl/ondisk_dataset.py:460: DGLWarning: Edge feature is stored, but edge IDs are not saved.
  dgl_warning("Edge feature is stored, but edge IDs are not saved.")
/home/ubuntu/regression_test/dgl/python/dgl/graphbolt/impl/ondisk_dataset.py:852: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(graph_topology.path)
</pre></div></div>
</div>
</section>
</section>
</div>
</div>
<footer><div aria-label="Footer" class="rst-footer-buttons" role="navigation">
<a accesskey="p" class="btn btn-neutral float-left" href="ondisk_dataset_homograph.html" rel="prev" title="OnDiskDataset for Homogeneous Graph"><span aria-hidden="true" class="fa fa-arrow-circle-left"></span> Previous</a>
<a accesskey="n" class="btn btn-neutral float-right" href="ondisk-dataset-specification.html" rel="next" title="YAML specification">Next <span aria-hidden="true" class="fa fa-arrow-circle-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<p>© Copyright 2018, DGL Team.</p>
</div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" data-toggle="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span class="fa fa-book"> Read the Docs</span>
<span id="version-placeholder">v: latest</span>
<span class="fa fa-caret-down"></span>
</span>
<div class="rst-other-versions">
<dl>
<dt>Versions</dt>
<div id="version-list">
<!-- 动态插入的版本列表将出现在这里 -->
</div>
</dl>
<dl>
<dt>Downloads</dt>
<!-- 下载内容 -->
</dl>
<dl>
<dt>On Read the Docs</dt>
<dd><a href="//doc-build.dgl.ai/projects/dgl/?fromdocs=dgl">Project Home</a></dd>
<dd><a href="//doc-build.dgl.ai/builds/dgl/?fromdocs=dgl">Builds</a></dd>
</dl>
</div>
</div>
<script>
        document.addEventListener("DOMContentLoaded", function() {
            fetch('/dgl_docs/branches.json')
                .then(response => response.json())
                .then(data => {
                    var versionListDiv = document.getElementById('version-list');
                    data.branches.forEach(function(branch) {
                        var dd = document.createElement('dd');
                        var a = document.createElement('a');
                        a.href = branch.url;
                        a.textContent = branch.name;
                        dd.appendChild(a);
                        versionListDiv.appendChild(dd);
                    });
                })
                .catch(error => console.error('Error loading branches:', error));
        });
        document.addEventListener("DOMContentLoaded", function() {
            // 获取当前路径
            var path = window.location.pathname;
            var versionPlaceholder = document.getElementById('version-placeholder');

            // 检查路径中是否包含 'en'
            if (path.includes('/en/')) {
                // 提取 'en' 后的文件夹作为版本号
                var parts = path.split('/en/');
                if (parts[1]) {
                    var folders = parts[1].split('/');
                    if (folders.length > 0 && folders[0]) {
                        versionPlaceholder.textContent = 'v: ' + folders[0];
                    } else {
                        versionPlaceholder.textContent = 'v: latest';
                    }
                } else {
                    versionPlaceholder.textContent = 'v: latest';
                }
            } else {
                versionPlaceholder.textContent = 'v: latest';
            }
        });
    </script>

<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
</body>
</html>