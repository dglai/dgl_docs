<!DOCTYPE html>

<html class="writer-html5" data-content_root="../" lang="en">
<head>
<meta charset="utf-8"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>OnDiskDataset for Heterogeneous Graph â€” DGL 2.1.0 documentation</title>
<link href="../_static/pygments.css?v=80d5e7a1" rel="stylesheet" type="text/css"/>
<link href="../_static/css/theme.css?v=19f00094" rel="stylesheet" type="text/css"/>
<link href="../_static/graphviz.css?v=fd3f3429" rel="stylesheet" type="text/css"/>
<link href="../_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery.css?v=d2d258e8" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery-binder.css?v=f4aeca0c" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery-dataframe.css?v=2082cf3c" rel="stylesheet" type="text/css"/>
<link href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" rel="stylesheet" type="text/css"/>
<link href="../_static/nbsphinx-code-cells.css?v=2aa19091" rel="stylesheet" type="text/css"/>
<link href="../_static/css/custom.css?v=0bf289b5" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
<script src="../_static/jquery.js?v=5d32c60e"></script>
<script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
<script src="../_static/documentation_options.js?v=20623aea"></script>
<script src="../_static/doctools.js?v=9a2dae69"></script>
<script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="../_static/clipboard.min.js?v=a7894cd8"></script>
<script src="../_static/copybutton.js?v=ccdb6887"></script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
<script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="../_static/js/theme.js"></script>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="ondisk-dataset-specification.html" rel="next" title="YAML specification"/>
<link href="ondisk_dataset_homograph.html" rel="prev" title="OnDiskDataset for Homogeneous Graph"/>
</head>
<body class="wy-body-for-nav">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../index.html">
            DGL
          </a>
<div class="version">
                2.1.0
              </div>
<div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
</div><div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Install and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/blitz/index.html">A Blitz Introduction to DGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Materials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ğŸ†• Stochastic Training of GNNs with GraphBolt</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="neighbor_sampling_overview.html">Neighbor Sampling Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="node_classification.html">Node Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="link_prediction.html">Link Prediction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="ondisk-dataset.html">Composing OnDiskDataset from raw data</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ondisk_dataset_homograph.html">OnDiskDataset for Homogeneous Graph</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">OnDiskDataset for Heterogeneous Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="ondisk-dataset-specification.html">YAML specification</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide_cn/index.html">ç”¨æˆ·æŒ‡å—ã€åŒ…å«è¿‡æ—¶ä¿¡æ¯ã€‘</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide_ko/index.html">ì‚¬ìš©ì ê°€ì´ë“œ[ì‹œëŒ€ì— ë’¤ì³ì§„]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graphtransformer/index.html">ğŸ†• Tutorial: Graph Transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/sparse/index.html">Tutorials: dgl.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/cpu/index.html">Training on CPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/multi/index.html">Training on Multiple GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/dist/index.html">Distributed training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/index.html">Paper Study with DGL</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.html">dgl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.data.html">dgl.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.dataloading.html">dgl.dataloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.DGLGraph.html">dgl.DGLGraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.distributed.html">dgl.distributed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.function.html">dgl.function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.geometry.html">dgl.geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.graphbolt.html">ğŸ†• dgl.graphbolt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/nn-pytorch.html">dgl.nn (PyTorch)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/nn.functional.html">dgl.nn.functional</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.ops.html">dgl.ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.optim.html">dgl.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.sampling.html">dgl.sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.sparse_v0.html">dgl.sparse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/dgl.multiprocessing.html">dgl.multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/transforms.html">dgl.transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/udf.html">User-defined Functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contribute to DGL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/ffi.html">DGL Foreign Function Interface (FFI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance.html">Performance Benchmarks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../env_var.html">Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html">Resources</a></li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift"><nav aria-label="Mobile navigation menu" class="wy-nav-top">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../index.html">DGL</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="Page navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Home" class="icon icon-home" href="../index.html"></a></li>
<li class="breadcrumb-item"><a href="index.html">ğŸ†• Stochastic Training of GNNs with GraphBolt</a></li>
<li class="breadcrumb-item"><a href="ondisk-dataset.html">Composing OnDiskDataset from raw data</a></li>
<li class="breadcrumb-item active">OnDiskDataset for Heterogeneous Graph</li>
<li class="wy-breadcrumbs-aside">
<a href="../_sources/stochastic_training/ondisk_dataset_heterograph.nblink.txt" rel="nofollow"> View page source</a>
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div itemprop="articleBody">
<section id="OnDiskDataset-for-Heterogeneous-Graph">
<h1>OnDiskDataset for Heterogeneous Graph<a class="headerlink" href="#OnDiskDataset-for-Heterogeneous-Graph" title="Link to this heading">ïƒ</a></h1>
<p><a class="reference external" href="https://colab.research.google.com/github/dmlc/dgl/blob/master/notebooks/stochastic_training/ondisk_dataset_heterograph.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a> <a class="reference external" href="https://github.com/dmlc/dgl/blob/master/notebooks/stochastic_training/ondisk_dataset_heterograph.ipynb"><img alt="GitHub" src="https://img.shields.io/badge/-View%20on%20GitHub-181717?logo=github&amp;logoColor=ffffff"/></a></p>
<p>This tutorial shows how to create <code class="docutils literal notranslate"><span class="pre">OnDiskDataset</span></code> for heterogeneous graph that could be used in <strong>GraphBolt</strong> framework. The major difference from creating dataset for homogeneous graph is that we need to specify node/edge types for edges, feature data, training/validation/test sets.</p>
<p>By the end of this tutorial, you will be able to</p>
<ul class="simple">
<li><p>organize graph structure data.</p></li>
<li><p>organize feature data.</p></li>
<li><p>organize training/validation/test set for specific tasks.</p></li>
</ul>
<p>To create an <code class="docutils literal notranslate"><span class="pre">OnDiskDataset</span></code> object, you need to organize all the data including graph structure, feature data and tasks into a directory. The directory should contain a <code class="docutils literal notranslate"><span class="pre">metadata.yaml</span></code> file that describes the metadata of the dataset.</p>
<p>Now letâ€™s generate various data step by step and organize them together to instantiate <code class="docutils literal notranslate"><span class="pre">OnDiskDataset</span></code> finally.</p>
<section id="Install-DGL-package">
<h2>Install DGL package<a class="headerlink" href="#Install-DGL-package" title="Link to this heading">ïƒ</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install required packages.</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'TORCH'</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">__version__</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'DGLBACKEND'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"pytorch"</span>

<span class="c1"># Install the CPU version.</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">"cpu"</span><span class="p">)</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>--pre<span class="w"> </span>dgl<span class="w"> </span>-f<span class="w"> </span>https://data.dgl.ai/wheels-test/repo.html

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">dgl</span>
    <span class="kn">import</span> <span class="nn">dgl.graphbolt</span> <span class="k">as</span> <span class="nn">gb</span>
    <span class="n">installed</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
    <span class="n">installed</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"DGL installed!"</span> <span class="k">if</span> <span class="n">installed</span> <span class="k">else</span> <span class="s2">"DGL not found!"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Looking in links: https://data.dgl.ai/wheels-test/repo.html
Requirement already satisfied: dgl in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (2.2a240410)
Requirement already satisfied: numpy&gt;=1.14.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (1.26.4)
Requirement already satisfied: scipy&gt;=1.1.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (1.14.0)
Requirement already satisfied: networkx&gt;=2.1 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (3.3)
Requirement already satisfied: requests&gt;=2.19.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (2.32.3)
Requirement already satisfied: tqdm in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (4.66.5)
Requirement already satisfied: psutil&gt;=5.8.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (6.0.0)
Requirement already satisfied: torchdata&gt;=0.5.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (0.7.1)
Requirement already satisfied: pandas in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from dgl) (2.2.2)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from requests&gt;=2.19.0-&gt;dgl) (3.3.2)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from requests&gt;=2.19.0-&gt;dgl) (3.8)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from requests&gt;=2.19.0-&gt;dgl) (2.2.2)
Requirement already satisfied: certifi&gt;=2017.4.17 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from requests&gt;=2.19.0-&gt;dgl) (2024.7.4)
Requirement already satisfied: torch&gt;=2 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torchdata&gt;=0.5.0-&gt;dgl) (2.4.0+cpu)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from pandas-&gt;dgl) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from pandas-&gt;dgl) (2024.1)
Requirement already satisfied: tzdata&gt;=2022.7 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from pandas-&gt;dgl) (2024.1)
Requirement already satisfied: six&gt;=1.5 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas-&gt;dgl) (1.16.0)
Requirement already satisfied: filelock in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (3.15.4)
Requirement already satisfied: typing-extensions&gt;=4.8.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (4.12.2)
Requirement already satisfied: sympy in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (1.13.2)
Requirement already satisfied: jinja2 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (3.1.4)
Requirement already satisfied: fsspec in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (2024.6.1)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from jinja2-&gt;torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (2.1.5)
Requirement already satisfied: mpmath&lt;1.4,&gt;=1.1.0 in /opt/conda/envs/dgl-dev-cpu/lib/python3.10/site-packages (from sympy-&gt;torch&gt;=2-&gt;torchdata&gt;=0.5.0-&gt;dgl) (1.3.0)
DGL installed!
</pre></div></div>
</div>
</section>
<section id="Data-preparation">
<h2>Data preparation<a class="headerlink" href="#Data-preparation" title="Link to this heading">ïƒ</a></h2>
<p>In order to demonstrate how to organize various data, letâ€™s create a base directory first.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base_dir</span> <span class="o">=</span> <span class="s1">'./ondisk_dataset_heterograph'</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Created base directory: </span><span class="si">{</span><span class="n">base_dir</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Created base directory: ./ondisk_dataset_heterograph
</pre></div></div>
</div>
<section id="Generate-graph-structure-data">
<h3>Generate graph structure data<a class="headerlink" href="#Generate-graph-structure-data" title="Link to this heading">ïƒ</a></h3>
<p>For heterogeneous graph, we need to save different edge edges(namely node pairs) into separate <strong>Numpy</strong> or <strong>CSV</strong> files.</p>
<p>Note: - when saving to <strong>Numpy</strong>, the array requires to be in shape of <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">N)</span></code>. This format is recommended as constructing graph from it is much faster than <strong>CSV</strong> file. - when saving to <strong>CSV</strong> file, do not save index and header.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># For simplicity, we create a heterogeneous graph with</span>
<span class="c1"># 2 node types: `user`, `item`</span>
<span class="c1"># 2 edge types: `user:like:item`, `user:follow:user`</span>
<span class="c1"># And each node/edge type has the same number of nodes/edges.</span>
<span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">num_edges</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">num_nodes</span>

<span class="c1"># Edge type: "user:like:item"</span>
<span class="n">like_edges_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"like-edges.csv"</span><span class="p">)</span>
<span class="n">like_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of [user:like:item] edges: </span><span class="si">{</span><span class="n">like_edges</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">like_edges</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">like_edges_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"[user:like:item] edges are saved into </span><span class="si">{</span><span class="n">like_edges_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Edge type: "user:follow:user"</span>
<span class="n">follow_edges_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"follow-edges.csv"</span><span class="p">)</span>
<span class="n">follow_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of [user:follow:user] edges: </span><span class="si">{</span><span class="n">follow_edges</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">follow_edges</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">follow_edges_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"[user:follow:user] edges are saved into </span><span class="si">{</span><span class="n">follow_edges_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Part of [user:like:item] edges: [[158 444]
 [838 685]
 [984 317]
 [461 207]
 [597 153]]

[user:like:item] edges are saved into ./ondisk_dataset_heterograph/like-edges.csv

Part of [user:follow:user] edges: [[ 11 245]
 [843 699]
 [884 218]
 [312 678]
 [188  74]]

[user:follow:user] edges are saved into ./ondisk_dataset_heterograph/follow-edges.csv

</pre></div></div>
</div>
</section>
<section id="Generate-feature-data-for-graph">
<h3>Generate feature data for graph<a class="headerlink" href="#Generate-feature-data-for-graph" title="Link to this heading">ïƒ</a></h3>
<p>For feature data, numpy arrays and torch tensors are supported for now. Letâ€™s generate feature data for each node/edge type.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate node[user] feature in numpy array.</span>
<span class="n">node_user_feat_0_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"node-user-feat-0.npy"</span><span class="p">)</span>
<span class="n">node_user_feat_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of node[user] feature [feat_0]: </span><span class="si">{</span><span class="n">node_user_feat_0</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">node_user_feat_0_path</span><span class="p">,</span> <span class="n">node_user_feat_0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Node[user] feature [feat_0] is saved to </span><span class="si">{</span><span class="n">node_user_feat_0_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate another node[user] feature in torch tensor</span>
<span class="n">node_user_feat_1_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"node-user-feat-1.pt"</span><span class="p">)</span>
<span class="n">node_user_feat_1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of node[user] feature [feat_1]: </span><span class="si">{</span><span class="n">node_user_feat_1</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">node_user_feat_1</span><span class="p">,</span> <span class="n">node_user_feat_1_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Node[user] feature [feat_1] is saved to </span><span class="si">{</span><span class="n">node_user_feat_1_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate node[item] feature in numpy array.</span>
<span class="n">node_item_feat_0_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"node-item-feat-0.npy"</span><span class="p">)</span>
<span class="n">node_item_feat_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of node[item] feature [feat_0]: </span><span class="si">{</span><span class="n">node_item_feat_0</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">node_item_feat_0_path</span><span class="p">,</span> <span class="n">node_item_feat_0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Node[item] feature [feat_0] is saved to </span><span class="si">{</span><span class="n">node_item_feat_0_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate another node[item] feature in torch tensor</span>
<span class="n">node_item_feat_1_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"node-item-feat-1.pt"</span><span class="p">)</span>
<span class="n">node_item_feat_1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of node[item] feature [feat_1]: </span><span class="si">{</span><span class="n">node_item_feat_1</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">node_item_feat_1</span><span class="p">,</span> <span class="n">node_item_feat_1_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Node[item] feature [feat_1] is saved to </span><span class="si">{</span><span class="n">node_item_feat_1_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate edge[user:like:item] feature in numpy array.</span>
<span class="n">edge_like_feat_0_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"edge-like-feat-0.npy"</span><span class="p">)</span>
<span class="n">edge_like_feat_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of edge[user:like:item] feature [feat_0]: </span><span class="si">{</span><span class="n">edge_like_feat_0</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">edge_like_feat_0_path</span><span class="p">,</span> <span class="n">edge_like_feat_0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Edge[user:like:item] feature [feat_0] is saved to </span><span class="si">{</span><span class="n">edge_like_feat_0_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate another edge[user:like:item] feature in torch tensor</span>
<span class="n">edge_like_feat_1_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"edge-like-feat-1.pt"</span><span class="p">)</span>
<span class="n">edge_like_feat_1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of edge[user:like:item] feature [feat_1]: </span><span class="si">{</span><span class="n">edge_like_feat_1</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">edge_like_feat_1</span><span class="p">,</span> <span class="n">edge_like_feat_1_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Edge[user:like:item] feature [feat_1] is saved to </span><span class="si">{</span><span class="n">edge_like_feat_1_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate edge[user:follow:user] feature in numpy array.</span>
<span class="n">edge_follow_feat_0_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"edge-follow-feat-0.npy"</span><span class="p">)</span>
<span class="n">edge_follow_feat_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of edge[user:follow:user] feature [feat_0]: </span><span class="si">{</span><span class="n">edge_follow_feat_0</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">edge_follow_feat_0_path</span><span class="p">,</span> <span class="n">edge_follow_feat_0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Edge[user:follow:user] feature [feat_0] is saved to </span><span class="si">{</span><span class="n">edge_follow_feat_0_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Generate another edge[user:follow:user] feature in torch tensor</span>
<span class="n">edge_follow_feat_1_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"edge-follow-feat-1.pt"</span><span class="p">)</span>
<span class="n">edge_follow_feat_1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_edges</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of edge[user:follow:user] feature [feat_1]: </span><span class="si">{</span><span class="n">edge_follow_feat_1</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">:]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">edge_follow_feat_1</span><span class="p">,</span> <span class="n">edge_follow_feat_1_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Edge[user:follow:user] feature [feat_1] is saved to </span><span class="si">{</span><span class="n">edge_follow_feat_1_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Part of node[user] feature [feat_0]: [[0.38549653 0.64152928 0.30168674 0.14756797 0.66411125]
 [0.99240271 0.07772828 0.46538016 0.90870363 0.91559338]
 [0.06630096 0.78015702 0.92557002 0.52237759 0.35335571]]
Node[user] feature [feat_0] is saved to ./ondisk_dataset_heterograph/node-user-feat-0.npy

Part of node[user] feature [feat_1]: tensor([[0.7100, 0.2405, 0.2885, 0.4496, 0.9730],
        [0.2667, 0.6266, 0.0149, 0.3903, 0.2006],
        [0.9206, 0.2421, 0.4535, 0.2017, 0.2078]])
Node[user] feature [feat_1] is saved to ./ondisk_dataset_heterograph/node-user-feat-1.pt

Part of node[item] feature [feat_0]: [[0.03853216 0.30399021 0.23173685 0.6738901  0.33552533]
 [0.62233571 0.8091129  0.27524689 0.41953151 0.36606632]
 [0.44783659 0.96913945 0.34269439 0.24441943 0.09341842]]
Node[item] feature [feat_0] is saved to ./ondisk_dataset_heterograph/node-item-feat-0.npy

Part of node[item] feature [feat_1]: tensor([[0.2070, 0.2580, 0.2705, 0.3839, 0.9433],
        [0.4090, 0.0882, 0.6113, 0.3062, 0.5593],
        [0.2406, 0.0973, 0.4892, 0.7453, 0.3034]])
Node[item] feature [feat_1] is saved to ./ondisk_dataset_heterograph/node-item-feat-1.pt

Part of edge[user:like:item] feature [feat_0]: [[0.42610046 0.70038271 0.64484884 0.67660132 0.66856329]
 [0.18783392 0.03942026 0.90930719 0.61422993 0.07829528]
 [0.64839341 0.18134428 0.70990316 0.33549489 0.5700555 ]]
Edge[user:like:item] feature [feat_0] is saved to ./ondisk_dataset_heterograph/edge-like-feat-0.npy

Part of edge[user:like:item] feature [feat_1]: tensor([[0.4201, 0.3138, 0.3399, 0.7463, 0.6212],
        [0.2006, 0.6508, 0.5889, 0.8474, 0.0381],
        [0.5975, 0.7955, 0.2292, 0.9512, 0.2572]])
Edge[user:like:item] feature [feat_1] is saved to ./ondisk_dataset_heterograph/edge-like-feat-1.pt

Part of edge[user:follow:user] feature [feat_0]: [[0.59206141 0.76801255 0.38179972 0.15644782 0.56156206]
 [0.75962405 0.80767067 0.48233712 0.75052389 0.93516832]
 [0.82097706 0.46359794 0.85128149 0.85929186 0.52933747]]
Edge[user:follow:user] feature [feat_0] is saved to ./ondisk_dataset_heterograph/edge-follow-feat-0.npy

Part of edge[user:follow:user] feature [feat_1]: tensor([[0.6529, 0.1965, 0.4648, 0.1633, 0.2976],
        [0.2142, 0.6420, 0.8123, 0.3233, 0.0410],
        [0.5288, 0.3592, 0.2735, 0.9079, 0.5376]])
Edge[user:follow:user] feature [feat_1] is saved to ./ondisk_dataset_heterograph/edge-follow-feat-1.pt

</pre></div></div>
</div>
</section>
<section id="Generate-tasks">
<h3>Generate tasks<a class="headerlink" href="#Generate-tasks" title="Link to this heading">ïƒ</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">OnDiskDataset</span></code> supports multiple tasks. For each task, we need to prepare training/validation/test sets respectively. Such sets usually vary among different tasks. In this tutorial, letâ€™s create a <strong>Node Classification</strong> task and <strong>Link Prediction</strong> task.</p>
<section id="Node-Classification-Task">
<h4>Node Classification Task<a class="headerlink" href="#Node-Classification-Task" title="Link to this heading">ïƒ</a></h4>
<p>For node classification task, we need <strong>node IDs</strong> and corresponding <strong>labels</strong> for each training/validation/test set. Like feature data, numpy arrays and torch tensors are supported for these sets.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For illustration, let's generate item sets for each node type.</span>
<span class="n">num_trains</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span> <span class="o">*</span> <span class="mf">0.6</span><span class="p">)</span>
<span class="n">num_vals</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_nodes</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">num_tests</span> <span class="o">=</span> <span class="n">num_nodes</span> <span class="o">-</span> <span class="n">num_trains</span> <span class="o">-</span> <span class="n">num_vals</span>

<span class="n">user_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">user_ids</span><span class="p">)</span>

<span class="n">item_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">item_ids</span><span class="p">)</span>

<span class="c1"># Train IDs for user.</span>
<span class="n">nc_train_user_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-train-user-ids.npy"</span><span class="p">)</span>
<span class="n">nc_train_user_ids</span> <span class="o">=</span> <span class="n">user_ids</span><span class="p">[:</span><span class="n">num_trains</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train ids[user] for node classification: </span><span class="si">{</span><span class="n">nc_train_user_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_train_user_ids_path</span><span class="p">,</span> <span class="n">nc_train_user_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC train ids[user] are saved to </span><span class="si">{</span><span class="n">nc_train_user_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Train labels for user.</span>
<span class="n">nc_train_user_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-train-user-labels.pt"</span><span class="p">)</span>
<span class="n">nc_train_user_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_trains</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train labels[user] for node classification: </span><span class="si">{</span><span class="n">nc_train_user_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_train_user_labels</span><span class="p">,</span> <span class="n">nc_train_user_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC train labels[user] are saved to </span><span class="si">{</span><span class="n">nc_train_user_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Train IDs for item.</span>
<span class="n">nc_train_item_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-train-item-ids.npy"</span><span class="p">)</span>
<span class="n">nc_train_item_ids</span> <span class="o">=</span> <span class="n">item_ids</span><span class="p">[:</span><span class="n">num_trains</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train ids[item] for node classification: </span><span class="si">{</span><span class="n">nc_train_item_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_train_item_ids_path</span><span class="p">,</span> <span class="n">nc_train_item_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC train ids[item] are saved to </span><span class="si">{</span><span class="n">nc_train_item_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Train labels for item.</span>
<span class="n">nc_train_item_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-train-item-labels.pt"</span><span class="p">)</span>
<span class="n">nc_train_item_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_trains</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train labels[item] for node classification: </span><span class="si">{</span><span class="n">nc_train_item_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_train_item_labels</span><span class="p">,</span> <span class="n">nc_train_item_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC train labels[item] are saved to </span><span class="si">{</span><span class="n">nc_train_item_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val IDs for user.</span>
<span class="n">nc_val_user_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-val-user-ids.npy"</span><span class="p">)</span>
<span class="n">nc_val_user_ids</span> <span class="o">=</span> <span class="n">user_ids</span><span class="p">[</span><span class="n">num_trains</span><span class="p">:</span><span class="n">num_trains</span><span class="o">+</span><span class="n">num_vals</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val ids[user] for node classification: </span><span class="si">{</span><span class="n">nc_val_user_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_val_user_ids_path</span><span class="p">,</span> <span class="n">nc_val_user_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC val ids[user] are saved to </span><span class="si">{</span><span class="n">nc_val_user_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val labels for user.</span>
<span class="n">nc_val_user_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-val-user-labels.pt"</span><span class="p">)</span>
<span class="n">nc_val_user_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_vals</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val labels[user] for node classification: </span><span class="si">{</span><span class="n">nc_val_user_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_val_user_labels</span><span class="p">,</span> <span class="n">nc_val_user_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC val labels[user] are saved to </span><span class="si">{</span><span class="n">nc_val_user_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val IDs for item.</span>
<span class="n">nc_val_item_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-val-item-ids.npy"</span><span class="p">)</span>
<span class="n">nc_val_item_ids</span> <span class="o">=</span> <span class="n">item_ids</span><span class="p">[</span><span class="n">num_trains</span><span class="p">:</span><span class="n">num_trains</span><span class="o">+</span><span class="n">num_vals</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val ids[item] for node classification: </span><span class="si">{</span><span class="n">nc_val_item_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_val_item_ids_path</span><span class="p">,</span> <span class="n">nc_val_item_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC val ids[item] are saved to </span><span class="si">{</span><span class="n">nc_val_item_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val labels for item.</span>
<span class="n">nc_val_item_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-val-item-labels.pt"</span><span class="p">)</span>
<span class="n">nc_val_item_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_vals</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val labels[item] for node classification: </span><span class="si">{</span><span class="n">nc_val_item_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_val_item_labels</span><span class="p">,</span> <span class="n">nc_val_item_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC val labels[item] are saved to </span><span class="si">{</span><span class="n">nc_val_item_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test IDs for user.</span>
<span class="n">nc_test_user_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-test-user-ids.npy"</span><span class="p">)</span>
<span class="n">nc_test_user_ids</span> <span class="o">=</span> <span class="n">user_ids</span><span class="p">[</span><span class="o">-</span><span class="n">num_tests</span><span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test ids[user] for node classification: </span><span class="si">{</span><span class="n">nc_test_user_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_test_user_ids_path</span><span class="p">,</span> <span class="n">nc_test_user_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC test ids[user] are saved to </span><span class="si">{</span><span class="n">nc_test_user_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test labels for user.</span>
<span class="n">nc_test_user_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-test-user-labels.pt"</span><span class="p">)</span>
<span class="n">nc_test_user_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_tests</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test labels[user] for node classification: </span><span class="si">{</span><span class="n">nc_test_user_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_test_user_labels</span><span class="p">,</span> <span class="n">nc_test_user_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC test labels[user] are saved to </span><span class="si">{</span><span class="n">nc_test_user_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test IDs for item.</span>
<span class="n">nc_test_item_ids_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-test-item-ids.npy"</span><span class="p">)</span>
<span class="n">nc_test_item_ids</span> <span class="o">=</span> <span class="n">item_ids</span><span class="p">[</span><span class="o">-</span><span class="n">num_tests</span><span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test ids[item] for node classification: </span><span class="si">{</span><span class="n">nc_test_item_ids</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_test_item_ids_path</span><span class="p">,</span> <span class="n">nc_test_item_ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC test ids[item] are saved to </span><span class="si">{</span><span class="n">nc_test_item_ids_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test labels for item.</span>
<span class="n">nc_test_item_labels_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"nc-test-item-labels.pt"</span><span class="p">)</span>
<span class="n">nc_test_item_labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">num_tests</span><span class="p">,))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test labels[item] for node classification: </span><span class="si">{</span><span class="n">nc_test_item_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nc_test_item_labels</span><span class="p">,</span> <span class="n">nc_test_item_labels_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"NC test labels[item] are saved to </span><span class="si">{</span><span class="n">nc_test_item_labels_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Part of train ids[user] for node classification: [783   6 425]
NC train ids[user] are saved to ./ondisk_dataset_heterograph/nc-train-user-ids.npy

Part of train labels[user] for node classification: tensor([4, 4, 2])
NC train labels[user] are saved to ./ondisk_dataset_heterograph/nc-train-user-labels.pt

Part of train ids[item] for node classification: [631 735 695]
NC train ids[item] are saved to ./ondisk_dataset_heterograph/nc-train-item-ids.npy

Part of train labels[item] for node classification: tensor([9, 8, 5])
NC train labels[item] are saved to ./ondisk_dataset_heterograph/nc-train-item-labels.pt

Part of val ids[user] for node classification: [240 257 128]
NC val ids[user] are saved to ./ondisk_dataset_heterograph/nc-val-user-ids.npy

Part of val labels[user] for node classification: tensor([8, 5, 6])
NC val labels[user] are saved to ./ondisk_dataset_heterograph/nc-val-user-labels.pt

Part of val ids[item] for node classification: [442 572 102]
NC val ids[item] are saved to ./ondisk_dataset_heterograph/nc-val-item-ids.npy

Part of val labels[item] for node classification: tensor([3, 3, 2])
NC val labels[item] are saved to ./ondisk_dataset_heterograph/nc-val-item-labels.pt

Part of test ids[user] for node classification: [187 460 630]
NC test ids[user] are saved to ./ondisk_dataset_heterograph/nc-test-user-ids.npy

Part of test labels[user] for node classification: tensor([0, 1, 9])
NC test labels[user] are saved to ./ondisk_dataset_heterograph/nc-test-user-labels.pt

Part of test ids[item] for node classification: [218 317 772]
NC test ids[item] are saved to ./ondisk_dataset_heterograph/nc-test-item-ids.npy

Part of test labels[item] for node classification: tensor([2, 2, 6])
NC test labels[item] are saved to ./ondisk_dataset_heterograph/nc-test-item-labels.pt

</pre></div></div>
</div>
</section>
<section id="Link-Prediction-Task">
<h4>Link Prediction Task<a class="headerlink" href="#Link-Prediction-Task" title="Link to this heading">ïƒ</a></h4>
<p>For link prediction task, we need <strong>node pairs</strong> or <strong>negative src/dsts</strong> for each training/validation/test set. Like feature data, numpy arrays and torch tensors are supported for these sets.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For illustration, let's generate item sets for each edge type.</span>
<span class="n">num_trains</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_edges</span> <span class="o">*</span> <span class="mf">0.6</span><span class="p">)</span>
<span class="n">num_vals</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num_edges</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">num_tests</span> <span class="o">=</span> <span class="n">num_edges</span> <span class="o">-</span> <span class="n">num_trains</span> <span class="o">-</span> <span class="n">num_vals</span>

<span class="c1"># Train node pairs for user:like:item.</span>
<span class="n">lp_train_like_node_pairs_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-train-like-node-pairs.npy"</span><span class="p">)</span>
<span class="n">lp_train_like_node_pairs</span> <span class="o">=</span> <span class="n">like_edges</span><span class="p">[:</span><span class="n">num_trains</span><span class="p">,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train node pairs[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_train_like_node_pairs</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_train_like_node_pairs_path</span><span class="p">,</span> <span class="n">lp_train_like_node_pairs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP train node pairs[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_train_like_node_pairs_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Train node pairs for user:follow:user.</span>
<span class="n">lp_train_follow_node_pairs_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-train-follow-node-pairs.npy"</span><span class="p">)</span>
<span class="n">lp_train_follow_node_pairs</span> <span class="o">=</span> <span class="n">follow_edges</span><span class="p">[:</span><span class="n">num_trains</span><span class="p">,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of train node pairs[user:follow:user] for link prediction: </span><span class="si">{</span><span class="n">lp_train_follow_node_pairs</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_train_follow_node_pairs_path</span><span class="p">,</span> <span class="n">lp_train_follow_node_pairs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP train node pairs[user:follow:user] are saved to </span><span class="si">{</span><span class="n">lp_train_follow_node_pairs_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val node pairs for user:like:item.</span>
<span class="n">lp_val_like_node_pairs_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-val-like-node-pairs.npy"</span><span class="p">)</span>
<span class="n">lp_val_like_node_pairs</span> <span class="o">=</span> <span class="n">like_edges</span><span class="p">[</span><span class="n">num_trains</span><span class="p">:</span><span class="n">num_trains</span><span class="o">+</span><span class="n">num_vals</span><span class="p">,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val node pairs[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_val_like_node_pairs</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_val_like_node_pairs_path</span><span class="p">,</span> <span class="n">lp_val_like_node_pairs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP val node pairs[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_val_like_node_pairs_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val negative dsts for user:like:item.</span>
<span class="n">lp_val_like_neg_dsts_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-val-like-neg-dsts.pt"</span><span class="p">)</span>
<span class="n">lp_val_like_neg_dsts</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">num_vals</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val negative dsts[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_val_like_neg_dsts</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_val_like_neg_dsts</span><span class="p">,</span> <span class="n">lp_val_like_neg_dsts_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP val negative dsts[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_val_like_neg_dsts_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val node pairs for user:follow:user.</span>
<span class="n">lp_val_follow_node_pairs_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-val-follow-node-pairs.npy"</span><span class="p">)</span>
<span class="n">lp_val_follow_node_pairs</span> <span class="o">=</span> <span class="n">follow_edges</span><span class="p">[</span><span class="n">num_trains</span><span class="p">:</span><span class="n">num_trains</span><span class="o">+</span><span class="n">num_vals</span><span class="p">,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val node pairs[user:follow:user] for link prediction: </span><span class="si">{</span><span class="n">lp_val_follow_node_pairs</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_val_follow_node_pairs_path</span><span class="p">,</span> <span class="n">lp_val_follow_node_pairs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP val node pairs[user:follow:user] are saved to </span><span class="si">{</span><span class="n">lp_val_follow_node_pairs_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Val negative dsts for user:follow:user.</span>
<span class="n">lp_val_follow_neg_dsts_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-val-follow-neg-dsts.pt"</span><span class="p">)</span>
<span class="n">lp_val_follow_neg_dsts</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">num_vals</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of val negative dsts[user:follow:user] for link prediction: </span><span class="si">{</span><span class="n">lp_val_follow_neg_dsts</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_val_follow_neg_dsts</span><span class="p">,</span> <span class="n">lp_val_follow_neg_dsts_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP val negative dsts[user:follow:user] are saved to </span><span class="si">{</span><span class="n">lp_val_follow_neg_dsts_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test node paris for user:like:item.</span>
<span class="n">lp_test_like_node_pairs_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-test-like-node-pairs.npy"</span><span class="p">)</span>
<span class="n">lp_test_like_node_pairs</span> <span class="o">=</span> <span class="n">like_edges</span><span class="p">[</span><span class="o">-</span><span class="n">num_tests</span><span class="p">,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test node pairs[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_test_like_node_pairs</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_test_like_node_pairs_path</span><span class="p">,</span> <span class="n">lp_test_like_node_pairs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP test node pairs[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_test_like_node_pairs_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test negative dsts for user:like:item.</span>
<span class="n">lp_test_like_neg_dsts_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-test-like-neg-dsts.pt"</span><span class="p">)</span>
<span class="n">lp_test_like_neg_dsts</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">num_tests</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test negative dsts[user:like:item] for link prediction: </span><span class="si">{</span><span class="n">lp_test_like_neg_dsts</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_test_like_neg_dsts</span><span class="p">,</span> <span class="n">lp_test_like_neg_dsts_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP test negative dsts[user:like:item] are saved to </span><span class="si">{</span><span class="n">lp_test_like_neg_dsts_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test node paris for user:follow:user.</span>
<span class="n">lp_test_follow_node_pairs_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-test-follow-node-pairs.npy"</span><span class="p">)</span>
<span class="n">lp_test_follow_node_pairs</span> <span class="o">=</span> <span class="n">follow_edges</span><span class="p">[</span><span class="o">-</span><span class="n">num_tests</span><span class="p">,</span> <span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test node pairs[user:follow:user] for link prediction: </span><span class="si">{</span><span class="n">lp_test_follow_node_pairs</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_test_follow_node_pairs_path</span><span class="p">,</span> <span class="n">lp_test_follow_node_pairs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP test node pairs[user:follow:user] are saved to </span><span class="si">{</span><span class="n">lp_test_follow_node_pairs_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># Test negative dsts for user:follow:user.</span>
<span class="n">lp_test_follow_neg_dsts_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"lp-test-follow-neg-dsts.pt"</span><span class="p">)</span>
<span class="n">lp_test_follow_neg_dsts</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">,</span> <span class="p">(</span><span class="n">num_tests</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Part of test negative dsts[user:follow:user] for link prediction: </span><span class="si">{</span><span class="n">lp_test_follow_neg_dsts</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">lp_test_follow_neg_dsts</span><span class="p">,</span> <span class="n">lp_test_follow_neg_dsts_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"LP test negative dsts[user:follow:user] are saved to </span><span class="si">{</span><span class="n">lp_test_follow_neg_dsts_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Part of train node pairs[user:like:item] for link prediction: [[158 444]
 [838 685]
 [984 317]]
LP train node pairs[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-train-like-node-pairs.npy

Part of train node pairs[user:follow:user] for link prediction: [[ 11 245]
 [843 699]
 [884 218]]
LP train node pairs[user:follow:user] are saved to ./ondisk_dataset_heterograph/lp-train-follow-node-pairs.npy

Part of val node pairs[user:like:item] for link prediction: [[710  98]
 [ 33 211]
 [ 87 835]]
LP val node pairs[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-val-like-node-pairs.npy

Part of val negative dsts[user:like:item] for link prediction: tensor([[710,  11, 855, 292,  23,  86, 764, 122,  77,  14],
        [424, 321, 575, 244, 982, 931, 905, 260, 585, 706],
        [801, 707, 964, 719,   3, 323, 310, 369, 140, 161]])
LP val negative dsts[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-val-like-neg-dsts.pt

Part of val node pairs[user:follow:user] for link prediction: [[ 61 816]
 [432 868]
 [694 764]]
LP val node pairs[user:follow:user] are saved to ./ondisk_dataset_heterograph/lp-val-follow-node-pairs.npy

Part of val negative dsts[user:follow:user] for link prediction: tensor([[696, 362,  42, 899, 176, 300,  24, 177, 116, 116],
        [945, 523, 269, 758, 896, 256, 690, 880, 309, 374],
        [602, 464, 867, 250, 468, 886, 829, 103, 643, 147]])
LP val negative dsts[user:follow:user] are saved to ./ondisk_dataset_heterograph/lp-val-follow-neg-dsts.pt

Part of test node pairs[user:like:item] for link prediction: [741   4]
LP test node pairs[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-test-like-node-pairs.npy

Part of test negative dsts[user:like:item] for link prediction: tensor([[769,  98, 825, 503, 519, 299, 264, 725, 795,   5],
        [900, 953, 516, 617, 831, 292, 774,  13, 193, 914],
        [380, 294, 173, 569, 614, 100, 391, 462, 894, 524]])
LP test negative dsts[user:like:item] are saved to ./ondisk_dataset_heterograph/lp-test-like-neg-dsts.pt

Part of test node pairs[user:follow:user] for link prediction: [409 713]
LP test node pairs[user:follow:user] are saved to ./ondisk_dataset_heterograph/lp-test-follow-node-pairs.npy

Part of test negative dsts[user:follow:user] for link prediction: tensor([[  7, 373, 350, 310, 495, 891, 211,  46, 445, 920],
        [216, 606, 571,   7, 992, 657, 680, 842, 192, 351],
        [210,  77, 218, 865, 612,  72, 590,  27, 754, 287]])
LP test negative dsts[user:follow:user] are saved to ./ondisk_dataset_heterograph/lp-test-follow-neg-dsts.pt

</pre></div></div>
</div>
</section>
</section>
</section>
<section id="Organize-Data-into-YAML-File">
<h2>Organize Data into YAML File<a class="headerlink" href="#Organize-Data-into-YAML-File" title="Link to this heading">ïƒ</a></h2>
<p>Now we need to create a <code class="docutils literal notranslate"><span class="pre">metadata.yaml</span></code> file which contains the paths, dadta types of graph structure, feature data, training/validation/test sets. Please note that all path should be relative to <code class="docutils literal notranslate"><span class="pre">metadata.yaml</span></code>.</p>
<p>For heterogeneous graph, we need to specify the node/edge type in <strong>type</strong> fields. For edge type, canonical etype is required which is a string thatâ€™s concatenated by source node type, etype, and destination node type together with <code class="docutils literal notranslate"><span class="pre">:</span></code>.</p>
<p>Notes: - all path should be relative to <code class="docutils literal notranslate"><span class="pre">metadata.yaml</span></code>. - Below fields are optional and not specified in below example. - <code class="docutils literal notranslate"><span class="pre">in_memory</span></code>: indicates whether to load dada into memory or <code class="docutils literal notranslate"><span class="pre">mmap</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>Please refer to <a class="reference external" href="https://github.com/dmlc/dgl/blob/master/docs/source/stochastic_training/ondisk-dataset-specification.rst">YAML specification</a> for more details.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yaml_content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">    dataset_name: heterogeneous_graph_nc_lp</span>
<span class="s2">    graph:</span>
<span class="s2">      nodes:</span>
<span class="s2">        - type: user</span>
<span class="s2">          num: </span><span class="si">{</span><span class="n">num_nodes</span><span class="si">}</span>
<span class="s2">        - type: item</span>
<span class="s2">          num: </span><span class="si">{</span><span class="n">num_nodes</span><span class="si">}</span>
<span class="s2">      edges:</span>
<span class="s2">        - type: "user:like:item"</span>
<span class="s2">          format: csv</span>
<span class="s2">          path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">like_edges_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        - type: "user:follow:user"</span>
<span class="s2">          format: csv</span>
<span class="s2">          path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">follow_edges_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">    feature_data:</span>
<span class="s2">      - domain: node</span>
<span class="s2">        type: user</span>
<span class="s2">        name: feat_0</span>
<span class="s2">        format: numpy</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">node_user_feat_0_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: node</span>
<span class="s2">        type: user</span>
<span class="s2">        name: feat_1</span>
<span class="s2">        format: torch</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">node_user_feat_1_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: node</span>
<span class="s2">        type: item</span>
<span class="s2">        name: feat_0</span>
<span class="s2">        format: numpy</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">node_item_feat_0_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: node</span>
<span class="s2">        type: item</span>
<span class="s2">        name: feat_1</span>
<span class="s2">        format: torch</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">node_item_feat_1_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: edge</span>
<span class="s2">        type: "user:like:item"</span>
<span class="s2">        name: feat_0</span>
<span class="s2">        format: numpy</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">edge_like_feat_0_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: edge</span>
<span class="s2">        type: "user:like:item"</span>
<span class="s2">        name: feat_1</span>
<span class="s2">        format: torch</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">edge_like_feat_1_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: edge</span>
<span class="s2">        type: "user:follow:user"</span>
<span class="s2">        name: feat_0</span>
<span class="s2">        format: numpy</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">edge_follow_feat_0_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - domain: edge</span>
<span class="s2">        type: "user:follow:user"</span>
<span class="s2">        name: feat_1</span>
<span class="s2">        format: torch</span>
<span class="s2">        path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">edge_follow_feat_1_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">    tasks:</span>
<span class="s2">      - name: node_classification</span>
<span class="s2">        num_classes: 10</span>
<span class="s2">        train_set:</span>
<span class="s2">          - type: user</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seed_nodes</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_train_user_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_train_user_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: item</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seed_nodes</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_train_item_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_train_item_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        validation_set:</span>
<span class="s2">          - type: user</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seed_nodes</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_val_user_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_val_user_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: item</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seed_nodes</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_val_item_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_val_item_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        test_set:</span>
<span class="s2">          - type: user</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seed_nodes</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_test_user_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_test_user_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: item</span>
<span class="s2">            data:</span>
<span class="s2">              - name: seed_nodes</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_test_item_ids_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: labels</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nc_test_item_labels_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">      - name: link_prediction</span>
<span class="s2">        num_classes: 10</span>
<span class="s2">        train_set:</span>
<span class="s2">          - type: "user:like:item"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: node_pairs</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_train_like_node_pairs_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: "user:follow:user"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: node_pairs</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_train_follow_node_pairs_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        validation_set:</span>
<span class="s2">          - type: "user:like:item"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: node_pairs</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_val_like_node_pairs_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: negative_dsts</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_val_like_neg_dsts_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: "user:follow:user"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: node_pairs</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_val_follow_node_pairs_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: negative_dsts</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_val_follow_neg_dsts_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">        test_set:</span>
<span class="s2">          - type: "user:like:item"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: node_pairs</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_test_like_node_pairs_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: negative_dsts</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_test_like_neg_dsts_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">          - type: "user:follow:user"</span>
<span class="s2">            data:</span>
<span class="s2">              - name: node_pairs</span>
<span class="s2">                format: numpy</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_test_follow_node_pairs_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">              - name: negative_dsts</span>
<span class="s2">                format: torch</span>
<span class="s2">                path: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">lp_test_follow_neg_dsts_path</span><span class="p">)</span><span class="si">}</span>
<span class="s2">"""</span>
<span class="n">metadata_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="s2">"metadata.yaml"</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">metadata_path</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">yaml_content</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Instantiate-OnDiskDataset">
<h2>Instantiate <code class="docutils literal notranslate"><span class="pre">OnDiskDataset</span></code><a class="headerlink" href="#Instantiate-OnDiskDataset" title="Link to this heading">ïƒ</a></h2>
<p>Now weâ€™re ready to load dataset via <code class="docutils literal notranslate"><span class="pre">dgl.graphbolt.OnDiskDataset</span></code>. When instantiating, we just pass in the base directory where <code class="docutils literal notranslate"><span class="pre">metadata.yaml</span></code> file lies.</p>
<p>During first instantiation, GraphBolt preprocesses the raw data such as constructing <code class="docutils literal notranslate"><span class="pre">FusedCSCSamplingGraph</span></code> from edges. All data including graph, feature data, training/validation/test sets are put into <code class="docutils literal notranslate"><span class="pre">preprocessed</span></code> directory after preprocessing. Any following dataset loading will skip the preprocess stage.</p>
<p>After preprocessing, <code class="docutils literal notranslate"><span class="pre">load()</span></code> is required to be called explicitly in order to load graph, feature data and tasks.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">OnDiskDataset</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">graph</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Loaded graph: </span><span class="si">{</span><span class="n">graph</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">feature</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">feature</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Loaded feature store: </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">tasks</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">tasks</span>
<span class="n">nc_task</span> <span class="o">=</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Loaded node classification task: </span><span class="si">{</span><span class="n">nc_task</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">lp_task</span> <span class="o">=</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Loaded link prediction task: </span><span class="si">{</span><span class="n">lp_task</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The on-disk dataset is re-preprocessing, so the existing preprocessed dataset has been removed.
Start to preprocess the on-disk dataset.
Finish preprocessing the on-disk dataset.
Loaded graph: FusedCSCSamplingGraph(csc_indptr=tensor([    0,     8,    23,  ..., 19979, 19985, 20000], dtype=torch.int32),
                      indices=tensor([1481, 1035, 1795,  ..., 1331, 1028, 1348], dtype=torch.int32),
                      total_num_nodes=2000, num_edges={'user:follow:user': 10000, 'user:like:item': 10000},
                      node_type_offset=tensor([   0, 1000, 2000], dtype=torch.int32),
                      type_per_edge=tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.uint8),
                      node_type_to_id={'item': 0, 'user': 1},
                      edge_type_to_id={'user:follow:user': 0, 'user:like:item': 1},)

Loaded feature store: TorchBasedFeatureStore(
    {(&lt;OnDiskFeatureDataDomain.NODE: 'node'&gt;, 'user', 'feat_0'): TorchBasedFeature(
        feature=tensor([[0.3855, 0.6415, 0.3017, 0.1476, 0.6641],
                        [0.9924, 0.0777, 0.4654, 0.9087, 0.9156],
                        [0.0663, 0.7802, 0.9256, 0.5224, 0.3534],
                        ...,
                        [0.0369, 0.6813, 0.0968, 0.5371, 0.6892],
                        [0.0864, 0.8249, 0.5202, 0.0149, 0.5459],
                        [0.5323, 0.0197, 0.2692, 0.7999, 0.5572]], dtype=torch.float64),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.NODE: 'node'&gt;, 'user', 'feat_1'): TorchBasedFeature(
        feature=tensor([[0.7100, 0.2405, 0.2885, 0.4496, 0.9730],
                        [0.2667, 0.6266, 0.0149, 0.3903, 0.2006],
                        [0.9206, 0.2421, 0.4535, 0.2017, 0.2078],
                        ...,
                        [0.4428, 0.5906, 0.4400, 0.0084, 0.0123],
                        [0.5330, 0.9931, 0.4180, 0.1809, 0.7197],
                        [0.4884, 0.6634, 0.5388, 0.0416, 0.3750]]),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.NODE: 'node'&gt;, 'item', 'feat_0'): TorchBasedFeature(
        feature=tensor([[0.0385, 0.3040, 0.2317, 0.6739, 0.3355],
                        [0.6223, 0.8091, 0.2752, 0.4195, 0.3661],
                        [0.4478, 0.9691, 0.3427, 0.2444, 0.0934],
                        ...,
                        [0.4583, 0.6198, 0.4319, 0.8689, 0.6168],
                        [0.7533, 0.5011, 0.3670, 0.5130, 0.1776],
                        [0.8833, 0.3244, 0.2958, 0.3765, 0.7597]], dtype=torch.float64),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.NODE: 'node'&gt;, 'item', 'feat_1'): TorchBasedFeature(
        feature=tensor([[0.2070, 0.2580, 0.2705, 0.3839, 0.9433],
                        [0.4090, 0.0882, 0.6113, 0.3062, 0.5593],
                        [0.2406, 0.0973, 0.4892, 0.7453, 0.3034],
                        ...,
                        [0.5605, 0.4961, 0.7817, 0.0578, 0.8285],
                        [0.6403, 0.6874, 0.8852, 0.2093, 0.1015],
                        [0.1458, 0.8151, 0.7867, 0.4925, 0.3148]]),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.EDGE: 'edge'&gt;, 'user:like:item', 'feat_0'): TorchBasedFeature(
        feature=tensor([[0.4261, 0.7004, 0.6448, 0.6766, 0.6686],
                        [0.1878, 0.0394, 0.9093, 0.6142, 0.0783],
                        [0.6484, 0.1813, 0.7099, 0.3355, 0.5701],
                        ...,
                        [0.5876, 0.1391, 0.4609, 0.8826, 0.6060],
                        [0.5527, 0.8893, 0.5381, 0.9071, 0.2813],
                        [0.3696, 0.5844, 0.9281, 0.5085, 0.6012]], dtype=torch.float64),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.EDGE: 'edge'&gt;, 'user:like:item', 'feat_1'): TorchBasedFeature(
        feature=tensor([[0.4201, 0.3138, 0.3399, 0.7463, 0.6212],
                        [0.2006, 0.6508, 0.5889, 0.8474, 0.0381],
                        [0.5975, 0.7955, 0.2292, 0.9512, 0.2572],
                        ...,
                        [0.3379, 0.4597, 0.3834, 0.5815, 0.8054],
                        [0.5039, 0.3404, 0.3693, 0.8403, 0.7181],
                        [0.6201, 0.9732, 0.7144, 0.2747, 0.4378]]),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.EDGE: 'edge'&gt;, 'user:follow:user', 'feat_0'): TorchBasedFeature(
        feature=tensor([[0.5921, 0.7680, 0.3818, 0.1564, 0.5616],
                        [0.7596, 0.8077, 0.4823, 0.7505, 0.9352],
                        [0.8210, 0.4636, 0.8513, 0.8593, 0.5293],
                        ...,
                        [0.7329, 0.4315, 0.7218, 0.7232, 0.1431],
                        [0.0725, 0.7650, 0.0203, 0.8736, 0.7289],
                        [0.0643, 0.3802, 0.8527, 0.5067, 0.5213]], dtype=torch.float64),
        metadata={},
    ), (&lt;OnDiskFeatureDataDomain.EDGE: 'edge'&gt;, 'user:follow:user', 'feat_1'): TorchBasedFeature(
        feature=tensor([[0.6529, 0.1965, 0.4648, 0.1633, 0.2976],
                        [0.2142, 0.6420, 0.8123, 0.3233, 0.0410],
                        [0.5288, 0.3592, 0.2735, 0.9079, 0.5376],
                        ...,
                        [0.0184, 0.4927, 0.6617, 0.3743, 0.7703],
                        [0.1188, 0.5767, 0.1570, 0.3005, 0.9841],
                        [0.1864, 0.8455, 0.7597, 0.8812, 0.5029]]),
        metadata={},
    )}
)

Loaded node classification task: OnDiskTask(validation_set=ItemSetDict(
               itemsets={'user': ItemSet(
                            items=(tensor([240, 257, 128, 225, 911,  94, 789, 707, 680, 766, 183, 163, 148, 937,
                                591, 389, 668, 792, 311, 150, 416, 571, 118, 641, 701, 760, 375,  73,
                                433, 382, 260, 353,  55, 691,  69, 264, 468, 578, 110, 624, 554, 413,
                                519, 373, 673, 131, 354, 660, 542, 435, 450, 431, 169, 734, 809, 585,
                                687, 949, 782, 638, 356, 456, 432, 236, 475, 879, 951,  17,  75, 420,
                                335, 133, 521,  71, 686, 963, 762, 904,  15, 331, 251,  11, 750, 653,
                                249, 106, 883, 564, 209, 307, 995, 759, 834, 871,  98, 741, 229,  42,
                                961, 443, 570, 424,  65, 901, 319, 922, 421, 797, 273, 256, 350, 870,
                                589, 228, 531, 815, 316, 713, 813, 374, 972, 558, 593, 715, 866, 408,
                                121, 269, 678, 341, 167, 480, 748, 692, 676, 737, 962, 288, 852, 694,
                                464, 817,  57,  56, 220,   7, 215, 621, 318, 326, 575, 556, 643, 955,
                                541, 619, 761, 175, 898, 842, 688, 971, 124, 357, 546, 814, 969, 428,
                                254, 533, 530, 211, 664, 658, 610, 305, 404,  54,  97, 369, 477, 174,
                                651,  16, 895, 159,  95,  85, 323, 964,   0, 945, 505, 122, 740, 312,
                                839, 205, 920,  20], dtype=torch.int32), tensor([8, 5, 6, 3, 6, 5, 6, 3, 1, 9, 6, 0, 8, 5, 2, 6, 1, 1, 1, 5, 5, 7, 3, 0,
                                5, 5, 9, 0, 3, 0, 5, 7, 5, 4, 2, 1, 7, 2, 8, 6, 0, 4, 9, 8, 6, 4, 7, 6,
                                8, 9, 1, 8, 1, 5, 4, 1, 2, 8, 4, 0, 9, 3, 1, 5, 2, 0, 4, 5, 7, 8, 8, 0,
                                7, 3, 7, 5, 0, 2, 1, 1, 1, 2, 1, 5, 4, 3, 0, 9, 5, 3, 7, 9, 3, 0, 5, 6,
                                2, 7, 3, 8, 0, 0, 3, 8, 3, 4, 4, 4, 1, 4, 3, 0, 7, 1, 3, 7, 9, 1, 5, 8,
                                1, 1, 9, 9, 1, 3, 1, 4, 9, 8, 0, 2, 1, 1, 0, 8, 0, 1, 5, 2, 2, 0, 5, 1,
                                2, 2, 9, 0, 1, 6, 2, 0, 2, 9, 5, 0, 6, 3, 6, 5, 0, 8, 5, 7, 3, 6, 1, 4,
                                3, 1, 4, 3, 7, 8, 8, 3, 8, 1, 6, 0, 7, 9, 4, 5, 1, 7, 1, 6, 2, 3, 2, 8,
                                8, 3, 2, 0, 0, 0, 4, 3])),
                            names=('seed_nodes', 'labels'),
                        ), 'item': ItemSet(
                            items=(tensor([442, 572, 102,  63, 730, 824, 689, 267, 347, 683, 937, 254,   3, 417,
                                467, 334, 700, 260, 483, 997, 505, 879, 785, 164, 867, 946, 893, 532,
                                452, 425, 182, 520, 613, 262, 277,  27,  72, 952, 922, 508, 252,  15,
                                715, 266, 672, 771, 372, 666,  77, 562, 776, 734, 833, 450, 742, 463,
                                453, 517, 154, 283, 469, 132, 757,  18, 314, 580, 840, 752, 199, 707,
                                 43, 656, 933,  66, 173, 384, 358,  70, 650, 676, 395, 294, 490, 370,
                                886, 341, 854, 391, 503, 350, 853, 635, 434, 863,  81, 596,  59,  30,
                                 96, 966, 301, 351, 759, 362, 140,  68, 552, 177, 601, 855, 621, 103,
                                535, 307, 288, 389, 767, 844, 802, 402,  21,  32, 662, 859, 878, 195,
                                858, 313, 519, 636, 494, 242, 181, 659, 918, 897, 399, 265, 284,  34,
                                 87, 619, 810, 430, 287, 555, 903,  71, 818, 816, 388, 880, 456, 303,
                                118, 444, 538,   9, 419, 240, 592, 663, 361, 275, 985,  94, 652, 146,
                                796,  14, 202,  65, 603, 791, 331, 299, 251, 633, 576, 658, 852, 245,
                                841, 454,   8, 965, 472, 634,  36, 185, 660, 524, 152, 829, 477, 688,
                                687, 243, 972, 711], dtype=torch.int32), tensor([3, 3, 2, 6, 0, 4, 2, 2, 4, 3, 0, 5, 7, 8, 2, 4, 8, 5, 4, 1, 1, 7, 6, 1,
                                6, 5, 3, 3, 9, 7, 6, 7, 5, 5, 3, 3, 0, 9, 2, 7, 0, 0, 3, 4, 3, 3, 9, 2,
                                4, 0, 4, 4, 8, 4, 4, 1, 8, 8, 7, 8, 9, 0, 4, 4, 1, 1, 1, 2, 6, 0, 8, 3,
                                4, 3, 0, 5, 5, 4, 9, 1, 7, 7, 3, 5, 0, 9, 6, 7, 2, 4, 8, 8, 8, 1, 0, 1,
                                7, 8, 2, 0, 3, 1, 1, 1, 5, 6, 7, 7, 4, 5, 0, 2, 9, 3, 8, 4, 0, 8, 9, 3,
                                0, 3, 5, 9, 0, 5, 5, 9, 9, 0, 2, 3, 7, 2, 1, 2, 7, 4, 1, 4, 5, 7, 5, 3,
                                8, 3, 7, 0, 7, 6, 2, 2, 1, 6, 4, 9, 0, 0, 1, 1, 4, 1, 7, 4, 9, 2, 4, 5,
                                5, 8, 3, 2, 5, 1, 3, 2, 4, 6, 8, 9, 1, 5, 4, 1, 3, 0, 5, 0, 5, 4, 8, 7,
                                8, 7, 0, 2, 3, 6, 4, 9])),
                            names=('seed_nodes', 'labels'),
                        )},
               names=('seed_nodes', 'labels'),
           ),
           train_set=ItemSetDict(
               itemsets={'user': ItemSet(
                            items=(tensor([783,   6, 425, 886, 726, 982, 965, 265, 524, 123, 990, 891, 315, 780,
                                482, 604, 672, 178, 397, 716, 720,  33, 616,  21, 184, 695, 219, 831,
                                577, 126, 978, 378, 572, 496, 860,  23, 484, 959, 845,  70, 263,  91,
                                808, 258,   8,  31, 213, 280, 608, 154, 116, 287,   5, 977, 396, 532,
                                370, 944, 363, 345, 933, 968, 317, 882, 145,  12, 642, 787, 979, 884,
                                  1, 347, 873, 788, 669, 926, 523, 580, 278, 371, 579, 513, 751, 667,
                                226, 708, 623, 516, 781, 486, 191, 993, 384, 306, 422, 285, 885, 244,
                                878, 957, 596, 980, 509, 960, 266, 843, 798,   3, 914, 684, 108, 465,
                                136, 221, 943, 566, 518, 165, 675, 942, 467, 152, 343, 696, 910, 206,
                                330, 342, 233, 888, 129, 391, 719, 216, 924, 685, 916, 999, 338, 698,
                                733, 828, 289, 637, 310, 217, 262, 512, 281, 434, 359, 954, 706, 628,
                                939, 401, 162, 728, 390, 399, 976, 180, 804, 309, 889, 130, 320, 609,
                                632,  37,  90, 385, 437, 497, 654, 479, 796, 242,  44, 511, 869, 488,
                                552, 938, 864, 501, 352, 799, 652, 590, 528, 510, 559, 297, 230, 157,
                                908, 239, 367, 666, 721,  10, 490, 514, 921, 700, 854, 606, 646, 948,
                                617, 998,  47, 202, 917, 445, 339, 403, 250, 958, 139, 810, 368, 970,
                                868, 603, 247, 941, 529, 626, 166, 101, 137, 631,  72, 200, 774, 156,
                                851, 112, 846, 483,  28, 253, 702, 681, 677, 544, 298, 246, 414, 928,
                                395, 991, 405,  18, 337, 195, 634, 861, 801, 300, 874, 499, 896,  45,
                                194, 915, 855, 690, 697, 400, 778, 291, 567, 155, 752, 844, 454, 442,
                                238, 415, 555, 103, 973,  59, 975, 747, 662, 934, 525, 267, 907, 336,
                                714, 803,  38, 366,  99, 718, 526, 304, 313, 481, 132, 919, 576, 573,
                                850, 614, 485,  86, 786, 663, 779, 314, 212,  92, 657, 274, 827, 453,
                                841, 611, 659,  61, 835, 534, 930, 909,  76, 985, 474, 466, 271, 114,
                                471, 807,  67, 729, 929, 735, 838, 351, 203, 640, 284, 469, 196, 905,
                                151, 549, 932, 656, 821, 245, 333, 107, 492, 158, 756, 113, 362, 218,
                                725, 767, 472, 438, 784, 473, 863,  49,  53, 795, 743, 598,  13, 986,
                                536, 758, 355, 109, 125, 563,  14, 412, 940, 515, 856,  81, 927, 539,
                                470, 600, 648,  51, 739, 997, 527, 775, 140, 887, 840, 894, 235, 491,
                                 24, 724, 186, 448, 100, 569, 936, 749, 777, 388, 446, 372, 988, 419,
                                294, 423, 296, 170, 447,  60, 502, 383, 199, 325, 455, 639, 104, 992,
                                818, 227, 903, 947, 858, 848,  29, 618, 770, 935, 224, 551, 458, 292,
                                602, 825, 207, 862, 411, 565, 723, 537,  74, 674, 346, 950, 440, 500,
                                557, 670, 407, 704, 192, 349, 457, 261, 601, 876, 731, 679, 177, 605,
                                275, 181, 268,   2, 703,  40, 198, 772, 111, 223, 332, 364, 820, 615,
                                635, 270, 952, 974, 989, 237, 811, 361, 279, 800, 645, 802, 709, 115,
                                 88, 452, 302, 329, 459, 173, 620, 410, 785,  35,  93, 380,  48, 693,
                                776, 365, 682, 543,  26,  96, 584, 588,  41, 769, 241, 816,  22, 182,
                                794, 900, 208, 732, 746, 324, 386, 348, 394, 360,  87, 520,  27, 594,
                                327, 765, 881, 406, 506, 204, 823, 629, 393, 463, 744,  34, 272, 574,
                                913, 102,  68, 522,  25, 830, 197, 994, 595, 308, 612, 946, 449, 426,
                                587, 149,  66, 508, 829, 436, 853, 255, 931, 984,   4, 880, 562, 771,
                                899,  62,  64, 430, 683, 171, 824, 478, 143, 806, 742, 398],
                               dtype=torch.int32), tensor([4, 4, 2, 1, 6, 6, 1, 3, 9, 2, 2, 0, 9, 0, 4, 2, 0, 1, 1, 3, 8, 2, 1, 6,
                                7, 7, 4, 0, 2, 1, 3, 6, 7, 0, 4, 6, 5, 7, 3, 4, 2, 6, 3, 3, 5, 3, 2, 3,
                                9, 9, 1, 5, 6, 5, 8, 7, 6, 1, 6, 1, 2, 8, 8, 0, 7, 8, 4, 6, 8, 9, 9, 2,
                                8, 1, 2, 1, 1, 7, 4, 8, 0, 7, 6, 1, 8, 9, 9, 1, 3, 5, 9, 8, 6, 0, 3, 0,
                                3, 8, 0, 8, 6, 6, 9, 4, 9, 8, 5, 0, 3, 7, 0, 8, 1, 7, 5, 4, 0, 9, 3, 1,
                                4, 6, 7, 6, 3, 2, 1, 9, 8, 5, 4, 1, 9, 9, 4, 5, 2, 0, 9, 2, 6, 9, 1, 7,
                                6, 4, 1, 2, 6, 4, 2, 3, 2, 5, 7, 8, 3, 2, 7, 1, 3, 0, 0, 0, 6, 2, 9, 6,
                                7, 1, 9, 6, 5, 9, 6, 1, 6, 6, 0, 3, 2, 2, 6, 7, 2, 8, 0, 1, 8, 5, 6, 9,
                                0, 6, 9, 6, 0, 3, 5, 6, 6, 4, 8, 8, 3, 8, 7, 6, 8, 1, 4, 0, 8, 0, 4, 5,
                                7, 9, 2, 5, 2, 1, 4, 6, 4, 4, 2, 9, 1, 3, 3, 9, 6, 6, 5, 5, 1, 8, 5, 5,
                                2, 8, 4, 8, 3, 5, 6, 3, 6, 9, 5, 9, 8, 3, 8, 7, 1, 0, 1, 3, 5, 4, 4, 4,
                                3, 4, 8, 4, 8, 9, 6, 7, 1, 8, 9, 3, 1, 3, 1, 8, 4, 5, 9, 6, 7, 5, 7, 3,
                                6, 8, 7, 0, 4, 2, 1, 8, 5, 7, 9, 2, 7, 2, 3, 4, 8, 9, 8, 7, 9, 4, 7, 3,
                                3, 9, 7, 9, 3, 1, 6, 6, 1, 2, 4, 4, 2, 9, 3, 8, 6, 6, 4, 7, 5, 8, 3, 5,
                                9, 0, 0, 9, 5, 6, 5, 7, 2, 0, 3, 2, 4, 1, 9, 6, 1, 1, 5, 5, 3, 6, 9, 6,
                                8, 5, 8, 6, 8, 0, 2, 5, 8, 2, 3, 6, 0, 7, 6, 3, 3, 7, 2, 8, 9, 7, 8, 2,
                                9, 3, 1, 3, 1, 5, 8, 9, 0, 5, 9, 3, 1, 4, 8, 4, 6, 5, 4, 0, 9, 6, 4, 1,
                                5, 8, 5, 0, 1, 4, 4, 0, 1, 1, 3, 7, 1, 2, 8, 9, 5, 3, 2, 6, 3, 1, 2, 1,
                                3, 1, 7, 7, 9, 1, 1, 8, 6, 5, 1, 6, 2, 2, 2, 2, 5, 9, 8, 0, 8, 6, 8, 4,
                                6, 6, 2, 2, 8, 9, 1, 5, 4, 7, 9, 1, 0, 1, 1, 9, 7, 4, 7, 2, 9, 4, 8, 8,
                                7, 7, 9, 5, 0, 9, 5, 7, 6, 4, 2, 1, 9, 3, 3, 7, 8, 4, 8, 4, 5, 3, 6, 5,
                                9, 4, 6, 6, 9, 0, 9, 9, 9, 8, 5, 3, 5, 1, 9, 7, 4, 8, 4, 5, 6, 3, 6, 6,
                                1, 2, 8, 0, 8, 6, 0, 3, 6, 6, 5, 3, 2, 5, 2, 8, 1, 7, 2, 8, 1, 3, 8, 3,
                                9, 3, 5, 4, 8, 2, 8, 6, 0, 4, 9, 0, 0, 2, 8, 0, 6, 4, 9, 4, 6, 7, 9, 8,
                                4, 5, 4, 0, 2, 6, 0, 0, 0, 6, 8, 9, 1, 6, 8, 8, 0, 8, 2, 1, 8, 8, 1, 7])),
                            names=('seed_nodes', 'labels'),
                        ), 'item': ItemSet(
                            items=(tensor([631, 735, 695, 208, 147, 276,  67, 325, 448, 857,  97, 191, 573, 479,
                                976, 895, 148,  74,  40, 128, 394, 722, 983, 748, 566, 678, 178,  11,
                                970, 168,  60, 104, 534, 336, 495, 426, 798, 201, 466, 214, 795,  53,
                                861, 727, 353, 746, 360,   2, 422, 951, 223, 755, 949, 773, 856, 883,
                                793, 259, 775, 345, 762, 511, 285, 221, 911, 263, 554, 227, 171, 203,
                                958, 626, 980, 691, 928,  50, 408, 822, 158, 582, 264, 645, 211, 560,
                                310,  33, 860, 247, 945, 801, 825, 629, 349, 924, 404,  90, 274, 827,
                                354, 156, 324, 814, 124, 298, 188, 536,  83, 197, 196, 253, 220, 938,
                                823, 894, 941, 698, 279, 346, 587,  25,  44, 513, 703, 123,  38, 790,
                                507, 500, 960, 913, 577, 927, 237, 190, 437, 365, 255, 344, 121, 721,
                                125, 680, 987,  16, 161, 533, 557, 127, 968, 739, 241, 737, 628, 654,
                                192,  58, 865, 272, 366, 756, 806, 170, 914, 459, 959, 258, 726, 998,
                                315,  20, 499, 820,  46, 708, 784, 471, 421, 359, 476,   7, 318, 904,
                                139, 228, 213, 514, 765, 868, 327, 559, 896, 409, 482, 447, 455, 129,
                                993, 591, 110, 145, 256, 813, 799, 540, 179, 875, 323, 561, 747, 612,
                                269, 261, 690, 564, 382, 563,  89, 122, 403, 393, 642, 579, 550, 217,
                                971, 942, 461, 429, 548, 719, 296, 212, 496, 498, 438, 874, 585, 204,
                                187, 109, 764, 982, 244, 617, 376, 374, 198, 807, 379,  45, 901, 112,
                                969, 644, 488,  42, 367, 699, 725, 873, 440, 470, 877, 706, 789, 304,
                                936, 497, 436, 641, 805, 770, 144, 516, 989, 300, 673,  98,  84, 649,
                                815, 615, 948, 238, 305, 167, 232, 736,  54, 235, 491, 994,  62, 728,
                                907, 302, 343, 239, 200, 981, 415, 882, 930, 522, 280, 979, 597, 480,
                                222, 984,  85, 908, 113, 622, 956, 803, 458, 991, 750, 786, 530,  37,
                                333, 492, 847, 330, 731, 925, 990, 363, 779, 545, 568, 718, 679, 400,
                                386, 547, 481,  79, 630, 396, 705, 605, 180, 504, 618, 693, 427, 162,
                                549,  23, 518, 931, 593, 575, 570, 460, 526, 717, 270, 751, 355, 639,
                                788,  10, 800, 835, 741, 306,  31, 977, 133, 720, 338, 724, 902, 528,
                                248,  92, 149, 655,  24, 289, 309, 290, 669, 714, 950, 623, 661, 418,
                                754, 589, 435, 674, 510, 834, 411, 166, 604, 286, 850, 546, 541, 733,
                                848, 445, 329, 544, 766, 939, 193, 637, 692,  13, 712, 743, 312, 527,
                                961, 451,   5, 410, 670, 553, 610, 383, 817, 932, 782, 512, 667, 210,
                                769, 709, 583, 257, 864, 397, 763, 943, 686, 574, 999, 849, 493, 684,
                                169, 141, 761,  80, 964, 696, 694,   4, 175, 506, 920, 973, 648, 335,
                                364, 225, 295, 608, 186, 407, 342, 378, 935, 551, 862, 273, 955, 988,
                                246, 967, 531, 157, 716, 657, 625, 515, 401, 953, 539, 588, 598,  61,
                                380, 729, 889, 947, 606,  41, 647, 565, 143, 768, 651, 869, 339, 230,
                                142, 607, 909, 594, 890, 843,  28,  91, 826, 643, 760, 809, 681, 831,
                                509, 537, 740, 595, 995, 600, 783, 578, 387,  69,  73, 794,   1, 525,
                                484, 611, 910, 131, 954, 249, 292, 957,  57, 701, 405, 891, 281,  76,
                                962, 521, 475,   0, 906, 792, 446, 846, 996, 183, 398, 704, 233, 457,
                                423, 489, 884, 523, 836, 278, 866, 120, 443, 373, 838, 153, 340, 710,
                                753, 665,  78, 584, 758, 348, 432, 205, 944, 888, 219, 194, 744, 151,
                                609, 842, 114, 321, 150, 845,  51, 107, 632, 986, 119, 322],
                               dtype=torch.int32), tensor([9, 8, 5, 5, 8, 3, 0, 9, 2, 2, 7, 1, 1, 5, 6, 2, 1, 0, 6, 4, 2, 1, 6, 2,
                                5, 1, 2, 1, 6, 8, 8, 2, 5, 8, 1, 3, 2, 0, 0, 6, 6, 2, 2, 6, 6, 4, 3, 5,
                                3, 4, 9, 9, 8, 2, 4, 3, 6, 7, 3, 5, 3, 4, 1, 2, 9, 2, 9, 6, 9, 9, 8, 9,
                                1, 2, 3, 0, 3, 0, 9, 1, 2, 9, 4, 8, 8, 4, 3, 7, 5, 9, 0, 3, 1, 6, 9, 8,
                                8, 6, 8, 7, 1, 5, 4, 4, 4, 0, 3, 6, 1, 7, 0, 7, 9, 2, 4, 9, 0, 6, 8, 6,
                                7, 5, 9, 8, 9, 9, 2, 7, 5, 8, 4, 3, 2, 6, 7, 3, 1, 4, 0, 6, 4, 4, 3, 1,
                                4, 1, 4, 7, 2, 1, 0, 3, 3, 9, 1, 5, 5, 3, 4, 0, 5, 1, 7, 2, 7, 4, 9, 6,
                                1, 6, 3, 9, 6, 4, 0, 9, 1, 0, 3, 7, 7, 6, 7, 2, 9, 8, 8, 5, 1, 5, 0, 8,
                                6, 5, 2, 2, 9, 1, 7, 7, 8, 3, 2, 2, 6, 5, 5, 4, 8, 1, 5, 6, 2, 6, 8, 3,
                                2, 6, 7, 8, 7, 1, 0, 6, 7, 4, 8, 2, 0, 6, 3, 2, 8, 1, 0, 2, 1, 0, 1, 7,
                                2, 9, 2, 0, 5, 8, 1, 5, 5, 5, 5, 0, 7, 8, 5, 4, 9, 1, 5, 7, 4, 0, 4, 3,
                                9, 6, 4, 9, 7, 1, 0, 4, 0, 5, 9, 5, 5, 8, 1, 6, 7, 5, 6, 0, 6, 9, 8, 1,
                                8, 7, 6, 9, 7, 5, 4, 6, 9, 0, 6, 0, 9, 8, 9, 6, 8, 4, 3, 2, 4, 1, 0, 3,
                                0, 7, 1, 5, 8, 5, 4, 0, 8, 5, 5, 4, 9, 8, 8, 5, 6, 5, 4, 0, 0, 9, 1, 4,
                                9, 4, 0, 6, 3, 2, 6, 9, 2, 5, 4, 9, 8, 2, 5, 8, 6, 0, 4, 4, 4, 7, 9, 6,
                                0, 1, 4, 5, 3, 3, 9, 0, 3, 6, 7, 5, 0, 5, 5, 6, 6, 9, 8, 1, 7, 4, 9, 3,
                                0, 7, 2, 9, 8, 9, 8, 1, 6, 3, 8, 5, 3, 2, 3, 0, 1, 1, 8, 4, 1, 2, 0, 3,
                                2, 4, 8, 3, 9, 2, 5, 2, 6, 5, 4, 9, 3, 0, 0, 7, 1, 8, 7, 3, 8, 5, 5, 6,
                                9, 3, 9, 5, 1, 3, 5, 4, 8, 0, 5, 4, 8, 5, 0, 1, 6, 9, 5, 7, 0, 9, 8, 8,
                                6, 5, 6, 5, 5, 0, 6, 3, 6, 2, 8, 9, 1, 0, 1, 0, 5, 9, 5, 1, 0, 5, 8, 1,
                                1, 3, 4, 4, 8, 5, 6, 4, 7, 0, 5, 0, 3, 5, 1, 6, 6, 5, 8, 5, 7, 7, 9, 7,
                                2, 3, 5, 0, 2, 9, 9, 1, 7, 0, 7, 3, 9, 2, 2, 2, 7, 6, 7, 1, 1, 6, 4, 3,
                                1, 5, 6, 5, 7, 1, 8, 8, 9, 5, 4, 8, 7, 2, 3, 5, 5, 0, 5, 0, 8, 1, 8, 0,
                                6, 4, 2, 1, 9, 6, 9, 7, 1, 0, 6, 5, 5, 1, 2, 5, 3, 6, 6, 6, 4, 4, 0, 0,
                                3, 1, 5, 0, 4, 7, 9, 8, 4, 8, 5, 2, 4, 8, 5, 9, 9, 6, 7, 8, 4, 0, 8, 9])),
                            names=('seed_nodes', 'labels'),
                        )},
               names=('seed_nodes', 'labels'),
           ),
           test_set=ItemSetDict(
               itemsets={'user': ItemSet(
                            items=(tensor([187, 460, 630, 231, 127, 665, 179, 712, 462, 358, 699, 812, 282, 764,
                                906, 754, 190, 912, 153, 429, 243,   9, 189, 655, 376, 625, 489,  52,
                                340, 301, 172, 793, 176, 875, 409, 753, 293, 276, 402, 661, 647, 689,
                                967, 859, 188, 832,  19, 344, 146, 561, 444, 439, 283, 387, 996, 918,
                                392,  63, 538, 201, 711, 545, 902,  78, 418, 923,  79, 214, 427, 987,
                                507, 147, 379, 893, 582, 966, 210, 286, 185, 138, 493, 597, 494, 755,
                                451, 649,  83, 550, 583, 277, 160,  39, 119,  82, 833, 193,  77, 872,
                                142, 295, 790, 768, 504, 822, 248, 535, 161, 517, 745, 234, 953, 290,
                                836, 981, 232, 757, 259, 299, 849, 377, 925, 892, 303, 322,  46, 671,
                                568, 381,  58, 476, 540, 560, 636, 135, 865, 252, 607, 897, 553, 710,
                                441, 805, 581, 105, 956, 461,  84, 548, 503, 164, 120, 599, 763,  32,
                                487, 736, 328,  30, 722, 650,  80, 877, 857, 837, 983, 727, 622, 222,
                                819, 791, 627, 586, 738,  89, 705, 730, 547, 144, 633, 644, 592,  50,
                                134, 773, 498, 890, 117, 141, 717, 417, 334, 867, 613,  36, 826, 321,
                                168, 495, 847,  43], dtype=torch.int32), tensor([0, 1, 9, 2, 1, 6, 3, 6, 2, 8, 2, 1, 9, 5, 2, 6, 6, 9, 2, 4, 1, 3, 8, 0,
                                1, 3, 1, 1, 1, 1, 0, 2, 8, 6, 8, 8, 3, 8, 4, 7, 2, 8, 9, 8, 5, 0, 4, 2,
                                7, 3, 3, 9, 3, 4, 7, 5, 8, 4, 6, 3, 1, 4, 6, 3, 4, 8, 7, 9, 8, 8, 1, 4,
                                8, 9, 3, 3, 8, 7, 2, 0, 6, 8, 3, 2, 3, 8, 9, 0, 1, 1, 2, 4, 7, 0, 7, 1,
                                9, 6, 5, 1, 9, 3, 9, 4, 8, 5, 0, 9, 8, 2, 9, 6, 3, 8, 3, 7, 7, 4, 6, 7,
                                1, 9, 5, 8, 4, 2, 3, 5, 0, 0, 0, 8, 9, 4, 9, 9, 7, 4, 5, 0, 4, 4, 9, 3,
                                7, 2, 1, 1, 2, 2, 3, 1, 9, 2, 5, 2, 8, 7, 4, 6, 0, 4, 5, 0, 8, 7, 2, 8,
                                6, 6, 6, 4, 8, 6, 0, 0, 3, 8, 0, 7, 0, 6, 7, 0, 7, 3, 5, 8, 0, 9, 9, 7,
                                9, 1, 0, 5, 9, 3, 3, 6])),
                            names=('seed_nodes', 'labels'),
                        ), 'item': ItemSet(
                            items=(tensor([218, 317, 772,  95, 486, 371, 390, 900, 624, 326,  49, 851, 558,  82,
                                808, 916, 675, 671, 556, 668, 749, 485, 134, 616, 677, 501, 234, 138,
                                428, 332,  56, 106, 207,  55, 172, 929, 627, 934, 821, 640, 487, 777,
                                567, 830,  75, 184, 462, 876, 646, 250, 174, 921, 406, 586, 137, 638,
                                871, 319, 685, 165, 420, 439, 159, 614, 702, 832, 723, 745, 224,  52,
                                293, 206, 732, 176, 311, 271, 115, 375, 682, 381, 581, 870, 155, 599,
                                 39, 356, 797, 912, 268, 291, 392, 412, 369, 963, 226,  47, 136, 468,
                                337, 738, 229, 126, 839, 297, 117, 780, 209, 282, 697, 100, 189,  86,
                                872,  26, 781,   6, 416, 116, 108, 837, 542, 316, 328, 812, 529, 449,
                                975, 828, 543,  93, 464, 160, 923, 163,  64, 320,  29, 887, 431,  99,
                                590, 236,  48, 231, 502, 308, 778, 368,  88, 357, 978,  35, 352, 135,
                                899, 974, 892, 385, 216, 478, 465, 441,  12, 898, 915, 433, 413, 713,
                                215, 653, 804, 414, 602, 101, 940, 620, 473,  17, 811, 787, 905, 819,
                                105, 992, 919, 474, 774, 130, 424, 664, 569, 377,  19,  22, 111, 917,
                                881, 885, 926, 571], dtype=torch.int32), tensor([2, 2, 6, 2, 2, 8, 8, 3, 9, 0, 3, 3, 1, 7, 0, 1, 4, 7, 2, 6, 0, 5, 7, 5,
                                4, 3, 4, 2, 5, 6, 9, 2, 5, 8, 7, 4, 3, 1, 1, 5, 4, 1, 8, 8, 6, 7, 9, 2,
                                9, 0, 1, 6, 1, 0, 0, 7, 9, 0, 3, 7, 9, 3, 8, 2, 3, 1, 0, 8, 2, 4, 2, 5,
                                2, 2, 2, 5, 4, 6, 9, 1, 8, 0, 3, 7, 7, 6, 7, 3, 7, 3, 5, 4, 4, 9, 6, 7,
                                0, 2, 5, 5, 7, 6, 8, 6, 3, 0, 3, 4, 3, 0, 1, 5, 7, 0, 9, 5, 6, 6, 4, 9,
                                1, 4, 2, 9, 3, 9, 6, 4, 5, 3, 8, 3, 7, 2, 7, 6, 9, 8, 1, 4, 8, 8, 2, 3,
                                3, 4, 5, 5, 5, 2, 2, 8, 7, 5, 4, 5, 1, 8, 8, 3, 5, 3, 2, 4, 9, 0, 5, 6,
                                1, 2, 7, 7, 8, 7, 2, 7, 7, 0, 0, 2, 2, 6, 9, 3, 1, 2, 9, 2, 0, 9, 2, 3,
                                2, 5, 8, 3, 7, 8, 0, 1])),
                            names=('seed_nodes', 'labels'),
                        )},
               names=('seed_nodes', 'labels'),
           ),
           metadata={'name': 'node_classification', 'num_classes': 10},)

Loaded link prediction task: OnDiskTask(validation_set=ItemSetDict(
               itemsets={'user:like:item': ItemSet(
                            items=(tensor([[710,  98],
                                [ 33, 211],
                                [ 87, 835],
                                ...,
                                [473, 159],
                                [432, 756],
                                [827, 138]], dtype=torch.int32), tensor([[710,  11, 855,  ..., 122,  77,  14],
                                [424, 321, 575,  ..., 260, 585, 706],
                                [801, 707, 964,  ..., 369, 140, 161],
                                ...,
                                [961, 824, 525,  ..., 424, 427, 141],
                                [ 34, 595, 465,  ..., 575, 898,  36],
                                [139, 723, 537,  ..., 591,  31, 872]], dtype=torch.int32)),
                            names=('node_pairs', 'negative_dsts'),
                        ), 'user:follow:user': ItemSet(
                            items=(tensor([[ 61, 816],
                                [432, 868],
                                [694, 764],
                                ...,
                                [707, 115],
                                [674,  39],
                                [780, 370]], dtype=torch.int32), tensor([[696, 362,  42,  ..., 177, 116, 116],
                                [945, 523, 269,  ..., 880, 309, 374],
                                [602, 464, 867,  ..., 103, 643, 147],
                                ...,
                                [ 90, 655, 294,  ..., 600, 170, 855],
                                [495, 563, 475,  ..., 333, 403, 743],
                                [140, 801, 712,  ..., 497, 209, 278]], dtype=torch.int32)),
                            names=('node_pairs', 'negative_dsts'),
                        )},
               names=('node_pairs', 'negative_dsts'),
           ),
           train_set=ItemSetDict(
               itemsets={'user:like:item': ItemSet(
                            items=(tensor([[158, 444],
                                [838, 685],
                                [984, 317],
                                ...,
                                [615, 338],
                                [559, 993],
                                [524,  77]], dtype=torch.int32),),
                            names=('node_pairs',),
                        ), 'user:follow:user': ItemSet(
                            items=(tensor([[ 11, 245],
                                [843, 699],
                                [884, 218],
                                ...,
                                [293, 646],
                                [ 42, 288],
                                [984,  73]], dtype=torch.int32),),
                            names=('node_pairs',),
                        )},
               names=('node_pairs',),
           ),
           test_set=ItemSetDict(
               itemsets={'user:like:item': ItemSet(
                            items=(tensor([741,   4], dtype=torch.int32), tensor([[769,  98, 825,  ..., 725, 795,   5],
                                [900, 953, 516,  ...,  13, 193, 914],
                                [380, 294, 173,  ..., 462, 894, 524],
                                ...,
                                [ 38,  64, 795,  ..., 975, 239, 472],
                                [781, 892, 767,  ..., 924, 719, 938],
                                [634, 410,  10,  ..., 899, 814, 938]], dtype=torch.int32)),
                            names=('node_pairs', 'negative_dsts'),
                        ), 'user:follow:user': ItemSet(
                            items=(tensor([409, 713], dtype=torch.int32), tensor([[  7, 373, 350,  ...,  46, 445, 920],
                                [216, 606, 571,  ..., 842, 192, 351],
                                [210,  77, 218,  ...,  27, 754, 287],
                                ...,
                                [ 23, 532, 682,  ...,  49, 527, 781],
                                [925,  48, 141,  ..., 135, 147, 611],
                                [888, 776, 792,  ..., 597, 191, 397]], dtype=torch.int32)),
                            names=('node_pairs', 'negative_dsts'),
                        )},
               names=('node_pairs', 'negative_dsts'),
           ),
           metadata={'name': 'link_prediction', 'num_classes': 10},)

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/ubuntu/regression_test/dgl/python/dgl/graphbolt/internal/utils.py:16: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(path)
/home/ubuntu/regression_test/dgl/python/dgl/graphbolt/impl/ondisk_dataset.py:464: DGLWarning: Edge feature is stored, but edge IDs are not saved.
  dgl_warning("Edge feature is stored, but edge IDs are not saved.")
/home/ubuntu/regression_test/dgl/python/dgl/graphbolt/impl/ondisk_dataset.py:856: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(graph_topology.path)
</pre></div></div>
</div>
</section>
</section>
</div>
</div>
<footer><div aria-label="Footer" class="rst-footer-buttons" role="navigation">
<a accesskey="p" class="btn btn-neutral float-left" href="ondisk_dataset_homograph.html" rel="prev" title="OnDiskDataset for Homogeneous Graph"><span aria-hidden="true" class="fa fa-arrow-circle-left"></span> Previous</a>
<a accesskey="n" class="btn btn-neutral float-right" href="ondisk-dataset-specification.html" rel="next" title="YAML specification">Next <span aria-hidden="true" class="fa fa-arrow-circle-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<p>Â© Copyright 2018, DGL Team.</p>
</div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" data-toggle="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span class="fa fa-book"> Read the Docs</span>
<span id="version-placeholder">v: latest</span>
<span class="fa fa-caret-down"></span>
</span>
<div class="rst-other-versions">
<dl>
<dt>Versions</dt>
<div id="version-list">
<!-- åŠ¨æ€æ’å…¥çš„ç‰ˆæœ¬åˆ—è¡¨å°†å‡ºç°åœ¨è¿™é‡Œ -->
</div>
</dl>
<dl>
<dt>Downloads</dt>
<!-- ä¸‹è½½å†…å®¹ -->
</dl>
<dl>
<dt>On Read the Docs</dt>
<dd><a href="//doc-build.dgl.ai/projects/dgl/?fromdocs=dgl">Project Home</a></dd>
<dd><a href="//doc-build.dgl.ai/builds/dgl/?fromdocs=dgl">Builds</a></dd>
</dl>
</div>
</div>
<script>
        document.addEventListener("DOMContentLoaded", function() {
            fetch('/dgl_docs/branches.json')
                .then(response => response.json())
                .then(data => {
                    var versionListDiv = document.getElementById('version-list');
                    data.branches.forEach(function(branch) {
                        var dd = document.createElement('dd');
                        var a = document.createElement('a');
                        a.href = branch.url;
                        a.textContent = branch.name;
                        dd.appendChild(a);
                        versionListDiv.appendChild(dd);
                    });
                })
                .catch(error => console.error('Error loading branches:', error));
        });
        document.addEventListener("DOMContentLoaded", function() {
            // è·å–å½“å‰è·¯å¾„
            var path = window.location.pathname;
            var versionPlaceholder = document.getElementById('version-placeholder');

            // æ£€æŸ¥è·¯å¾„ä¸­æ˜¯å¦åŒ…å« 'en'
            if (path.includes('/en/')) {
                // æå– 'en' åçš„æ–‡ä»¶å¤¹ä½œä¸ºç‰ˆæœ¬å·
                var parts = path.split('/en/');
                if (parts[1]) {
                    var folders = parts[1].split('/');
                    if (folders.length > 0 && folders[0]) {
                        versionPlaceholder.textContent = 'v: ' + folders[0];
                    } else {
                        versionPlaceholder.textContent = 'v: latest';
                    }
                } else {
                    versionPlaceholder.textContent = 'v: latest';
                }
            } else {
                versionPlaceholder.textContent = 'v: latest';
            }
        });
    </script>

<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
</body>
</html>